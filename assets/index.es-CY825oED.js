const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bghrwrms.js","assets/index-DkmeCuq2.js","assets/index-CfCrTsXo.css"])))=>i.map(i=>d[i]);
import{i as Ml,r as ba,j as X,h as Sr,f as Rc,k as s0,w as Ul,m as Hl,o as Oc,t as Ea,p as n0,e as aa,q as wi,V as a0,M as o0,N as B,s as c0,u as yc,v as u0,K as h0,A as l0,x as jh,y as f0,H as p0,F as d0,z as Mh,$ as g0,B as v0,J as y0,C as Gs,D as Uh,X as m0,E as w0,G as Ac,I as kl,L as qr,O as _0,P as Hh,Q as fs,R as St,U as kt,S as mi,T as ar,W as b0,Y as ps,Z as Kl,a0 as E0,a1 as I0,a2 as x0,a3 as Vl,a4 as P0,a5 as Fl,a6 as Bl,a7 as gs,a8 as mc,a9 as da,aa as vs,ab as S0,ac as ga,ad as R0,ae as O0,af as A0,ag as C0,ah as oa,ai as T0,aj as $0,ak as tc,al as kh,am as N0,an as D0,ao as q0,ap as Kh,aq as L0,ar as z0,as as j0,at as M0,au as U0,av as H0,aw as k0,ax as Vs,ay as Gl,az as rc,aA as K0,aB as V0,_ as F0}from"./index-DkmeCuq2.js";import{s as Qs,a as Ia,r as Wl,f as Ui,g as Cc,i as Lr,b as Ys,c as Vh,d as B0,e as G0,h as Tc,p as W0,j as $c,k as xa,l as yi,m as J0,n as Ei}from"./index.es-B30oY9q1.js";const Q0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Y0=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Z0=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function X0(o,t){if(o==="__proto__"||o==="constructor"&&t&&typeof t=="object"&&"prototype"in t){ew(o);return}return t}function ew(o){console.warn(`[destr] Dropping "${o}" key to prevent prototype pollution.`)}function ca(o,t={}){if(typeof o!="string")return o;const i=o.trim();if(o[0]==='"'&&o.endsWith('"')&&!o.includes("\\"))return i.slice(1,-1);if(i.length<=9){const n=i.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!Z0.test(o)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return o}try{if(Q0.test(o)||Y0.test(o)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(o,X0)}return JSON.parse(o)}catch(n){if(t.strict)throw n;return o}}function tw(o){return!o||typeof o.then!="function"?Promise.resolve(o):o}function qt(o,...t){try{return tw(o(...t))}catch(i){return Promise.reject(i)}}function rw(o){const t=typeof o;return o===null||t!=="object"&&t!=="function"}function iw(o){const t=Object.getPrototypeOf(o);return!t||t.isPrototypeOf(Object)}function va(o){if(rw(o))return String(o);if(iw(o)||Array.isArray(o))return JSON.stringify(o);if(typeof o.toJSON=="function")return va(o.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Jl(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const wc="base64:";function sw(o){if(typeof o=="string")return o;Jl();const t=Buffer.from(o).toString("base64");return wc+t}function nw(o){return typeof o!="string"||!o.startsWith(wc)?o:(Jl(),Buffer.from(o.slice(wc.length),"base64"))}function nr(o){return o?o.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function aw(...o){return nr(o.join(":"))}function ua(o){return o=nr(o),o?o+":":""}const ow="memory",cw=()=>{const o=new Map;return{name:ow,getInstance:()=>o,hasItem(t){return o.has(t)},getItem(t){return o.get(t)??null},getItemRaw(t){return o.get(t)??null},setItem(t,i){o.set(t,i)},setItemRaw(t,i){o.set(t,i)},removeItem(t){o.delete(t)},getKeys(){return[...o.keys()]},clear(){o.clear()},dispose(){o.clear()}}};function uw(o={}){const t={mounts:{"":o.driver||cw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=g=>{for(const _ of t.mountpoints)if(g.startsWith(_))return{base:_,relativeKey:g.slice(_.length),driver:t.mounts[_]};return{base:"",relativeKey:g,driver:t.mounts[""]}},n=(g,_)=>t.mountpoints.filter(S=>S.startsWith(g)||_&&g.startsWith(S)).map(S=>({relativeBase:g.length>S.length?g.slice(S.length):void 0,mountpoint:S,driver:t.mounts[S]})),a=(g,_)=>{if(t.watching){_=nr(_);for(const S of t.watchListeners)S(g,_)}},h=async()=>{if(!t.watching){t.watching=!0;for(const g in t.mounts)t.unwatch[g]=await Fh(t.mounts[g],a,g)}},p=async()=>{if(t.watching){for(const g in t.unwatch)await t.unwatch[g]();t.unwatch={},t.watching=!1}},y=(g,_,S)=>{const $=new Map,q=A=>{let Z=$.get(A.base);return Z||(Z={driver:A.driver,base:A.base,items:[]},$.set(A.base,Z)),Z};for(const A of g){const Z=typeof A=="string",te=nr(Z?A:A.key),ce=Z?void 0:A.value,oe=Z||!A.options?_:{..._,...A.options},ne=i(te);q(ne).items.push({key:te,value:ce,relativeKey:ne.relativeKey,options:oe})}return Promise.all([...$.values()].map(A=>S(A))).then(A=>A.flat())},m={hasItem(g,_={}){g=nr(g);const{relativeKey:S,driver:$}=i(g);return qt($.hasItem,S,_)},getItem(g,_={}){g=nr(g);const{relativeKey:S,driver:$}=i(g);return qt($.getItem,S,_).then(q=>ca(q))},getItems(g,_){return y(g,_,S=>S.driver.getItems?qt(S.driver.getItems,S.items.map($=>({key:$.relativeKey,options:$.options})),_).then($=>$.map(q=>({key:aw(S.base,q.key),value:ca(q.value)}))):Promise.all(S.items.map($=>qt(S.driver.getItem,$.relativeKey,$.options).then(q=>({key:$.key,value:ca(q)})))))},getItemRaw(g,_={}){g=nr(g);const{relativeKey:S,driver:$}=i(g);return $.getItemRaw?qt($.getItemRaw,S,_):qt($.getItem,S,_).then(q=>nw(q))},async setItem(g,_,S={}){if(_===void 0)return m.removeItem(g);g=nr(g);const{relativeKey:$,driver:q}=i(g);q.setItem&&(await qt(q.setItem,$,va(_),S),q.watch||a("update",g))},async setItems(g,_){await y(g,_,async S=>{if(S.driver.setItems)return qt(S.driver.setItems,S.items.map($=>({key:$.relativeKey,value:va($.value),options:$.options})),_);S.driver.setItem&&await Promise.all(S.items.map($=>qt(S.driver.setItem,$.relativeKey,va($.value),$.options)))})},async setItemRaw(g,_,S={}){if(_===void 0)return m.removeItem(g,S);g=nr(g);const{relativeKey:$,driver:q}=i(g);if(q.setItemRaw)await qt(q.setItemRaw,$,_,S);else if(q.setItem)await qt(q.setItem,$,sw(_),S);else return;q.watch||a("update",g)},async removeItem(g,_={}){typeof _=="boolean"&&(_={removeMeta:_}),g=nr(g);const{relativeKey:S,driver:$}=i(g);$.removeItem&&(await qt($.removeItem,S,_),(_.removeMeta||_.removeMata)&&await qt($.removeItem,S+"$",_),$.watch||a("remove",g))},async getMeta(g,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),g=nr(g);const{relativeKey:S,driver:$}=i(g),q=Object.create(null);if($.getMeta&&Object.assign(q,await qt($.getMeta,S,_)),!_.nativeOnly){const A=await qt($.getItem,S+"$",_).then(Z=>ca(Z));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(q,A))}return q},setMeta(g,_,S={}){return this.setItem(g+"$",_,S)},removeMeta(g,_={}){return this.removeItem(g+"$",_)},async getKeys(g,_={}){g=ua(g);const S=n(g,!0);let $=[];const q=[];for(const A of S){const Z=await qt(A.driver.getKeys,A.relativeBase,_);for(const te of Z){const ce=A.mountpoint+nr(te);$.some(oe=>ce.startsWith(oe))||q.push(ce)}$=[A.mountpoint,...$.filter(te=>!te.startsWith(A.mountpoint))]}return g?q.filter(A=>A.startsWith(g)&&A[A.length-1]!=="$"):q.filter(A=>A[A.length-1]!=="$")},async clear(g,_={}){g=ua(g),await Promise.all(n(g,!1).map(async S=>{if(S.driver.clear)return qt(S.driver.clear,S.relativeBase,_);if(S.driver.removeItem){const $=await S.driver.getKeys(S.relativeBase||"",_);return Promise.all($.map(q=>S.driver.removeItem(q,_)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(g=>Bh(g)))},async watch(g){return await h(),t.watchListeners.push(g),async()=>{t.watchListeners=t.watchListeners.filter(_=>_!==g),t.watchListeners.length===0&&await p()}},async unwatch(){t.watchListeners=[],await p()},mount(g,_){if(g=ua(g),g&&t.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(t.mountpoints.push(g),t.mountpoints.sort((S,$)=>$.length-S.length)),t.mounts[g]=_,t.watching&&Promise.resolve(Fh(_,a,g)).then(S=>{t.unwatch[g]=S}).catch(console.error),m},async unmount(g,_=!0){g=ua(g),!(!g||!t.mounts[g])&&(t.watching&&g in t.unwatch&&(t.unwatch[g](),delete t.unwatch[g]),_&&await Bh(t.mounts[g]),t.mountpoints=t.mountpoints.filter(S=>S!==g),delete t.mounts[g])},getMount(g=""){g=nr(g)+":";const _=i(g);return{driver:_.driver,base:_.base}},getMounts(g="",_={}){return g=nr(g),n(g,_.parents).map($=>({driver:$.driver,base:$.mountpoint}))},keys:(g,_={})=>m.getKeys(g,_),get:(g,_={})=>m.getItem(g,_),set:(g,_,S={})=>m.setItem(g,_,S),has:(g,_={})=>m.hasItem(g,_),del:(g,_={})=>m.removeItem(g,_),remove:(g,_={})=>m.removeItem(g,_)};return m}function Fh(o,t,i){return o.watch?o.watch((n,a)=>t(n,i+a)):()=>{}}async function Bh(o){typeof o.dispose=="function"&&await qt(o.dispose)}function Hi(o){return new Promise((t,i)=>{o.oncomplete=o.onsuccess=()=>t(o.result),o.onabort=o.onerror=()=>i(o.error)})}function Ql(o,t){const i=indexedDB.open(o);i.onupgradeneeded=()=>i.result.createObjectStore(t);const n=Hi(i);return(a,h)=>n.then(p=>h(p.transaction(t,a).objectStore(t)))}let ic;function Zs(){return ic||(ic=Ql("keyval-store","keyval")),ic}function Gh(o,t=Zs()){return t("readonly",i=>Hi(i.get(o)))}function hw(o,t,i=Zs()){return i("readwrite",n=>(n.put(t,o),Hi(n.transaction)))}function lw(o,t=Zs()){return t("readwrite",i=>(i.delete(o),Hi(i.transaction)))}function fw(o=Zs()){return o("readwrite",t=>(t.clear(),Hi(t.transaction)))}function pw(o,t){return o.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Hi(o.transaction)}function dw(o=Zs()){return o("readonly",t=>{if(t.getAllKeys)return Hi(t.getAllKeys());const i=[];return pw(t,n=>i.push(n.key)).then(()=>i)})}const gw="idb-keyval";var vw=(o={})=>{const t=o.base&&o.base.length>0?`${o.base}:`:"",i=a=>t+a;let n;return o.dbName&&o.storeName&&(n=Ql(o.dbName,o.storeName)),{name:gw,options:o,async hasItem(a){return!(typeof await Gh(i(a),n)>"u")},async getItem(a){return await Gh(i(a),n)??null},setItem(a,h){return hw(i(a),h,n)},removeItem(a){return lw(i(a),n)},getKeys(){return dw(n)},clear(){return fw(n)}}};const yw="WALLET_CONNECT_V2_INDEXED_DB",mw="keyvaluestorage";let ww=class{constructor(){this.indexedDb=uw({driver:vw({dbName:yw,storeName:mw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const i=await this.indexedDb.getItem(t);if(i!==null)return i}async setItem(t,i){await this.indexedDb.setItem(t,Qs(i))}async removeItem(t){await this.indexedDb.removeItem(t)}};var sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ya={exports:{}};(function(){let o;function t(){}o=t,o.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},o.prototype.setItem=function(i,n){this[i]=String(n)},o.prototype.removeItem=function(i){delete this[i]},o.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},o.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},o.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof sc<"u"&&sc.localStorage?ya.exports=sc.localStorage:typeof window<"u"&&window.localStorage?ya.exports=window.localStorage:ya.exports=new t})();function _w(o){var t;return[o[0],Ia((t=o[1])!=null?t:"")]}class bw{constructor(){this.localStorage=ya.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(_w)}async getItem(t){const i=this.localStorage.getItem(t);if(i!==null)return Ia(i)}async setItem(t,i){this.localStorage.setItem(t,Qs(i))}async removeItem(t){this.localStorage.removeItem(t)}}const Ew="wc_storage_version",Wh=1,Iw=async(o,t,i)=>{const n=Ew,a=await t.getItem(n);if(a&&a>=Wh){i(t);return}const h=await o.getKeys();if(!h.length){i(t);return}const p=[];for(;h.length;){const y=h.shift();if(!y)continue;const m=y.toLowerCase();if(m.includes("wc@")||m.includes("walletconnect")||m.includes("wc_")||m.includes("wallet_connect")){const g=await o.getItem(y);await t.setItem(y,g),p.push(y)}}await t.setItem(n,Wh),i(t),xw(o,p)},xw=async(o,t)=>{t.length&&t.forEach(async i=>{await o.removeItem(i)})};let Pw=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const t=new bw;this.storage=t;try{const i=new ww;Iw(t,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,i){return await this.initialize(),this.storage.setItem(t,i)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),t())},20)})}};var ys={},zs={},nc={},js={};class ki{}const Sw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ki},Symbol.toStringTag,{value:"Module"})),Rw=Ml(Sw);var Jh;function Ow(){if(Jh)return js;Jh=1,Object.defineProperty(js,"__esModule",{value:!0}),js.IHeartBeat=void 0;const o=Rw;class t extends o.IEvents{constructor(n){super()}}return js.IHeartBeat=t,js}var Qh;function Yl(){return Qh||(Qh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),ba.__exportStar(Ow(),o)}(nc)),nc}var ac={},Mi={},Yh;function Aw(){if(Yh)return Mi;Yh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const o=X;return Mi.HEARTBEAT_INTERVAL=o.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var Zh;function Zl(){return Zh||(Zh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),ba.__exportStar(Aw(),o)}(ac)),ac}var Xh;function Cw(){if(Xh)return zs;Xh=1,Object.defineProperty(zs,"__esModule",{value:!0}),zs.HeartBeat=void 0;const o=ba,t=Sr,i=X,n=Yl(),a=Zl();class h extends n.IHeartBeat{constructor(y){super(y),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(y==null?void 0:y.interval)||a.HEARTBEAT_INTERVAL}static init(y){return o.__awaiter(this,void 0,void 0,function*(){const m=new h(y);return yield m.init(),m})}init(){return o.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,m){this.events.on(y,m)}once(y,m){this.events.once(y,m)}off(y,m){this.events.off(y,m)}removeListener(y,m){this.events.removeListener(y,m)}initialize(){return o.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return zs.HeartBeat=h,zs}(function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=ba;t.__exportStar(Cw(),o),t.__exportStar(Yl(),o),t.__exportStar(Zl(),o)})(ys);function Tw(o){try{return JSON.stringify(o)}catch{return'"[Circular]"'}}var $w=Nw;function Nw(o,t,i){var n=i&&i.stringify||Tw,a=1;if(typeof o=="object"&&o!==null){var h=t.length+a;if(h===1)return o;var p=new Array(h);p[0]=n(o);for(var y=1;y<h;y++)p[y]=n(t[y]);return p.join(" ")}if(typeof o!="string")return o;var m=t.length;if(m===0)return o;for(var g="",_=1-a,S=-1,$=o&&o.length||0,q=0;q<$;){if(o.charCodeAt(q)===37&&q+1<$){switch(S=S>-1?S:0,o.charCodeAt(q+1)){case 100:case 102:if(_>=m||t[_]==null)break;S<q&&(g+=o.slice(S,q)),g+=Number(t[_]),S=q+2,q++;break;case 105:if(_>=m||t[_]==null)break;S<q&&(g+=o.slice(S,q)),g+=Math.floor(Number(t[_])),S=q+2,q++;break;case 79:case 111:case 106:if(_>=m||t[_]===void 0)break;S<q&&(g+=o.slice(S,q));var A=typeof t[_];if(A==="string"){g+="'"+t[_]+"'",S=q+2,q++;break}if(A==="function"){g+=t[_].name||"<anonymous>",S=q+2,q++;break}g+=n(t[_]),S=q+2,q++;break;case 115:if(_>=m)break;S<q&&(g+=o.slice(S,q)),g+=String(t[_]),S=q+2,q++;break;case 37:S<q&&(g+=o.slice(S,q)),g+="%",S=q+2,q++,_--;break}++_}++q}return S===-1?o:(S<$&&(g+=o.slice(S)),g)}const el=$w;var Dw=Vr;const Ws=Vw().console||{},qw={mapHttpRequest:ha,mapHttpResponse:ha,wrapRequestSerializer:oc,wrapResponseSerializer:oc,wrapErrorSerializer:oc,req:ha,res:ha,err:Uw};function Lw(o,t){return Array.isArray(o)?o.filter(function(n){return n!=="!stdSerializers.err"}):o===!0?Object.keys(t):!1}function Vr(o){o=o||{},o.browser=o.browser||{};const t=o.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const i=o.browser.write||Ws;o.browser.write&&(o.browser.asObject=!0);const n=o.serializers||{},a=Lw(o.browser.serialize,n);let h=o.browser.serialize;Array.isArray(o.browser.serialize)&&o.browser.serialize.indexOf("!stdSerializers.err")>-1&&(h=!1);const p=["error","fatal","warn","info","debug","trace"];typeof i=="function"&&(i.error=i.fatal=i.warn=i.info=i.debug=i.trace=i),o.enabled===!1&&(o.level="silent");const y=o.level||"info",m=Object.create(i);m.log||(m.log=Js),Object.defineProperty(m,"levelVal",{get:_}),Object.defineProperty(m,"level",{get:S,set:$});const g={transmit:t,serialize:a,asObject:o.browser.asObject,levels:p,timestamp:Hw(o)};m.levels=Vr.levels,m.level=y,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=Js,m.serializers=n,m._serialize=a,m._stdErrSerialize=h,m.child=q,t&&(m._logEvent=_c());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function S(){return this._level}function $(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,hs(g,m,"error","log"),hs(g,m,"fatal","error"),hs(g,m,"warn","error"),hs(g,m,"info","log"),hs(g,m,"debug","log"),hs(g,m,"trace","log")}function q(A,Z){if(!A)throw new Error("missing bindings for child Pino");Z=Z||{},a&&A.serializers&&(Z.serializers=A.serializers);const te=Z.serializers;if(a&&te){var ce=Object.assign({},n,te),oe=o.browser.serialize===!0?Object.keys(ce):a;delete A.serializers,Pa([A],oe,ce,this._stdErrSerialize)}function ne(re){this._childLevel=(re._childLevel|0)+1,this.error=ls(re,A,"error"),this.fatal=ls(re,A,"fatal"),this.warn=ls(re,A,"warn"),this.info=ls(re,A,"info"),this.debug=ls(re,A,"debug"),this.trace=ls(re,A,"trace"),ce&&(this.serializers=ce,this._serialize=oe),t&&(this._logEvent=_c([].concat(re._logEvent.bindings,A)))}return ne.prototype=this,new ne(this)}return m}Vr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Vr.stdSerializers=qw;Vr.stdTimeFunctions=Object.assign({},{nullTime:Xl,epochTime:ef,unixTime:kw,isoTime:Kw});function hs(o,t,i,n){const a=Object.getPrototypeOf(t);t[i]=t.levelVal>t.levels.values[i]?Js:a[i]?a[i]:Ws[i]||Ws[n]||Js,zw(o,t,i)}function zw(o,t,i){!o.transmit&&t[i]===Js||(t[i]=function(n){return function(){const h=o.timestamp(),p=new Array(arguments.length),y=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ws?Ws:this;for(var m=0;m<p.length;m++)p[m]=arguments[m];if(o.serialize&&!o.asObject&&Pa(p,this._serialize,this.serializers,this._stdErrSerialize),o.asObject?n.call(y,jw(this,i,p,h)):n.apply(y,p),o.transmit){const g=o.transmit.level||t.level,_=Vr.levels.values[g],S=Vr.levels.values[i];if(S<_)return;Mw(this,{ts:h,methodLevel:i,methodValue:S,transmitLevel:g,transmitValue:Vr.levels.values[o.transmit.level||t.level],send:o.transmit.send,val:t.levelVal},p)}}}(t[i]))}function jw(o,t,i,n){o._serialize&&Pa(i,o._serialize,o.serializers,o._stdErrSerialize);const a=i.slice();let h=a[0];const p={};n&&(p.time=n),p.level=Vr.levels.values[t];let y=(o._childLevel|0)+1;if(y<1&&(y=1),h!==null&&typeof h=="object"){for(;y--&&typeof a[0]=="object";)Object.assign(p,a.shift());h=a.length?el(a.shift(),a):void 0}else typeof h=="string"&&(h=el(a.shift(),a));return h!==void 0&&(p.msg=h),p}function Pa(o,t,i,n){for(const a in o)if(n&&o[a]instanceof Error)o[a]=Vr.stdSerializers.err(o[a]);else if(typeof o[a]=="object"&&!Array.isArray(o[a]))for(const h in o[a])t&&t.indexOf(h)>-1&&h in i&&(o[a][h]=i[h](o[a][h]))}function ls(o,t,i){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var a=1;a<n.length;a++)n[a]=arguments[a-1];return o[i].apply(this,n)}}function Mw(o,t,i){const n=t.send,a=t.ts,h=t.methodLevel,p=t.methodValue,y=t.val,m=o._logEvent.bindings;Pa(i,o._serialize||Object.keys(o.serializers),o.serializers,o._stdErrSerialize===void 0?!0:o._stdErrSerialize),o._logEvent.ts=a,o._logEvent.messages=i.filter(function(g){return m.indexOf(g)===-1}),o._logEvent.level.label=h,o._logEvent.level.value=p,n(h,o._logEvent,y),o._logEvent=_c(m)}function _c(o){return{ts:0,messages:[],bindings:o||[],level:{label:"",value:0}}}function Uw(o){const t={type:o.constructor.name,msg:o.message,stack:o.stack};for(const i in o)t[i]===void 0&&(t[i]=o[i]);return t}function Hw(o){return typeof o.timestamp=="function"?o.timestamp:o.timestamp===!1?Xl:ef}function ha(){return{}}function oc(o){return o}function Js(){}function Xl(){return!1}function ef(){return Date.now()}function kw(){return Math.round(Date.now()/1e3)}function Kw(){return new Date(Date.now()).toISOString()}function Vw(){function o(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return o(self)||o(window)||o(this)||{}}}const Sa=Rc(Dw),Fw={level:"info"},Xs="custom_context";var Bw=Object.defineProperty,Gw=Object.defineProperties,Ww=Object.getOwnPropertyDescriptors,tl=Object.getOwnPropertySymbols,Jw=Object.prototype.hasOwnProperty,Qw=Object.prototype.propertyIsEnumerable,rl=(o,t,i)=>t in o?Bw(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Yw=(o,t)=>{for(var i in t||(t={}))Jw.call(t,i)&&rl(o,i,t[i]);if(tl)for(var i of tl(t))Qw.call(t,i)&&rl(o,i,t[i]);return o},Zw=(o,t)=>Gw(o,Ww(t));function Ra(o){return Zw(Yw({},o),{level:(o==null?void 0:o.level)||Fw.level})}function Xw(o,t=Xs){return o[t]||""}function e1(o,t,i=Xs){return o[i]=t,o}function or(o,t=Xs){let i="";return typeof o.bindings>"u"?i=Xw(o,t):i=o.bindings().context||"",i}function t1(o,t,i=Xs){const n=or(o,i);return n.trim()?`${n}/${t}`:t}function cr(o,t,i=Xs){const n=t1(o,t,i),a=o.child({context:n});return e1(a,n,i)}class r1 extends ki{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let i1=class extends ki{constructor(t,i){super(),this.core=t,this.logger=i,this.records=new Map}},s1=class{constructor(t,i){this.logger=t,this.core=i}},n1=class extends ki{constructor(t,i){super(),this.relayer=t,this.logger=i}},a1=class extends ki{constructor(t){super()}},o1=class{constructor(t,i,n,a){this.core=t,this.logger=i,this.name=n}};class c1 extends ki{constructor(t,i){super(),this.relayer=t,this.logger=i}}let u1=class extends ki{constructor(t,i){super(),this.core=t,this.logger=i}},h1=class{constructor(t,i){this.projectId=t,this.logger=i}},l1=class{constructor(t,i){this.projectId=t,this.logger=i}},f1=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},p1=class{constructor(t){this.client=t}};var Nc={},tf={};(function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=s0,i=Ul;o.DIGEST_LENGTH=64,o.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=o.DIGEST_LENGTH,this.blockSize=o.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},y.prototype.update=function(m,g){if(g===void 0&&(g=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<o.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=m[_++],g--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(_=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,_,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=m[_++],g--;return this},y.prototype.finish=function(m){if(!this._finished){var g=this._bytesHashed,_=this._bufferLength,S=g/536870912|0,$=g<<3,q=g%128<112?128:256;this._buffer[_]=128;for(var A=_+1;A<q-8;A++)this._buffer[A]=0;t.writeUint32BE(S,this._buffer,q-8),t.writeUint32BE($,this._buffer,q-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)t.writeUint32BE(this._stateHi[A],m,A*8),t.writeUint32BE(this._stateLo[A],m,A*8+4);return this},y.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(m){i.wipe(m.stateHi),i.wipe(m.stateLo),m.buffer&&i.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},y}();o.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(y,m,g,_,S,$,q){for(var A=g[0],Z=g[1],te=g[2],ce=g[3],oe=g[4],ne=g[5],re=g[6],fe=g[7],pe=_[0],Q=_[1],xe=_[2],Tt=_[3],vt=_[4],Yt=_[5],Vt=_[6],ur=_[7],M,U,Ge,qe,G,K,H,V;q>=128;){for(var Rt=0;Rt<16;Rt++){var rt=8*Rt+$;y[Rt]=t.readUint32BE(S,rt),m[Rt]=t.readUint32BE(S,rt+4)}for(var Rt=0;Rt<80;Rt++){var xi=A,we=Z,Rr=te,T=ce,C=oe,R=ne,u=re,E=fe,J=pe,ae=Q,ge=xe,Pe=Tt,Re=vt,_e=Yt,yt=Vt,lt=ur;if(M=fe,U=ur,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=(oe>>>14|vt<<18)^(oe>>>18|vt<<14)^(vt>>>9|oe<<23),U=(vt>>>14|oe<<18)^(vt>>>18|oe<<14)^(oe>>>9|vt<<23),G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,M=oe&ne^~oe&re,U=vt&Yt^~vt&Vt,G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,M=a[Rt*2],U=a[Rt*2+1],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,M=y[Rt%16],U=m[Rt%16],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,Ge=H&65535|V<<16,qe=G&65535|K<<16,M=Ge,U=qe,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=(A>>>28|pe<<4)^(pe>>>2|A<<30)^(pe>>>7|A<<25),U=(pe>>>28|A<<4)^(A>>>2|pe<<30)^(A>>>7|pe<<25),G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,M=A&Z^A&te^Z&te,U=pe&Q^pe&xe^Q&xe,G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,E=H&65535|V<<16,lt=G&65535|K<<16,M=T,U=Pe,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=Ge,U=qe,G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,T=H&65535|V<<16,Pe=G&65535|K<<16,Z=xi,te=we,ce=Rr,oe=T,ne=C,re=R,fe=u,A=E,Q=J,xe=ae,Tt=ge,vt=Pe,Yt=Re,Vt=_e,ur=yt,pe=lt,Rt%16===15)for(var rt=0;rt<16;rt++)M=y[rt],U=m[rt],G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=y[(rt+9)%16],U=m[(rt+9)%16],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,Ge=y[(rt+1)%16],qe=m[(rt+1)%16],M=(Ge>>>1|qe<<31)^(Ge>>>8|qe<<24)^Ge>>>7,U=(qe>>>1|Ge<<31)^(qe>>>8|Ge<<24)^(qe>>>7|Ge<<25),G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,Ge=y[(rt+14)%16],qe=m[(rt+14)%16],M=(Ge>>>19|qe<<13)^(qe>>>29|Ge<<3)^Ge>>>6,U=(qe>>>19|Ge<<13)^(Ge>>>29|qe<<3)^(qe>>>6|Ge<<26),G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,y[rt]=H&65535|V<<16,m[rt]=G&65535|K<<16}M=A,U=pe,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[0],U=_[0],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[0]=A=H&65535|V<<16,_[0]=pe=G&65535|K<<16,M=Z,U=Q,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[1],U=_[1],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[1]=Z=H&65535|V<<16,_[1]=Q=G&65535|K<<16,M=te,U=xe,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[2],U=_[2],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[2]=te=H&65535|V<<16,_[2]=xe=G&65535|K<<16,M=ce,U=Tt,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[3],U=_[3],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[3]=ce=H&65535|V<<16,_[3]=Tt=G&65535|K<<16,M=oe,U=vt,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[4],U=_[4],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[4]=oe=H&65535|V<<16,_[4]=vt=G&65535|K<<16,M=ne,U=Yt,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[5],U=_[5],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[5]=ne=H&65535|V<<16,_[5]=Yt=G&65535|K<<16,M=re,U=Vt,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[6],U=_[6],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[6]=re=H&65535|V<<16,_[6]=Vt=G&65535|K<<16,M=fe,U=ur,G=U&65535,K=U>>>16,H=M&65535,V=M>>>16,M=g[7],U=_[7],G+=U&65535,K+=U>>>16,H+=M&65535,V+=M>>>16,K+=G>>>16,H+=K>>>16,V+=H>>>16,g[7]=fe=H&65535|V<<16,_[7]=ur=G&65535|K<<16,$+=128,q-=128}return $}function p(y){var m=new n;m.update(y);var g=m.digest();return m.clean(),g}o.hash=p})(tf);(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.convertSecretKeyToX25519=o.convertPublicKeyToX25519=o.verify=o.sign=o.extractPublicKeyFromSecretKey=o.generateKeyPair=o.generateKeyPairFromSeed=o.SEED_LENGTH=o.SECRET_KEY_LENGTH=o.PUBLIC_KEY_LENGTH=o.SIGNATURE_LENGTH=void 0;const t=Hl,i=tf,n=Ul;o.SIGNATURE_LENGTH=64,o.PUBLIC_KEY_LENGTH=32,o.SECRET_KEY_LENGTH=64,o.SEED_LENGTH=32;function a(T){const C=new Float64Array(16);if(T)for(let R=0;R<T.length;R++)C[R]=T[R];return C}const h=new Uint8Array(32);h[0]=9;const p=a(),y=a([1]),m=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(T,C){for(let R=0;R<16;R++)T[R]=C[R]|0}function A(T){let C=1;for(let R=0;R<16;R++){let u=T[R]+C+65535;C=Math.floor(u/65536),T[R]=u-C*65536}T[0]+=C-1+37*(C-1)}function Z(T,C,R){const u=~(R-1);for(let E=0;E<16;E++){const J=u&(T[E]^C[E]);T[E]^=J,C[E]^=J}}function te(T,C){const R=a(),u=a();for(let E=0;E<16;E++)u[E]=C[E];A(u),A(u),A(u);for(let E=0;E<2;E++){R[0]=u[0]-65517;for(let ae=1;ae<15;ae++)R[ae]=u[ae]-65535-(R[ae-1]>>16&1),R[ae-1]&=65535;R[15]=u[15]-32767-(R[14]>>16&1);const J=R[15]>>16&1;R[14]&=65535,Z(u,R,1-J)}for(let E=0;E<16;E++)T[2*E]=u[E]&255,T[2*E+1]=u[E]>>8}function ce(T,C){let R=0;for(let u=0;u<32;u++)R|=T[u]^C[u];return(1&R-1>>>8)-1}function oe(T,C){const R=new Uint8Array(32),u=new Uint8Array(32);return te(R,T),te(u,C),ce(R,u)}function ne(T){const C=new Uint8Array(32);return te(C,T),C[0]&1}function re(T,C){for(let R=0;R<16;R++)T[R]=C[2*R]+(C[2*R+1]<<8);T[15]&=32767}function fe(T,C,R){for(let u=0;u<16;u++)T[u]=C[u]+R[u]}function pe(T,C,R){for(let u=0;u<16;u++)T[u]=C[u]-R[u]}function Q(T,C,R){let u,E,J=0,ae=0,ge=0,Pe=0,Re=0,_e=0,yt=0,lt=0,Ze=0,Ae=0,ke=0,Ke=0,Xe=0,Ne=0,Ve=0,Se=0,Le=0,it=0,Te=0,mt=0,Ot=0,Lt=0,zt=0,$t=0,Ft=0,Zt=0,zr=0,Bt=0,Fr=0,ai=0,Pi=0,st=R[0],We=R[1],nt=R[2],at=R[3],et=R[4],Je=R[5],wt=R[6],_t=R[7],ot=R[8],bt=R[9],ct=R[10],ft=R[11],ut=R[12],He=R[13],Et=R[14],It=R[15];u=C[0],J+=u*st,ae+=u*We,ge+=u*nt,Pe+=u*at,Re+=u*et,_e+=u*Je,yt+=u*wt,lt+=u*_t,Ze+=u*ot,Ae+=u*bt,ke+=u*ct,Ke+=u*ft,Xe+=u*ut,Ne+=u*He,Ve+=u*Et,Se+=u*It,u=C[1],ae+=u*st,ge+=u*We,Pe+=u*nt,Re+=u*at,_e+=u*et,yt+=u*Je,lt+=u*wt,Ze+=u*_t,Ae+=u*ot,ke+=u*bt,Ke+=u*ct,Xe+=u*ft,Ne+=u*ut,Ve+=u*He,Se+=u*Et,Le+=u*It,u=C[2],ge+=u*st,Pe+=u*We,Re+=u*nt,_e+=u*at,yt+=u*et,lt+=u*Je,Ze+=u*wt,Ae+=u*_t,ke+=u*ot,Ke+=u*bt,Xe+=u*ct,Ne+=u*ft,Ve+=u*ut,Se+=u*He,Le+=u*Et,it+=u*It,u=C[3],Pe+=u*st,Re+=u*We,_e+=u*nt,yt+=u*at,lt+=u*et,Ze+=u*Je,Ae+=u*wt,ke+=u*_t,Ke+=u*ot,Xe+=u*bt,Ne+=u*ct,Ve+=u*ft,Se+=u*ut,Le+=u*He,it+=u*Et,Te+=u*It,u=C[4],Re+=u*st,_e+=u*We,yt+=u*nt,lt+=u*at,Ze+=u*et,Ae+=u*Je,ke+=u*wt,Ke+=u*_t,Xe+=u*ot,Ne+=u*bt,Ve+=u*ct,Se+=u*ft,Le+=u*ut,it+=u*He,Te+=u*Et,mt+=u*It,u=C[5],_e+=u*st,yt+=u*We,lt+=u*nt,Ze+=u*at,Ae+=u*et,ke+=u*Je,Ke+=u*wt,Xe+=u*_t,Ne+=u*ot,Ve+=u*bt,Se+=u*ct,Le+=u*ft,it+=u*ut,Te+=u*He,mt+=u*Et,Ot+=u*It,u=C[6],yt+=u*st,lt+=u*We,Ze+=u*nt,Ae+=u*at,ke+=u*et,Ke+=u*Je,Xe+=u*wt,Ne+=u*_t,Ve+=u*ot,Se+=u*bt,Le+=u*ct,it+=u*ft,Te+=u*ut,mt+=u*He,Ot+=u*Et,Lt+=u*It,u=C[7],lt+=u*st,Ze+=u*We,Ae+=u*nt,ke+=u*at,Ke+=u*et,Xe+=u*Je,Ne+=u*wt,Ve+=u*_t,Se+=u*ot,Le+=u*bt,it+=u*ct,Te+=u*ft,mt+=u*ut,Ot+=u*He,Lt+=u*Et,zt+=u*It,u=C[8],Ze+=u*st,Ae+=u*We,ke+=u*nt,Ke+=u*at,Xe+=u*et,Ne+=u*Je,Ve+=u*wt,Se+=u*_t,Le+=u*ot,it+=u*bt,Te+=u*ct,mt+=u*ft,Ot+=u*ut,Lt+=u*He,zt+=u*Et,$t+=u*It,u=C[9],Ae+=u*st,ke+=u*We,Ke+=u*nt,Xe+=u*at,Ne+=u*et,Ve+=u*Je,Se+=u*wt,Le+=u*_t,it+=u*ot,Te+=u*bt,mt+=u*ct,Ot+=u*ft,Lt+=u*ut,zt+=u*He,$t+=u*Et,Ft+=u*It,u=C[10],ke+=u*st,Ke+=u*We,Xe+=u*nt,Ne+=u*at,Ve+=u*et,Se+=u*Je,Le+=u*wt,it+=u*_t,Te+=u*ot,mt+=u*bt,Ot+=u*ct,Lt+=u*ft,zt+=u*ut,$t+=u*He,Ft+=u*Et,Zt+=u*It,u=C[11],Ke+=u*st,Xe+=u*We,Ne+=u*nt,Ve+=u*at,Se+=u*et,Le+=u*Je,it+=u*wt,Te+=u*_t,mt+=u*ot,Ot+=u*bt,Lt+=u*ct,zt+=u*ft,$t+=u*ut,Ft+=u*He,Zt+=u*Et,zr+=u*It,u=C[12],Xe+=u*st,Ne+=u*We,Ve+=u*nt,Se+=u*at,Le+=u*et,it+=u*Je,Te+=u*wt,mt+=u*_t,Ot+=u*ot,Lt+=u*bt,zt+=u*ct,$t+=u*ft,Ft+=u*ut,Zt+=u*He,zr+=u*Et,Bt+=u*It,u=C[13],Ne+=u*st,Ve+=u*We,Se+=u*nt,Le+=u*at,it+=u*et,Te+=u*Je,mt+=u*wt,Ot+=u*_t,Lt+=u*ot,zt+=u*bt,$t+=u*ct,Ft+=u*ft,Zt+=u*ut,zr+=u*He,Bt+=u*Et,Fr+=u*It,u=C[14],Ve+=u*st,Se+=u*We,Le+=u*nt,it+=u*at,Te+=u*et,mt+=u*Je,Ot+=u*wt,Lt+=u*_t,zt+=u*ot,$t+=u*bt,Ft+=u*ct,Zt+=u*ft,zr+=u*ut,Bt+=u*He,Fr+=u*Et,ai+=u*It,u=C[15],Se+=u*st,Le+=u*We,it+=u*nt,Te+=u*at,mt+=u*et,Ot+=u*Je,Lt+=u*wt,zt+=u*_t,$t+=u*ot,Ft+=u*bt,Zt+=u*ct,zr+=u*ft,Bt+=u*ut,Fr+=u*He,ai+=u*Et,Pi+=u*It,J+=38*Le,ae+=38*it,ge+=38*Te,Pe+=38*mt,Re+=38*Ot,_e+=38*Lt,yt+=38*zt,lt+=38*$t,Ze+=38*Ft,Ae+=38*Zt,ke+=38*zr,Ke+=38*Bt,Xe+=38*Fr,Ne+=38*ai,Ve+=38*Pi,E=1,u=J+E+65535,E=Math.floor(u/65536),J=u-E*65536,u=ae+E+65535,E=Math.floor(u/65536),ae=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Re+E+65535,E=Math.floor(u/65536),Re=u-E*65536,u=_e+E+65535,E=Math.floor(u/65536),_e=u-E*65536,u=yt+E+65535,E=Math.floor(u/65536),yt=u-E*65536,u=lt+E+65535,E=Math.floor(u/65536),lt=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=Ae+E+65535,E=Math.floor(u/65536),Ae=u-E*65536,u=ke+E+65535,E=Math.floor(u/65536),ke=u-E*65536,u=Ke+E+65535,E=Math.floor(u/65536),Ke=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Ve+E+65535,E=Math.floor(u/65536),Ve=u-E*65536,u=Se+E+65535,E=Math.floor(u/65536),Se=u-E*65536,J+=E-1+37*(E-1),E=1,u=J+E+65535,E=Math.floor(u/65536),J=u-E*65536,u=ae+E+65535,E=Math.floor(u/65536),ae=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Re+E+65535,E=Math.floor(u/65536),Re=u-E*65536,u=_e+E+65535,E=Math.floor(u/65536),_e=u-E*65536,u=yt+E+65535,E=Math.floor(u/65536),yt=u-E*65536,u=lt+E+65535,E=Math.floor(u/65536),lt=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=Ae+E+65535,E=Math.floor(u/65536),Ae=u-E*65536,u=ke+E+65535,E=Math.floor(u/65536),ke=u-E*65536,u=Ke+E+65535,E=Math.floor(u/65536),Ke=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Ve+E+65535,E=Math.floor(u/65536),Ve=u-E*65536,u=Se+E+65535,E=Math.floor(u/65536),Se=u-E*65536,J+=E-1+37*(E-1),T[0]=J,T[1]=ae,T[2]=ge,T[3]=Pe,T[4]=Re,T[5]=_e,T[6]=yt,T[7]=lt,T[8]=Ze,T[9]=Ae,T[10]=ke,T[11]=Ke,T[12]=Xe,T[13]=Ne,T[14]=Ve,T[15]=Se}function xe(T,C){Q(T,C,C)}function Tt(T,C){const R=a();let u;for(u=0;u<16;u++)R[u]=C[u];for(u=253;u>=0;u--)xe(R,R),u!==2&&u!==4&&Q(R,R,C);for(u=0;u<16;u++)T[u]=R[u]}function vt(T,C){const R=a();let u;for(u=0;u<16;u++)R[u]=C[u];for(u=250;u>=0;u--)xe(R,R),u!==1&&Q(R,R,C);for(u=0;u<16;u++)T[u]=R[u]}function Yt(T,C){const R=a(),u=a(),E=a(),J=a(),ae=a(),ge=a(),Pe=a(),Re=a(),_e=a();pe(R,T[1],T[0]),pe(_e,C[1],C[0]),Q(R,R,_e),fe(u,T[0],T[1]),fe(_e,C[0],C[1]),Q(u,u,_e),Q(E,T[3],C[3]),Q(E,E,g),Q(J,T[2],C[2]),fe(J,J,J),pe(ae,u,R),pe(ge,J,E),fe(Pe,J,E),fe(Re,u,R),Q(T[0],ae,ge),Q(T[1],Re,Pe),Q(T[2],Pe,ge),Q(T[3],ae,Re)}function Vt(T,C,R){for(let u=0;u<4;u++)Z(T[u],C[u],R)}function ur(T,C){const R=a(),u=a(),E=a();Tt(E,C[2]),Q(R,C[0],E),Q(u,C[1],E),te(T,u),T[31]^=ne(R)<<7}function M(T,C,R){q(T[0],p),q(T[1],y),q(T[2],y),q(T[3],p);for(let u=255;u>=0;--u){const E=R[u/8|0]>>(u&7)&1;Vt(T,C,E),Yt(C,T),Yt(T,T),Vt(T,C,E)}}function U(T,C){const R=[a(),a(),a(),a()];q(R[0],_),q(R[1],S),q(R[2],y),Q(R[3],_,S),M(T,R,C)}function Ge(T){if(T.length!==o.SEED_LENGTH)throw new Error(`ed25519: seed must be ${o.SEED_LENGTH} bytes`);const C=(0,i.hash)(T);C[0]&=248,C[31]&=127,C[31]|=64;const R=new Uint8Array(32),u=[a(),a(),a(),a()];U(u,C),ur(R,u);const E=new Uint8Array(64);return E.set(T),E.set(R,32),{publicKey:R,secretKey:E}}o.generateKeyPairFromSeed=Ge;function qe(T){const C=(0,t.randomBytes)(32,T),R=Ge(C);return(0,n.wipe)(C),R}o.generateKeyPair=qe;function G(T){if(T.length!==o.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${o.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}o.extractPublicKeyFromSecretKey=G;const K=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function H(T,C){let R,u,E,J;for(u=63;u>=32;--u){for(R=0,E=u-32,J=u-12;E<J;++E)C[E]+=R-16*C[u]*K[E-(u-32)],R=Math.floor((C[E]+128)/256),C[E]-=R*256;C[E]+=R,C[u]=0}for(R=0,E=0;E<32;E++)C[E]+=R-(C[31]>>4)*K[E],R=C[E]>>8,C[E]&=255;for(E=0;E<32;E++)C[E]-=R*K[E];for(u=0;u<32;u++)C[u+1]+=C[u]>>8,T[u]=C[u]&255}function V(T){const C=new Float64Array(64);for(let R=0;R<64;R++)C[R]=T[R];for(let R=0;R<64;R++)T[R]=0;H(T,C)}function Rt(T,C){const R=new Float64Array(64),u=[a(),a(),a(),a()],E=(0,i.hash)(T.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const J=new Uint8Array(64);J.set(E.subarray(32),32);const ae=new i.SHA512;ae.update(J.subarray(32)),ae.update(C);const ge=ae.digest();ae.clean(),V(ge),U(u,ge),ur(J,u),ae.reset(),ae.update(J.subarray(0,32)),ae.update(T.subarray(32)),ae.update(C);const Pe=ae.digest();V(Pe);for(let Re=0;Re<32;Re++)R[Re]=ge[Re];for(let Re=0;Re<32;Re++)for(let _e=0;_e<32;_e++)R[Re+_e]+=Pe[Re]*E[_e];return H(J.subarray(32),R),J}o.sign=Rt;function rt(T,C){const R=a(),u=a(),E=a(),J=a(),ae=a(),ge=a(),Pe=a();return q(T[2],y),re(T[1],C),xe(E,T[1]),Q(J,E,m),pe(E,E,T[2]),fe(J,T[2],J),xe(ae,J),xe(ge,ae),Q(Pe,ge,ae),Q(R,Pe,E),Q(R,R,J),vt(R,R),Q(R,R,E),Q(R,R,J),Q(R,R,J),Q(T[0],R,J),xe(u,T[0]),Q(u,u,J),oe(u,E)&&Q(T[0],T[0],$),xe(u,T[0]),Q(u,u,J),oe(u,E)?-1:(ne(T[0])===C[31]>>7&&pe(T[0],p,T[0]),Q(T[3],T[0],T[1]),0)}function xi(T,C,R){const u=new Uint8Array(32),E=[a(),a(),a(),a()],J=[a(),a(),a(),a()];if(R.length!==o.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${o.SIGNATURE_LENGTH} bytes`);if(rt(J,T))return!1;const ae=new i.SHA512;ae.update(R.subarray(0,32)),ae.update(T),ae.update(C);const ge=ae.digest();return V(ge),M(E,J,ge),U(J,R.subarray(32)),Yt(E,J),ur(u,E),!ce(R,u)}o.verify=xi;function we(T){let C=[a(),a(),a(),a()];if(rt(C,T))throw new Error("Ed25519: invalid public key");let R=a(),u=a(),E=C[1];fe(R,y,E),pe(u,y,E),Tt(u,u),Q(R,R,u);let J=new Uint8Array(32);return te(J,R),J}o.convertPublicKeyToX25519=we;function Rr(T){const C=(0,i.hash)(T.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const R=new Uint8Array(C.subarray(0,32));return(0,n.wipe)(C),R}o.convertSecretKeyToX25519=Rr})(Nc);const d1="EdDSA",g1="JWT",rf=".",sf="base64url",v1="utf8",y1="utf8",m1=":",w1="did",_1="key",il="base58btc",b1="z",E1="K36",I1=32;function ma(o){return Ea(Oc(Qs(o),v1),sf)}function nf(o){const t=Oc(E1,il),i=b1+Ea(n0([t,o]),il);return[w1,_1,i].join(m1)}function x1(o){return Ea(o,sf)}function P1(o){return Oc([ma(o.header),ma(o.payload)].join(rf),y1)}function S1(o){return[ma(o.header),ma(o.payload),x1(o.signature)].join(rf)}function sl(o=Hl.randomBytes(I1)){return Nc.generateKeyPairFromSeed(o)}async function R1(o,t,i,n,a=X.fromMiliseconds(Date.now())){const h={alg:d1,typ:g1},p=nf(n.publicKey),y=a+i,m={iss:p,sub:o,aud:t,iat:a,exp:y},g=P1({header:h,payload:m}),_=Nc.sign(n.secretKey,g);return S1({header:h,payload:m,signature:_})}let O1=class extends Wl{constructor(t){super(t),this.events=new Sr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(Ui(t.method,t.params||[],t.id||Cc().toString()),i)}async requestStrict(t,i){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{Lr(h)?a(h.error):n(h.result)});try{await this.connection.send(t,i)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ys(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const A1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),C1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",nl=o=>o.split("?")[0],al=10,T1=A1();let $1=class{constructor(t){if(this.url=t,this.events=new Sr.EventEmitter,this.registering=!1,!Vh(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qs(t))}catch(i){this.onError(t.id,i)}}register(t=this.url){if(!Vh(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((i,n)=>{const a=new URLSearchParams(t).get("origin"),h=B0.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!G0(t)},p=new T1(t,[],h);C1()?p.onerror=y=>{const m=y;n(this.emitError(m.error))}:p.on("error",y=>{n(this.emitError(y))}),p.onopen=()=>{this.onOpen(p),i(p)}})}onOpen(t){t.onmessage=i=>this.onPayload(i),t.onclose=i=>this.onClose(i),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?Ia(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const n=this.parseError(i),a=n.message||n.toString(),h=Tc(t,a);this.events.emit("payload",h)}parseError(t,i=this.url){return W0(t,nl(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>al&&this.events.setMaxListeners(al)}emitError(t){const i=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${nl(this.url)}`));return this.events.emit("register_error",i),i}};var wa={exports:{}};wa.exports;(function(o,t){var i=200,n="__lodash_hash_undefined__",a=1,h=2,p=9007199254740991,y="[object Arguments]",m="[object Array]",g="[object AsyncFunction]",_="[object Boolean]",S="[object Date]",$="[object Error]",q="[object Function]",A="[object GeneratorFunction]",Z="[object Map]",te="[object Number]",ce="[object Null]",oe="[object Object]",ne="[object Promise]",re="[object Proxy]",fe="[object RegExp]",pe="[object Set]",Q="[object String]",xe="[object Symbol]",Tt="[object Undefined]",vt="[object WeakMap]",Yt="[object ArrayBuffer]",Vt="[object DataView]",ur="[object Float32Array]",M="[object Float64Array]",U="[object Int8Array]",Ge="[object Int16Array]",qe="[object Int32Array]",G="[object Uint8Array]",K="[object Uint8ClampedArray]",H="[object Uint16Array]",V="[object Uint32Array]",Rt=/[\\^$.*+?()[\]{}|]/g,rt=/^\[object .+?Constructor\]$/,xi=/^(?:0|[1-9]\d*)$/,we={};we[ur]=we[M]=we[U]=we[Ge]=we[qe]=we[G]=we[K]=we[H]=we[V]=!0,we[y]=we[m]=we[Yt]=we[_]=we[Vt]=we[S]=we[$]=we[q]=we[Z]=we[te]=we[oe]=we[fe]=we[pe]=we[Q]=we[vt]=!1;var Rr=typeof aa=="object"&&aa&&aa.Object===Object&&aa,T=typeof self=="object"&&self&&self.Object===Object&&self,C=Rr||T||Function("return this")(),R=t&&!t.nodeType&&t,u=R&&!0&&o&&!o.nodeType&&o,E=u&&u.exports===R,J=E&&Rr.process,ae=function(){try{return J&&J.binding&&J.binding("util")}catch{}}(),ge=ae&&ae.isTypedArray;function Pe(v,I){for(var z=-1,F=v==null?0:v.length,je=0,he=[];++z<F;){var Fe=v[z];I(Fe,z,v)&&(he[je++]=Fe)}return he}function Re(v,I){for(var z=-1,F=I.length,je=v.length;++z<F;)v[je+z]=I[z];return v}function _e(v,I){for(var z=-1,F=v==null?0:v.length;++z<F;)if(I(v[z],z,v))return!0;return!1}function yt(v,I){for(var z=-1,F=Array(v);++z<v;)F[z]=I(z);return F}function lt(v){return function(I){return v(I)}}function Ze(v,I){return v.has(I)}function Ae(v,I){return v==null?void 0:v[I]}function ke(v){var I=-1,z=Array(v.size);return v.forEach(function(F,je){z[++I]=[je,F]}),z}function Ke(v,I){return function(z){return v(I(z))}}function Xe(v){var I=-1,z=Array(v.size);return v.forEach(function(F){z[++I]=F}),z}var Ne=Array.prototype,Ve=Function.prototype,Se=Object.prototype,Le=C["__core-js_shared__"],it=Ve.toString,Te=Se.hasOwnProperty,mt=function(){var v=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ot=Se.toString,Lt=RegExp("^"+it.call(Te).replace(Rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=E?C.Buffer:void 0,$t=C.Symbol,Ft=C.Uint8Array,Zt=Se.propertyIsEnumerable,zr=Ne.splice,Bt=$t?$t.toStringTag:void 0,Fr=Object.getOwnPropertySymbols,ai=zt?zt.isBuffer:void 0,Pi=Ke(Object.keys,Object),st=hr(C,"DataView"),We=hr(C,"Map"),nt=hr(C,"Promise"),at=hr(C,"Set"),et=hr(C,"WeakMap"),Je=hr(Object,"create"),wt=Gr(st),_t=Gr(We),ot=Gr(nt),bt=Gr(at),ct=Gr(et),ft=$t?$t.prototype:void 0,ut=ft?ft.valueOf:void 0;function He(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var F=v[I];this.set(F[0],F[1])}}function Et(){this.__data__=Je?Je(null):{},this.size=0}function It(v){var I=this.has(v)&&delete this.__data__[v];return this.size-=I?1:0,I}function Ca(v){var I=this.__data__;if(Je){var z=I[v];return z===n?void 0:z}return Te.call(I,v)?I[v]:void 0}function Ta(v){var I=this.__data__;return Je?I[v]!==void 0:Te.call(I,v)}function $a(v,I){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=Je&&I===void 0?n:I,this}He.prototype.clear=Et,He.prototype.delete=It,He.prototype.get=Ca,He.prototype.has=Ta,He.prototype.set=$a;function vr(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var F=v[I];this.set(F[0],F[1])}}function Na(){this.__data__=[],this.size=0}function Da(v){var I=this.__data__,z=Si(I,v);if(z<0)return!1;var F=I.length-1;return z==F?I.pop():zr.call(I,z,1),--this.size,!0}function qa(v){var I=this.__data__,z=Si(I,v);return z<0?void 0:I[z][1]}function La(v){return Si(this.__data__,v)>-1}function za(v,I){var z=this.__data__,F=Si(z,v);return F<0?(++this.size,z.push([v,I])):z[F][1]=I,this}vr.prototype.clear=Na,vr.prototype.delete=Da,vr.prototype.get=qa,vr.prototype.has=La,vr.prototype.set=za;function Br(v){var I=-1,z=v==null?0:v.length;for(this.clear();++I<z;){var F=v[I];this.set(F[0],F[1])}}function Vi(){this.size=0,this.__data__={hash:new He,map:new(We||vr),string:new He}}function ja(v){var I=oi(this,v).delete(v);return this.size-=I?1:0,I}function Fi(v){return oi(this,v).get(v)}function Ma(v){return oi(this,v).has(v)}function Ua(v,I){var z=oi(this,v),F=z.size;return z.set(v,I),this.size+=z.size==F?0:1,this}Br.prototype.clear=Vi,Br.prototype.delete=ja,Br.prototype.get=Fi,Br.prototype.has=Ma,Br.prototype.set=Ua;function Bi(v){var I=-1,z=v==null?0:v.length;for(this.__data__=new Br;++I<z;)this.add(v[I])}function tn(v){return this.__data__.set(v,n),this}function rn(v){return this.__data__.has(v)}Bi.prototype.add=Bi.prototype.push=tn,Bi.prototype.has=rn;function Or(v){var I=this.__data__=new vr(v);this.size=I.size}function Ha(){this.__data__=new vr,this.size=0}function ka(v){var I=this.__data__,z=I.delete(v);return this.size=I.size,z}function Ka(v){return this.__data__.get(v)}function Va(v){return this.__data__.has(v)}function sn(v,I){var z=this.__data__;if(z instanceof vr){var F=z.__data__;if(!We||F.length<i-1)return F.push([v,I]),this.size=++z.size,this;z=this.__data__=new Br(F)}return z.set(v,I),this.size=z.size,this}Or.prototype.clear=Ha,Or.prototype.delete=ka,Or.prototype.get=Ka,Or.prototype.has=Va,Or.prototype.set=sn;function nn(v,I){var z=Ji(v),F=!z&&yn(v),je=!z&&!F&&_s(v),he=!z&&!F&&!je&&_n(v),Fe=z||F||je||he,xt=Fe?yt(v.length,String):[],Ee=xt.length;for(var Me in v)Te.call(v,Me)&&!(Fe&&(Me=="length"||je&&(Me=="offset"||Me=="parent")||he&&(Me=="buffer"||Me=="byteLength"||Me=="byteOffset")||fn(Me,Ee)))&&xt.push(Me);return xt}function Si(v,I){for(var z=v.length;z--;)if(vn(v[z][0],I))return z;return-1}function ms(v,I,z){var F=I(v);return Ji(v)?F:Re(F,z(v))}function Ri(v){return v==null?v===void 0?Tt:ce:Bt&&Bt in Object(v)?hn(v):Ga(v)}function ws(v){return Ai(v)&&Ri(v)==y}function Oi(v,I,z,F,je){return v===I?!0:v==null||I==null||!Ai(v)&&!Ai(I)?v!==v&&I!==I:an(v,I,z,F,Oi,je)}function an(v,I,z,F,je,he){var Fe=Ji(v),xt=Ji(I),Ee=Fe?m:jr(v),Me=xt?m:jr(I);Ee=Ee==y?oe:Ee,Me=Me==y?oe:Me;var pt=Ee==oe,Xt=Me==oe,Pt=Ee==Me;if(Pt&&_s(v)){if(!_s(I))return!1;Fe=!0,pt=!1}if(Pt&&!pt)return he||(he=new Or),Fe||_n(v)?Gi(v,I,z,F,je,he):Ba(v,I,Ee,z,F,je,he);if(!(z&a)){var Be=pt&&Te.call(v,"__wrapped__"),Gt=Xt&&Te.call(I,"__wrapped__");if(Be||Gt){var Ar=Be?v.value():v,yr=Gt?I.value():I;return he||(he=new Or),je(Ar,yr,z,F,he)}}return Pt?(he||(he=new Or),un(v,I,z,F,je,he)):!1}function Fa(v){if(!wn(v)||dn(v))return!1;var I=Qi(v)?Lt:rt;return I.test(Gr(v))}function on(v){return Ai(v)&&mn(v.length)&&!!we[Ri(v)]}function cn(v){if(!gn(v))return Pi(v);var I=[];for(var z in Object(v))Te.call(v,z)&&z!="constructor"&&I.push(z);return I}function Gi(v,I,z,F,je,he){var Fe=z&a,xt=v.length,Ee=I.length;if(xt!=Ee&&!(Fe&&Ee>xt))return!1;var Me=he.get(v);if(Me&&he.get(I))return Me==I;var pt=-1,Xt=!0,Pt=z&h?new Bi:void 0;for(he.set(v,I),he.set(I,v);++pt<xt;){var Be=v[pt],Gt=I[pt];if(F)var Ar=Fe?F(Gt,Be,pt,I,v,he):F(Be,Gt,pt,v,I,he);if(Ar!==void 0){if(Ar)continue;Xt=!1;break}if(Pt){if(!_e(I,function(yr,Mr){if(!Ze(Pt,Mr)&&(Be===yr||je(Be,yr,z,F,he)))return Pt.push(Mr)})){Xt=!1;break}}else if(!(Be===Gt||je(Be,Gt,z,F,he))){Xt=!1;break}}return he.delete(v),he.delete(I),Xt}function Ba(v,I,z,F,je,he,Fe){switch(z){case Vt:if(v.byteLength!=I.byteLength||v.byteOffset!=I.byteOffset)return!1;v=v.buffer,I=I.buffer;case Yt:return!(v.byteLength!=I.byteLength||!he(new Ft(v),new Ft(I)));case _:case S:case te:return vn(+v,+I);case $:return v.name==I.name&&v.message==I.message;case fe:case Q:return v==I+"";case Z:var xt=ke;case pe:var Ee=F&a;if(xt||(xt=Xe),v.size!=I.size&&!Ee)return!1;var Me=Fe.get(v);if(Me)return Me==I;F|=h,Fe.set(v,I);var pt=Gi(xt(v),xt(I),F,je,he,Fe);return Fe.delete(v),pt;case xe:if(ut)return ut.call(v)==ut.call(I)}return!1}function un(v,I,z,F,je,he){var Fe=z&a,xt=Wi(v),Ee=xt.length,Me=Wi(I),pt=Me.length;if(Ee!=pt&&!Fe)return!1;for(var Xt=Ee;Xt--;){var Pt=xt[Xt];if(!(Fe?Pt in I:Te.call(I,Pt)))return!1}var Be=he.get(v);if(Be&&he.get(I))return Be==I;var Gt=!0;he.set(v,I),he.set(I,v);for(var Ar=Fe;++Xt<Ee;){Pt=xt[Xt];var yr=v[Pt],Mr=I[Pt];if(F)var bs=Fe?F(Mr,yr,Pt,I,v,he):F(yr,Mr,Pt,v,I,he);if(!(bs===void 0?yr===Mr||je(yr,Mr,z,F,he):bs)){Gt=!1;break}Ar||(Ar=Pt=="constructor")}if(Gt&&!Ar){var Ci=v.constructor,Nt=I.constructor;Ci!=Nt&&"constructor"in v&&"constructor"in I&&!(typeof Ci=="function"&&Ci instanceof Ci&&typeof Nt=="function"&&Nt instanceof Nt)&&(Gt=!1)}return he.delete(v),he.delete(I),Gt}function Wi(v){return ms(v,Qa,ln)}function oi(v,I){var z=v.__data__;return pn(I)?z[typeof I=="string"?"string":"hash"]:z.map}function hr(v,I){var z=Ae(v,I);return Fa(z)?z:void 0}function hn(v){var I=Te.call(v,Bt),z=v[Bt];try{v[Bt]=void 0;var F=!0}catch{}var je=Ot.call(v);return F&&(I?v[Bt]=z:delete v[Bt]),je}var ln=Fr?function(v){return v==null?[]:(v=Object(v),Pe(Fr(v),function(I){return Zt.call(v,I)}))}:ze,jr=Ri;(st&&jr(new st(new ArrayBuffer(1)))!=Vt||We&&jr(new We)!=Z||nt&&jr(nt.resolve())!=ne||at&&jr(new at)!=pe||et&&jr(new et)!=vt)&&(jr=function(v){var I=Ri(v),z=I==oe?v.constructor:void 0,F=z?Gr(z):"";if(F)switch(F){case wt:return Vt;case _t:return Z;case ot:return ne;case bt:return pe;case ct:return vt}return I});function fn(v,I){return I=I??p,!!I&&(typeof v=="number"||xi.test(v))&&v>-1&&v%1==0&&v<I}function pn(v){var I=typeof v;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?v!=="__proto__":v===null}function dn(v){return!!mt&&mt in v}function gn(v){var I=v&&v.constructor,z=typeof I=="function"&&I.prototype||Se;return v===z}function Ga(v){return Ot.call(v)}function Gr(v){if(v!=null){try{return it.call(v)}catch{}try{return v+""}catch{}}return""}function vn(v,I){return v===I||v!==v&&I!==I}var yn=ws(function(){return arguments}())?ws:function(v){return Ai(v)&&Te.call(v,"callee")&&!Zt.call(v,"callee")},Ji=Array.isArray;function Wa(v){return v!=null&&mn(v.length)&&!Qi(v)}var _s=ai||De;function Ja(v,I){return Oi(v,I)}function Qi(v){if(!wn(v))return!1;var I=Ri(v);return I==q||I==A||I==g||I==re}function mn(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=p}function wn(v){var I=typeof v;return v!=null&&(I=="object"||I=="function")}function Ai(v){return v!=null&&typeof v=="object"}var _n=ge?lt(ge):on;function Qa(v){return Wa(v)?nn(v):cn(v)}function ze(){return[]}function De(){return!1}o.exports=Ja})(wa,wa.exports);var N1=wa.exports;const D1=Rc(N1);function q1(o,t){return t=t||{},new Promise(function(i,n){var a=new XMLHttpRequest,h=[],p=[],y={},m=function(){return{ok:(a.status/100|0)==2,statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:m,headers:{keys:function(){return h},entries:function(){return p},get:function(_){return y[_.toLowerCase()]},has:function(_){return _.toLowerCase()in y}}}};for(var g in a.open(t.method||"get",o,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(_,S,$){h.push(S=S.toLowerCase()),p.push([S,$]),y[S]=y[S]?y[S]+","+$:$}),i(m())},a.onerror=n,a.withCredentials=t.credentials=="include",t.headers)a.setRequestHeader(g,t.headers[g]);a.send(t.body||null)})}const L1=Object.freeze(Object.defineProperty({__proto__:null,default:q1},Symbol.toStringTag,{value:"Module"})),ol=Ml(L1);var z1=self.fetch||(self.fetch=ol.default||ol);const j1=Rc(z1);var M1={};function U1(o,t){if(o.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var a=0;a<o.length;a++){var h=o.charAt(a),p=h.charCodeAt(0);if(i[p]!==255)throw new TypeError(h+" is ambiguous");i[p]=a}var y=o.length,m=o.charAt(0),g=Math.log(y)/Math.log(256),_=Math.log(256)/Math.log(y);function S(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var Z=0,te=0,ce=0,oe=A.length;ce!==oe&&A[ce]===0;)ce++,Z++;for(var ne=(oe-ce)*_+1>>>0,re=new Uint8Array(ne);ce!==oe;){for(var fe=A[ce],pe=0,Q=ne-1;(fe!==0||pe<te)&&Q!==-1;Q--,pe++)fe+=256*re[Q]>>>0,re[Q]=fe%y>>>0,fe=fe/y>>>0;if(fe!==0)throw new Error("Non-zero carry");te=pe,ce++}for(var xe=ne-te;xe!==ne&&re[xe]===0;)xe++;for(var Tt=m.repeat(Z);xe<ne;++xe)Tt+=o.charAt(re[xe]);return Tt}function $(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var Z=0;if(A[Z]!==" "){for(var te=0,ce=0;A[Z]===m;)te++,Z++;for(var oe=(A.length-Z)*g+1>>>0,ne=new Uint8Array(oe);A[Z];){var re=i[A.charCodeAt(Z)];if(re===255)return;for(var fe=0,pe=oe-1;(re!==0||fe<ce)&&pe!==-1;pe--,fe++)re+=y*ne[pe]>>>0,ne[pe]=re%256>>>0,re=re/256>>>0;if(re!==0)throw new Error("Non-zero carry");ce=fe,Z++}if(A[Z]!==" "){for(var Q=oe-ce;Q!==oe&&ne[Q]===0;)Q++;for(var xe=new Uint8Array(te+(oe-Q)),Tt=te;Q!==oe;)xe[Tt++]=ne[Q++];return xe}}}function q(A){var Z=$(A);if(Z)return Z;throw new Error(`Non-${t} character`)}return{encode:S,decodeUnsafe:$,decode:q}}var H1=U1,k1=H1;const af=o=>{if(o instanceof Uint8Array&&o.constructor.name==="Uint8Array")return o;if(o instanceof ArrayBuffer)return new Uint8Array(o);if(ArrayBuffer.isView(o))return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);throw new Error("Unknown type, must be binary type")},K1=o=>new TextEncoder().encode(o),V1=o=>new TextDecoder().decode(o);class F1{constructor(t,i,n){this.name=t,this.prefix=i,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class B1{constructor(t,i,n){if(this.name=t,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return of(this,t)}}class G1{constructor(t){this.decoders=t}or(t){return of(this,t)}decode(t){const i=t[0],n=this.decoders[i];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const of=(o,t)=>new G1({...o.decoders||{[o.prefix]:o},...t.decoders||{[t.prefix]:t}});class W1{constructor(t,i,n,a){this.name=t,this.prefix=i,this.baseEncode=n,this.baseDecode=a,this.encoder=new F1(t,i,n),this.decoder=new B1(t,i,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Oa=({name:o,prefix:t,encode:i,decode:n})=>new W1(o,t,i,n),en=({prefix:o,name:t,alphabet:i})=>{const{encode:n,decode:a}=k1(i,t);return Oa({prefix:o,name:t,encode:n,decode:h=>af(a(h))})},J1=(o,t,i,n)=>{const a={};for(let _=0;_<t.length;++_)a[t[_]]=_;let h=o.length;for(;o[h-1]==="=";)--h;const p=new Uint8Array(h*i/8|0);let y=0,m=0,g=0;for(let _=0;_<h;++_){const S=a[o[_]];if(S===void 0)throw new SyntaxError(`Non-${n} character`);m=m<<i|S,y+=i,y>=8&&(y-=8,p[g++]=255&m>>y)}if(y>=i||255&m<<8-y)throw new SyntaxError("Unexpected end of data");return p},Q1=(o,t,i)=>{const n=t[t.length-1]==="=",a=(1<<i)-1;let h="",p=0,y=0;for(let m=0;m<o.length;++m)for(y=y<<8|o[m],p+=8;p>i;)p-=i,h+=t[a&y>>p];if(p&&(h+=t[a&y<<i-p]),n)for(;h.length*i&7;)h+="=";return h},Mt=({name:o,prefix:t,bitsPerChar:i,alphabet:n})=>Oa({prefix:t,name:o,encode(a){return Q1(a,n,i)},decode(a){return J1(a,n,i,o)}}),Y1=Oa({prefix:"\0",name:"identity",encode:o=>V1(o),decode:o=>K1(o)});var Z1=Object.freeze({__proto__:null,identity:Y1});const X1=Mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var e_=Object.freeze({__proto__:null,base2:X1});const t_=Mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var r_=Object.freeze({__proto__:null,base8:t_});const i_=en({prefix:"9",name:"base10",alphabet:"0123456789"});var s_=Object.freeze({__proto__:null,base10:i_});const n_=Mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),a_=Mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var o_=Object.freeze({__proto__:null,base16:n_,base16upper:a_});const c_=Mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),u_=Mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),h_=Mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),l_=Mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),f_=Mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),p_=Mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),d_=Mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),g_=Mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),v_=Mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var y_=Object.freeze({__proto__:null,base32:c_,base32upper:u_,base32pad:h_,base32padupper:l_,base32hex:f_,base32hexupper:p_,base32hexpad:d_,base32hexpadupper:g_,base32z:v_});const m_=en({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),w_=en({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var __=Object.freeze({__proto__:null,base36:m_,base36upper:w_});const b_=en({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),E_=en({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var I_=Object.freeze({__proto__:null,base58btc:b_,base58flickr:E_});const x_=Mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),P_=Mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),S_=Mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),R_=Mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var O_=Object.freeze({__proto__:null,base64:x_,base64pad:P_,base64url:S_,base64urlpad:R_});const cf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),A_=cf.reduce((o,t,i)=>(o[i]=t,o),[]),C_=cf.reduce((o,t,i)=>(o[t.codePointAt(0)]=i,o),[]);function T_(o){return o.reduce((t,i)=>(t+=A_[i],t),"")}function $_(o){const t=[];for(const i of o){const n=C_[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);t.push(n)}return new Uint8Array(t)}const N_=Oa({prefix:"🚀",name:"base256emoji",encode:T_,decode:$_});var D_=Object.freeze({__proto__:null,base256emoji:N_}),q_=uf,cl=128,L_=127,z_=~L_,j_=Math.pow(2,31);function uf(o,t,i){t=t||[],i=i||0;for(var n=i;o>=j_;)t[i++]=o&255|cl,o/=128;for(;o&z_;)t[i++]=o&255|cl,o>>>=7;return t[i]=o|0,uf.bytes=i-n+1,t}var M_=bc,U_=128,ul=127;function bc(o,n){var i=0,n=n||0,a=0,h=n,p,y=o.length;do{if(h>=y)throw bc.bytes=0,new RangeError("Could not decode varint");p=o[h++],i+=a<28?(p&ul)<<a:(p&ul)*Math.pow(2,a),a+=7}while(p>=U_);return bc.bytes=h-n,i}var H_=Math.pow(2,7),k_=Math.pow(2,14),K_=Math.pow(2,21),V_=Math.pow(2,28),F_=Math.pow(2,35),B_=Math.pow(2,42),G_=Math.pow(2,49),W_=Math.pow(2,56),J_=Math.pow(2,63),Q_=function(o){return o<H_?1:o<k_?2:o<K_?3:o<V_?4:o<F_?5:o<B_?6:o<G_?7:o<W_?8:o<J_?9:10},Y_={encode:q_,decode:M_,encodingLength:Q_},hf=Y_;const hl=(o,t,i=0)=>(hf.encode(o,t,i),t),ll=o=>hf.encodingLength(o),Ec=(o,t)=>{const i=t.byteLength,n=ll(o),a=n+ll(i),h=new Uint8Array(a+i);return hl(o,h,0),hl(i,h,n),h.set(t,a),new Z_(o,i,t,h)};class Z_{constructor(t,i,n,a){this.code=t,this.size=i,this.digest=n,this.bytes=a}}const lf=({name:o,code:t,encode:i})=>new X_(o,t,i);class X_{constructor(t,i,n){this.name=t,this.code=i,this.encode=n}digest(t){if(t instanceof Uint8Array){const i=this.encode(t);return i instanceof Uint8Array?Ec(this.code,i):i.then(n=>Ec(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ff=o=>async t=>new Uint8Array(await crypto.subtle.digest(o,t)),eb=lf({name:"sha2-256",code:18,encode:ff("SHA-256")}),tb=lf({name:"sha2-512",code:19,encode:ff("SHA-512")});var rb=Object.freeze({__proto__:null,sha256:eb,sha512:tb});const pf=0,ib="identity",df=af,sb=o=>Ec(pf,df(o)),nb={code:pf,name:ib,encode:df,digest:sb};var ab=Object.freeze({__proto__:null,identity:nb});new TextEncoder,new TextDecoder;const fl={...Z1,...e_,...r_,...s_,...o_,...y_,...__,...I_,...O_,...D_};({...rb,...ab});function gf(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function ob(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gf(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function vf(o,t,i,n){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:i},decoder:{decode:n}}}const pl=vf("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),cc=vf("ascii","a",o=>{let t="a";for(let i=0;i<o.length;i++)t+=String.fromCharCode(o[i]);return t},o=>{o=o.substring(1);const t=ob(o.length);for(let i=0;i<o.length;i++)t[i]=o.charCodeAt(i);return t}),cb={utf8:pl,"utf-8":pl,hex:fl.base16,latin1:cc,ascii:cc,binary:cc,...fl};function ub(o,t="utf8"){const i=cb[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gf(globalThis.Buffer.from(o,"utf-8")):i.decoder.decode(`${i.prefix}${o}`)}const yf="wc",hb=2,Dc="core",_i=`${yf}@2:${Dc}:`,lb={name:Dc,logger:"error"},fb={database:":memory:"},pb="crypto",dl="client_ed25519_seed",db=X.ONE_DAY,gb="keychain",vb="0.3",yb="messages",mb="0.3",wb=X.SIX_HOURS,_b="publisher",mf="irn",bb="error",wf="wss://relay.walletconnect.com",gl="wss://relay.walletconnect.org",Eb="relayer",Kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Ib="_subscription",ii={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},xb=X.ONE_SECOND,Pb="2.11.0",Sb=1e4,Rb="0.3",Ob="WALLETCONNECT_CLIENT_ID",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Ab="subscription",Cb="0.3",Tb=X.FIVE_SECONDS*1e3,$b="pairing",Nb="0.3",Ms={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},Fs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Db="history",qb="0.3",Lb="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},zb="0.3",uc="verify-api",ds="https://verify.walletconnect.com",Ic="https://verify.walletconnect.org",jb=[ds,Ic],Mb="echo",Ub="https://echo.walletconnect.com";class Hb{constructor(t,i){this.core=t,this.logger=i,this.keychain=new Map,this.name=gb,this.version=vb,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:h}=B("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=cr(i,this.name)}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Fl(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Bl(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kb{constructor(t,i,n){this.core=t,this.logger=i,this.name=pb,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=sl(a);return nf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=c0();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),p=sl(h),y=yc();return await R1(y,a,db,p)},this.generateSharedKey=(a,h,p)=>{this.isInitialized();const y=this.getPrivateKey(a),m=u0(y,h);return this.setSymKey(m,p)},this.setSymKey=async(a,h)=>{this.isInitialized();const p=h||h0(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,p)=>{this.isInitialized();const y=l0(p),m=Qs(h);if(jh(y)){const $=y.senderPublicKey,q=y.receiverPublicKey;a=await this.generateSharedKey($,q)}const g=this.getSymKey(a),{type:_,senderPublicKey:S}=y;return f0({type:_,symKey:g,message:m,senderPublicKey:S})},this.decode=async(a,h,p)=>{this.isInitialized();const y=p0(h,p);if(jh(y)){const m=y.receiverPublicKey,g=y.senderPublicKey;a=await this.generateSharedKey(m,g)}try{const m=this.getSymKey(a),g=d0({symKey:m,encoded:h});return Ia(g)}catch(m){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=a=>{const h=Mh(a);return g0(h.type)},this.getPayloadSenderPublicKey=a=>{const h=Mh(a);return h.senderPublicKey?Ea(h.senderPublicKey,v0):void 0},this.core=t,this.logger=cr(i,this.name),this.keychain=n||new Hb(this.core,this.logger)}get context(){return or(this.logger)}async setPrivateKey(t,i){return await this.keychain.set(t,i),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(dl)}catch{t=yc(),await this.keychain.set(dl,t)}return ub(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Kb extends s1{constructor(t,i){super(t,i),this.logger=t,this.core=i,this.messages=new Map,this.name=yb,this.version=mb,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const h=gs(a);let p=this.messages.get(n);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=a,this.messages.set(n,p),await this.persist()),h},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const h=this.get(n),p=gs(a);return typeof h[p]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=cr(t,this.name),this.core=i}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Fl(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Bl(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Vb extends n1{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.events=new Sr.EventEmitter,this.name=_b,this.queue=new Map,this.publishTimeout=X.toMiliseconds(X.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,h)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}});try{const y=(h==null?void 0:h.ttl)||wb,m=mc(h),g=(h==null?void 0:h.prompt)||!1,_=(h==null?void 0:h.tag)||0,S=(h==null?void 0:h.id)||Cc().toString(),$={topic:n,message:a,opts:{ttl:y,relay:m,prompt:g,tag:_,id:S}},q=setTimeout(()=>this.queue.set(S,$),this.publishTimeout);try{await await Gs(this.rpcPublish(n,a,y,m,g,_,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(Kt.publish,$)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=h==null?void 0:h.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(S),A;return}finally{clearTimeout(q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=cr(i,this.name),this.registerEventListeners()}get context(){return or(this.logger)}rpcPublish(t,i,n,a,h,p,y){var m,g,_,S;const $={method:da(a.protocol).publish,params:{topic:t,message:i,ttl:n,prompt:h,tag:p},id:y};return wi((m=$.params)==null?void 0:m.prompt)&&((g=$.params)==null||delete g.prompt),wi((_=$.params)==null?void 0:_.tag)&&((S=$.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:$}),this.relayer.request($)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:i,message:n,opts:a}=t;await this.publish(i,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Kt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class Fb{constructor(){this.map=new Map,this.set=(t,i)=>{const n=this.get(t);this.exists(t,i)||this.map.set(t,[...n,i])},this.get=t=>this.map.get(t)||[],this.exists=(t,i)=>this.get(t).includes(i),this.delete=(t,i)=>{if(typeof i>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,i))return;const a=n.filter(h=>h!==i);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Bb=Object.defineProperty,Gb=Object.defineProperties,Wb=Object.getOwnPropertyDescriptors,vl=Object.getOwnPropertySymbols,Jb=Object.prototype.hasOwnProperty,Qb=Object.prototype.propertyIsEnumerable,yl=(o,t,i)=>t in o?Bb(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Us=(o,t)=>{for(var i in t||(t={}))Jb.call(t,i)&&yl(o,i,t[i]);if(vl)for(var i of vl(t))Qb.call(t,i)&&yl(o,i,t[i]);return o},hc=(o,t)=>Gb(o,Wb(t));class Yb extends c1{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.subscriptions=new Map,this.topicMap=new Fb,this.events=new Sr.EventEmitter,this.name=Ab,this.version=Cb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=_i,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const h=mc(a),p={topic:n,relay:h};this.pending.set(n,p);const y=await this.rpcSubscribe(n,h);return this.onSubscribe(y,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),y}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,h)=>{const p=new X.Watch;p.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=Tb&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=cr(i,this.name),this.clientId=""}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,i){let n=!1;try{n=this.getSubscription(t).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,i){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,i)))}async unsubscribeById(t,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}});try{const a=mc(n);await this.rpcUnsubscribe(t,i,a);const h=kt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,i){const n={method:da(i.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Gs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}return gs(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const i=t[0].relay,n={method:da(i.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Gs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}}rpcUnsubscribe(t,i,n){const a={method:da(n.protocol).unsubscribe,params:{topic:t,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,i){this.setSubscription(t,hc(Us({},i),{id:t})),this.pending.delete(i.topic)}onBatchSubscribe(t){t.length&&t.forEach(i=>{this.setSubscription(i.id,Us({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(t,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,t)&&this.deleteSubscription(i,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,i){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:i}),this.addSubscription(t,i))}addSubscription(t,i){this.subscriptions.set(t,Us({},i)),this.topicMap.set(i.topic,t),this.events.emit(Dr.created,i)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const i=this.subscriptions.get(t);if(!i){const{message:n}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}deleteSubscription(t,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:i});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Dr.deleted,hc(Us({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Dr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:i}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const i=await this.rpcBatchSubscribe(t);vs(i)&&this.onBatchSubscribe(i.map((n,a)=>hc(Us({},t[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(i=>{t.push(i)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Kt.connect,async()=>{await this.onConnect()}),this.relayer.on(Kt.disconnect,()=>{this.onDisconnect()}),this.events.on(Dr.created,async t=>{const i=Dr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()}),this.events.on(Dr.deleted,async t=>{const i=Dr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),t())},this.pollingInterval)})}}var Zb=Object.defineProperty,ml=Object.getOwnPropertySymbols,Xb=Object.prototype.hasOwnProperty,eE=Object.prototype.propertyIsEnumerable,wl=(o,t,i)=>t in o?Zb(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,tE=(o,t)=>{for(var i in t||(t={}))Xb.call(t,i)&&wl(o,i,t[i]);if(ml)for(var i of ml(t))eE.call(t,i)&&wl(o,i,t[i]);return o};class rE extends a1{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Sr.EventEmitter,this.name=Eb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(Kt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(Kt.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ii.payload,this.onPayloadHandler),this.provider.on(ii.connect,this.onConnectHandler),this.provider.on(ii.disconnect,this.onDisconnectHandler),this.provider.on(ii.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?cr(t.logger,this.name):Sa(Ra({level:t.logger||bb})),this.messages=new Kb(this.logger,t.core),this.subscriber=new Yb(this,this.logger),this.publisher=new Vb(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||wf,this.projectId=t.projectId,this.bundleId=y0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${gl}...`),await this.restartTransport(gl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Sb)}get context(){return or(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,i,n){this.isInitialized(),await this.publisher.publish(t,i,n),await this.recordMessageEvent({topic:t,message:i,publishedAt:Date.now()})}async subscribe(t,i){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(a)return a;let h;const p=y=>{y.topic===t&&(this.subscriber.off(Dr.created,p),h())};return await Promise.all([new Promise(y=>{h=y,this.subscriber.on(Dr.created,p)}),new Promise(async y=>{a=await this.subscriber.subscribe(t,i),y()})]),a}async unsubscribe(t,i){this.isInitialized(),await this.subscriber.unsubscribe(t,i)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Gs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once(Dr.resubscribed,()=>{i()})}),new Promise(async(i,n)=>{try{await Gs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}i()})])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.provider.events.emit(ii.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Uh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(i=>t.includes(i))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new O1(new $1(m0({sdkVersion:Pb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:i,message:n}=t;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(t){const{topic:i,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const a=this.messages.has(i,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),$c(t)){if(!t.method.endsWith(Ib))return;const i=t.params,{topic:n,message:a,publishedAt:h}=i.data,p={topic:n,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(tE({type:"event",event:i.id},p)),this.events.emit(i.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else Ys(t)&&this.events.emit(Kt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Kt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const i=xa(t.id,!0);await this.provider.connection.send(i)}unregisterProviderListeners(){this.provider.off(ii.payload,this.onPayloadHandler),this.provider.off(ii.connect,this.onConnectHandler),this.provider.off(ii.disconnect,this.onDisconnectHandler),this.provider.off(ii.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Kt.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let t=await Uh();w0(async i=>{this.initialized&&t!==i&&(t=i,i?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Kt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},X.toMiliseconds(xb)))}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var iE=Object.defineProperty,_l=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,nE=Object.prototype.propertyIsEnumerable,bl=(o,t,i)=>t in o?iE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,El=(o,t)=>{for(var i in t||(t={}))sE.call(t,i)&&bl(o,i,t[i]);if(_l)for(var i of _l(t))nE.call(t,i)&&bl(o,i,t[i]);return o};class Aa extends o1{constructor(t,i,n,a=_i,h=void 0){super(t,i,n,a),this.core=t,this.logger=i,this.name=n,this.map=new Map,this.version=Rb,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!wi(p)?this.map.set(this.getKey(p),p):a0(p)?this.map.set(p.id,p):o0(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,y)=>{this.isInitialized(),this.map.has(p)?await this.update(p,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:y}),this.map.set(p,y),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(y=>Object.keys(p).every(m=>D1(y[m],p[m]))):this.values),this.update=async(p,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:y});const m=El(El({},this.getData(p)),y);this.map.set(p,m),await this.persist()},this.delete=async(p,y)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:y}),this.map.delete(p),await this.persist())},this.logger=cr(i,this.name),this.storagePrefix=a,this.getKey=h}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const i=this.map.get(t);if(!i){const{message:n}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:i}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aE{constructor(t,i){this.core=t,this.logger=i,this.name=$b,this.version=Nb,this.events=new Ac,this.initialized=!1,this.storagePrefix=_i,this.ignoredPayloadTypes=[kl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=yc(),a=await this.core.crypto.setSymKey(n),h=qr(X.FIVE_MINUTES),p={protocol:mf},y={topic:a,expiry:h,relay:p,active:!1},m=_0({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:p});return await this.pairings.set(a,y),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:m}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:h,relay:p}=Hh(n.uri);let y;if(this.pairings.keys.includes(a)&&(y=this.pairings.get(a),y.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const m=qr(X.FIVE_MINUTES),g={topic:a,relay:p,expiry:m,active:!1};return await this.pairings.set(a,g),this.core.expirer.set(a,m),n.activatePairing&&await this.activate({topic:a}),this.events.emit(Fs.create,g),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:p})),g},this.activate=async({topic:n})=>{this.isInitialized();const a=qr(X.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:y,reject:m}=fs();this.events.once(St("pairing_ping",h),({error:g})=>{g?m(g):y()}),await p()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",kt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,h)=>{const p=Ui(a,h),y=await this.core.crypto.encode(n,p),m=Ms[a].req;return this.core.history.set(n,p),this.core.relayer.publish(n,y,m),p.id},this.sendResult=async(n,a,h)=>{const p=xa(n,h),y=await this.core.crypto.encode(a,p),m=await this.core.history.get(a,n),g=Ms[m.request.method].res;await this.core.relayer.publish(a,y,g),await this.core.history.resolve(p)},this.sendError=async(n,a,h)=>{const p=Tc(n,h),y=await this.core.crypto.encode(a,p),m=await this.core.history.get(a,n),g=Ms[m.request.method]?Ms[m.request.method].res:Ms.unregistered_method.res;await this.core.relayer.publish(a,y,g),await this.core.history.resolve(p)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>mi(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:h}=n,p=(await this.core.history.get(a,h.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(n,a)=>{const{id:h}=a;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(Fs.ping,{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onPairingPingResponse=(n,a)=>{const{id:h}=a;setTimeout(()=>{yi(a)?this.events.emit(St("pairing_ping",h),{}):Lr(a)&&this.events.emit(St("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Fs.delete,{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:h,method:p}=a;try{if(this.registeredMethods.includes(p))return;const y=kt("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,n,y),this.logger.error(y)}catch(y){await this.sendError(h,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(kt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var a;if(!ar(n)){const{message:p}=B("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(p)}if(!b0(n.uri)){const{message:p}=B("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(p)}const h=Hh(n.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:p}=B("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(p)}if(!(h!=null&&h.symKey)){const{message:p}=B("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(p)}},this.isValidPing=async n=>{if(!ar(n)){const{message:h}=B("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:h}=B("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!ps(n,!1)){const{message:a}=B("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=B("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(mi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=B("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=cr(i,this.name),this.pairings=new Aa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return or(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async t=>{const{topic:i,message:n}=t;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(i,n);try{$c(a)?(this.core.history.set(i,a),this.onRelayEventRequest({topic:i,payload:a})):Ys(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:i,payload:a}),this.core.history.delete(i,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async t=>{const{topic:i}=Kl(t.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit(Fs.expire,{topic:i}))})}}class oE extends i1{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.records=new Map,this.events=new Sr.EventEmitter,this.name=Db,this.version=qb,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:h}),this.records.has(a.id))return;const p={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:h,expiry:qr(X.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Kr.created,p)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=Lr(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(Kr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===n){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Kr.deleted,h)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=cr(i,this.name)}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:Ui(i.request.method,i.request.params,i.id),chainId:i.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const i=this.records.get(t);if(!i){const{message:n}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:i}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Kr.created,t=>{const i=Kr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Kr.updated,t=>{const i=Kr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Kr.deleted,t=>{const i=Kr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{X.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class cE extends u1{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.expirations=new Map,this.events=new Sr.EventEmitter,this.name=Lb,this.version=zb,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const h=this.formatTarget(n),p={target:h,expiry:a};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(Pr.created,{target:h,expiration:p})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Pr.deleted,{target:a,expiration:h})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=cr(i,this.name)}get context(){return or(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return E0(t);if(typeof t=="number")return I0(t);const{message:i}=B("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(i)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:i}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const i=this.expirations.get(t);if(!i){const{message:n}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(t,i){const{expiry:n}=i;X.toMiliseconds(n)-Date.now()<=0&&this.expire(t,i)}expire(t,i){this.expirations.delete(t),this.events.emit(Pr.expired,{target:t,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,i)=>this.checkExpiry(i,t))}registerEventListeners(){this.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,t=>{const i=Pr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Pr.expired,t=>{const i=Pr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Pr.deleted,t=>{const i=Pr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class uE extends h1{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.name=uc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||x0()||!Vl())return;const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ic;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let h;try{h=await this.fetchAttestation(n.attestationId,a)}catch(p){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(p),h=await this.fetchAttestation(n.attestationId,Ic)}return h},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const h=this.startAbortTimer(X.ONE_SECOND*2),p=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),p.status===200?await p.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(h=>{if(document.getElementById(uc))return h();window.addEventListener("message",a);const p=document.createElement("iframe");p.id=uc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,n=h}),new Promise((h,p)=>setTimeout(()=>{window.removeEventListener("message",a),p("verify iframe load timeout")},X.toMiliseconds(X.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let a=n||ds;return jb.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${ds}`),a=ds),a},this.logger=cr(i,this.name),this.verifyUrl=ds,this.abortController=new AbortController,this.isDevEnv=P0()&&M1.IS_VITEST}get context(){return or(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(t))}}class hE extends l1{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.context=Mb,this.registerDeviceToken=async n=>{const{clientId:a,token:h,notificationType:p,enableEncrypted:y=!1}=n,m=`${Ub}/${this.projectId}/clients`;await j1(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:p,token:h,always_raw:y})})},this.logger=cr(i,this.context)}}var lE=Object.defineProperty,Il=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,pE=Object.prototype.propertyIsEnumerable,xl=(o,t,i)=>t in o?lE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Pl=(o,t)=>{for(var i in t||(t={}))fE.call(t,i)&&xl(o,i,t[i]);if(Il)for(var i of Il(t))pE.call(t,i)&&xl(o,i,t[i]);return o};class qc extends r1{constructor(t){super(t),this.protocol=yf,this.version=hb,this.name=Dc,this.events=new Sr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||wf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Sa(Ra({level:(t==null?void 0:t.logger)||lb.logger}));this.logger=cr(i,this.name),this.heartbeat=new ys.HeartBeat,this.crypto=new kb(this,this.logger,t==null?void 0:t.keychain),this.history=new oE(this,this.logger),this.expirer=new cE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Pw(Pl(Pl({},fb),t==null?void 0:t.storageOptions)),this.relayer=new rE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new aE(this,this.logger),this.verify=new uE(this.projectId||"",this.logger),this.echoClient=new hE(this.projectId||"",this.logger)}static async init(t){const i=new qc(t);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(Ob,n),i}get context(){return or(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const dE=qc,_f="wc",bf=2,Ef="client",Lc=`${_f}@${bf}:${Ef}:`,lc={name:Ef,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Sl="WALLETCONNECT_DEEPLINK_CHOICE",gE="proposal",If="Proposal expired",vE="session",la=X.SEVEN_DAYS,yE="engine",Hs={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1115}}},fc={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},si={idle:"IDLE",active:"ACTIVE"},mE="request",wE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var _E=Object.defineProperty,bE=Object.defineProperties,EE=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,IE=Object.prototype.hasOwnProperty,xE=Object.prototype.propertyIsEnumerable,Ol=(o,t,i)=>t in o?_E(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,sr=(o,t)=>{for(var i in t||(t={}))IE.call(t,i)&&Ol(o,i,t[i]);if(Rl)for(var i of Rl(t))xE.call(t,i)&&Ol(o,i,t[i]);return o},ks=(o,t)=>bE(o,EE(t));class PE extends p1{constructor(t){super(t),this.name=yE,this.events=new Ac,this.initialized=!1,this.ignoredPayloadTypes=[kl],this.requestQueue={state:si.idle,queue:[]},this.sessionRequestQueue={state:si.idle,queue:[]},this.requestQueueDelay=X.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Hs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const n=ks(sr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:y,relays:m}=n;let g=a,_,S=!1;if(g&&(S=this.client.core.pairing.pairings.get(g).active),!g||!S){const{topic:ne,uri:re}=await this.client.core.pairing.create();g=ne,_=re}const $=await this.client.core.crypto.generateKeyPair(),q=sr({requiredNamespaces:h,optionalNamespaces:p,relays:m??[{protocol:mf}],proposer:{publicKey:$,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:A,resolve:Z,done:te}=fs(X.FIVE_MINUTES,If);if(this.events.once(St("session_connect"),async({error:ne,session:re})=>{if(ne)A(ne);else if(re){re.self.publicKey=$;const fe=ks(sr({},re),{requiredNamespaces:re.requiredNamespaces,optionalNamespaces:re.optionalNamespaces});await this.client.session.set(re.topic,fe),await this.setExpiry(re.topic,re.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:re.peer.metadata}),Z(fe)}}),!g){const{message:ne}=B("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(ne)}const ce=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:q}),oe=qr(X.FIVE_MINUTES);return await this.setProposal(ce,sr({id:ce,expiry:oe},q)),{uri:_,approval:te}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:a,namespaces:h,sessionProperties:p}=i,y=this.client.proposal.get(n);let{pairingTopic:m,proposer:g,requiredNamespaces:_,optionalNamespaces:S}=y;m=m||"",ga(_)||(_=R0(h,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),q=g.publicKey,A=await this.client.core.crypto.generateSharedKey($,q);m&&n&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:g.metadata}),await this.sendResult({id:n,topic:m,result:{relay:{protocol:a??"irn"},responderPublicKey:$}}),await this.client.proposal.delete(n,kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const Z=sr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:_,optionalNamespaces:S,pairingTopic:m,controller:{publicKey:$,metadata:this.client.metadata},expiry:qr(la)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(A),await this.sendRequest({topic:A,method:"wc_sessionSettle",params:Z,throwOnFailedPublish:!0});const te=ks(sr({},Z),{topic:A,pairingTopic:m,acknowledged:!1,self:Z.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:$});return await this.client.session.set(A,te),await this.setExpiry(A,qr(la)),{topic:A,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(A)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:n,reason:a}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,a),await this.client.proposal.delete(n,kt("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:a}=i,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:p,resolve:y,reject:m}=fs();return this.events.once(St("session_update",h),({error:g})=>{g?m(g):y()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:p}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:p,reject:y}=fs();return this.events.once(St("session_extend",a),({error:m})=>{m?y(m):p()}),await this.setExpiry(n,qr(la)),{acknowledged:h}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:a,topic:h,expiry:p}=i,y=J0(),{done:m,resolve:g,reject:_}=fs(p,"Request expired. Please try again.");return this.events.once(St("session_request",y),({error:S,result:$})=>{S?_(S):g($)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:y,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:p,throwOnFailedPublish:!0}).catch($=>_($)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:n,id:y}),S()}),new Promise(async S=>{const $=await O0(this.client.core.storage,Sl);A0({id:y,topic:h,wcDeepLink:$}),S()}),m()]).then(S=>S[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:a}=i,{id:h}=a;yi(a)?await this.sendResult({id:h,topic:n,result:a.result,throwOnFailedPublish:!0}):Lr(a)&&await this.sendError(h,n,a.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:p,reject:y}=fs();this.events.once(St("session_ping",a),({error:m})=>{m?y(m):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:a,chainId:h}=i;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:kt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>C0(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var p,y;return((p=h.peerMetadata)==null?void 0:p.url)&&((y=h.peerMetadata)==null?void 0:y.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:a}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,kt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i),this.client.core.storage.removeItem(Sl).catch(h=>this.client.logger.warn(h)),this.getPendingSessionRequests().forEach(h=>{h.topic===i&&this.deletePendingSessionRequest(h.id,kt("USER_DISCONNECTED"))})},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,kt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),a?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==i),a&&(this.sessionRequestQueue.state=si.idle)},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=Hs.wc_sessionRequest.req.ttl,{id:a,topic:h,params:p,verifyContext:y}=i;await this.client.pendingRequest.set(a,{id:a,topic:h,params:p,verifyContext:y}),n&&this.client.core.expirer.set(a,qr(n))},this.sendRequest=async i=>{const{topic:n,method:a,params:h,expiry:p,relayRpcId:y,clientRpcId:m,throwOnFailedPublish:g}=i,_=Ui(a,h,m);if(Vl()&&wE.includes(a)){const q=gs(JSON.stringify(_));this.client.core.verify.register({attestationId:q})}const S=await this.client.core.crypto.encode(n,_),$=Hs[a].req;return p&&($.ttl=p),y&&($.id=y),this.client.core.history.set(n,_),g?($.internal=ks(sr({},$.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,S,$)):this.client.core.relayer.publish(n,S,$).catch(q=>this.client.logger.error(q)),_.id},this.sendResult=async i=>{const{id:n,topic:a,result:h,throwOnFailedPublish:p}=i,y=xa(n,h),m=await this.client.core.crypto.encode(a,y),g=await this.client.core.history.get(a,n),_=Hs[g.request.method].res;p?(_.internal=ks(sr({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,m,_)):this.client.core.relayer.publish(a,m,_).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(y)},this.sendError=async(i,n,a)=>{const h=Tc(i,a),p=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,i),m=Hs[y.request.method].res;this.client.core.relayer.publish(n,p,m),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(a=>{mi(a.expiry)&&i.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{mi(a.expiry)&&n.push(a.id)}),await Promise.all([...i.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===si.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=si.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=si.idle},this.processRequest=i=>{const{topic:n,payload:a}=i,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:a}=i,h=(await this.client.core.history.get(n,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:a}=B("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(i,n)=>{const{params:a,id:h}=n;try{this.isValidConnect(sr({},n.params));const p=qr(X.FIVE_MINUTES),y=sr({id:h,pairingTopic:i,expiry:p},a);await this.setProposal(h,y);const m=gs(JSON.stringify(n)),g=await this.getVerifyContext(m,y.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:y,verifyContext:g})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(i,n)=>{const{id:a}=n;if(yi(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const y=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const m=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const g=await this.client.core.crypto.generateSharedKey(y,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const _=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:i})}else Lr(n)&&(await this.client.proposal.delete(a,kt("USER_DISCONNECTED")),this.events.emit(St("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:a,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:y,expiry:m,namespaces:g,requiredNamespaces:_,optionalNamespaces:S,sessionProperties:$,pairingTopic:q}=n.params,A=sr({topic:i,relay:p,expiry:m,namespaces:g,acknowledged:!0,pairingTopic:q,requiredNamespaces:_,optionalNamespaces:S,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},$&&{sessionProperties:$});await this.sendResult({id:n.id,topic:i,result:!0}),this.events.emit(St("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(i,n)=>{const{id:a}=n;yi(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(St("session_approve",a),{})):Lr(n)&&(await this.client.session.delete(i,kt("USER_DISCONNECTED")),this.events.emit(St("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:a,id:h}=n;try{const p=`${i}_session_update`,y=oa.get(p);if(y&&this.isRequestOutOfSync(y,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(sr({topic:i},a)),await this.client.session.update(i,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:i,result:!0}),this.client.events.emit("session_update",{id:h,topic:i,params:a}),oa.set(p,h)}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(i,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,n)=>{const{id:a}=n;yi(n)?this.events.emit(St("session_update",a),{}):Lr(n)&&this.events.emit(St("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:a}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,qr(la)),await this.sendResult({id:a,topic:i,result:!0}),this.client.events.emit("session_extend",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:a}=n;yi(n)?this.events.emit(St("session_extend",a),{}):Lr(n)&&this.events.emit(St("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:a}=n;try{this.isValidPing({topic:i}),await this.sendResult({id:a,topic:i,result:!0}),this.client.events.emit("session_ping",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:a}=n;setTimeout(()=>{yi(n)?this.events.emit(St("session_ping",a),{}):Lr(n)&&this.events.emit(St("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Kt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult({id:a,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:a,params:h}=n;try{this.isValidRequest(sr({topic:i},h));const p=gs(JSON.stringify(Ui("wc_sessionRequest",h,a))),y=this.client.session.get(i),m=await this.getVerifyContext(p,y.peer.metadata),g={id:a,topic:i,params:h,verifyContext:m};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(i,n)=>{const{id:a}=n;yi(n)?this.events.emit(St("session_request",a),{result:n.result}):Lr(n)&&this.events.emit(St("session_request",a),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:a,params:h}=n;try{const p=`${i}_session_event_${h.event.name}`,y=oa.get(p);if(y&&this.isRequestOutOfSync(y,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(sr({topic:i},h)),this.client.events.emit("session_event",{id:a,topic:i,params:h}),oa.set(p,a)}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=si.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===si.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=si.active,this.client.events.emit("session_request",i)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=i=>{if(i.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===i.topic);n&&this.onSessionProposeRequest(i.topic,Ui("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async i=>{if(!ar(i)){const{message:m}=B("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(m)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:p,relays:y}=i;if(wi(n)||await this.isValidPairingTopic(n),!T0(y)){const{message:m}=B("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(m)}!wi(a)&&ga(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!wi(h)&&ga(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),wi(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(i,n)=>{const a=$0(i,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async i=>{if(!ar(i))throw new Error(B("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:a,relayProtocol:h,sessionProperties:p}=i;await this.isValidProposalId(n);const y=this.client.proposal.get(n),m=tc(a,"approve()");if(m)throw new Error(m.message);const g=kh(y.requiredNamespaces,a,"approve()");if(g)throw new Error(g.message);if(!ps(h,!0)){const{message:_}=B("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(_)}wi(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async i=>{if(!ar(i)){const{message:h}=B("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:a}=i;if(await this.isValidProposalId(n),!N0(a)){const{message:h}=B("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!ar(i)){const{message:g}=B("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(g)}const{relay:n,controller:a,namespaces:h,expiry:p}=i;if(!D0(n)){const{message:g}=B("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const y=q0(a,"onSessionSettleRequest()");if(y)throw new Error(y.message);const m=tc(h,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(mi(p)){const{message:g}=B("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async i=>{if(!ar(i)){const{message:m}=B("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(m)}const{topic:n,namespaces:a}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),p=tc(a,"update()");if(p)throw new Error(p.message);const y=kh(h.requiredNamespaces,a,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async i=>{if(!ar(i)){const{message:a}=B("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!ar(i)){const{message:m}=B("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(m)}const{topic:n,request:a,chainId:h,expiry:p}=i;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!Kh(y,h)){const{message:m}=B("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(m)}if(!L0(a)){const{message:m}=B("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(m)}if(!z0(y,h,a.method)){const{message:m}=B("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(m)}if(p&&!j0(p,fc)){const{message:m}=B("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${fc.min} and ${fc.max}`);throw new Error(m)}},this.isValidRespond=async i=>{var n;if(!ar(i)){const{message:p}=B("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(p)}const{topic:a,response:h}=i;try{await this.isValidSessionTopic(a)}catch(p){throw(n=i==null?void 0:i.response)!=null&&n.id&&this.cleanupAfterResponse(i),p}if(!M0(h)){const{message:p}=B("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(p)}},this.isValidPing=async i=>{if(!ar(i)){const{message:a}=B("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!ar(i)){const{message:y}=B("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(y)}const{topic:n,event:a,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Kh(p,h)){const{message:y}=B("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(y)}if(!U0(a)){const{message:y}=B("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}if(!H0(p,h,a.name)){const{message:y}=B("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}},this.isValidDisconnect=async i=>{if(!ar(i)){const{message:a}=B("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const a={verified:{verifyUrl:n.verifyUrl||ds,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(a=>{if(!ps(a,!1)){const{message:h}=B("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,async t=>{const{topic:i,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(i,n);try{$c(a)?(this.client.core.history.set(i,a),this.onRelayEventRequest({topic:i,payload:a})):Ys(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:i,payload:a}),this.client.core.history.delete(i,a.id)):this.onRelayEventUnknownPayload({topic:i,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async t=>{const{topic:i,id:n}=Kl(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,B("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Fs.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!ps(t,!1)){const{message:i}=B("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:i}=B("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(i)}if(mi(this.client.core.pairing.pairings.get(t).expiry)){const{message:i}=B("EXPIRED",`pairing topic: ${t}`);throw new Error(i)}}async isValidSessionTopic(t){if(!ps(t,!1)){const{message:i}=B("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(i)}if(!this.client.session.keys.includes(t)){const{message:i}=B("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(i)}if(mi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:i}=B("EXPIRED",`session topic: ${t}`);throw new Error(i)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(ps(t,!1)){const{message:i}=B("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(i)}else{const{message:i}=B("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(i)}}async isValidProposalId(t){if(!k0(t)){const{message:i}=B("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(i)}if(!this.client.proposal.keys.includes(t)){const{message:i}=B("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(i)}if(mi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:i}=B("EXPIRED",`proposal id: ${t}`);throw new Error(i)}}}class SE extends Aa{constructor(t,i){super(t,i,gE,Lc),this.core=t,this.logger=i}}class RE extends Aa{constructor(t,i){super(t,i,vE,Lc),this.core=t,this.logger=i}}class OE extends Aa{constructor(t,i){super(t,i,mE,Lc,n=>n.id),this.core=t,this.logger=i}}let AE=class xf extends f1{constructor(t){super(t),this.protocol=_f,this.version=bf,this.name=lc.name,this.events=new Sr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||lc.name,this.metadata=(t==null?void 0:t.metadata)||S0();const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Sa(Ra({level:(t==null?void 0:t.logger)||lc.logger}));this.core=(t==null?void 0:t.core)||new dE(t),this.logger=cr(i,this.name),this.session=new RE(this.core,this.logger),this.proposal=new SE(this.core,this.logger),this.pendingRequest=new OE(this.core,this.logger),this.engine=new PE(this)}static async init(t){const i=new xf(t);return await i.initialize(),i}get context(){return or(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};class Ii extends Wl{constructor(t){super(t),this.events=new Sr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(Ui(t.method,t.params||[],t.id||Cc().toString()),i)}async requestStrict(t,i){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{Lr(h)?a(h.error):n(h.result)});try{await this.connection.send(t,i)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ys(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Al="error",CE="wss://relay.walletconnect.com",TE="wc",$E="universal_provider",Cl=`${TE}@2:${$E}:`,NE="https://rpc.walletconnect.com/v1/",ni={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(o,t){(function(){var i,n="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",y="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",g=500,_="__lodash_placeholder__",S=1,$=2,q=4,A=1,Z=2,te=1,ce=2,oe=4,ne=8,re=16,fe=32,pe=64,Q=128,xe=256,Tt=512,vt=30,Yt="...",Vt=800,ur=16,M=1,U=2,Ge=3,qe=1/0,G=9007199254740991,K=17976931348623157e292,H=NaN,V=4294967295,Rt=V-1,rt=V>>>1,xi=[["ary",Q],["bind",te],["bindKey",ce],["curry",ne],["curryRight",re],["flip",Tt],["partial",fe],["partialRight",pe],["rearg",xe]],we="[object Arguments]",Rr="[object Array]",T="[object AsyncFunction]",C="[object Boolean]",R="[object Date]",u="[object DOMException]",E="[object Error]",J="[object Function]",ae="[object GeneratorFunction]",ge="[object Map]",Pe="[object Number]",Re="[object Null]",_e="[object Object]",yt="[object Promise]",lt="[object Proxy]",Ze="[object RegExp]",Ae="[object Set]",ke="[object String]",Ke="[object Symbol]",Xe="[object Undefined]",Ne="[object WeakMap]",Ve="[object WeakSet]",Se="[object ArrayBuffer]",Le="[object DataView]",it="[object Float32Array]",Te="[object Float64Array]",mt="[object Int8Array]",Ot="[object Int16Array]",Lt="[object Int32Array]",zt="[object Uint8Array]",$t="[object Uint8ClampedArray]",Ft="[object Uint16Array]",Zt="[object Uint32Array]",zr=/\b__p \+= '';/g,Bt=/\b(__p \+=) '' \+/g,Fr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,Pi=/[&<>"']/g,st=RegExp(ai.source),We=RegExp(Pi.source),nt=/<%-([\s\S]+?)%>/g,at=/<%([\s\S]+?)%>/g,et=/<%=([\s\S]+?)%>/g,Je=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wt=/^\w*$/,_t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ot=/[\\^$.*+?()[\]{}|]/g,bt=RegExp(ot.source),ct=/^\s+/,ft=/\s/,ut=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,He=/\{\n\/\* \[wrapped with (.+)\] \*/,Et=/,? & /,It=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ca=/[()=,{}\[\]\/\s]/,Ta=/\\(\\)?/g,$a=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,Na=/^[-+]0x[0-9a-f]+$/i,Da=/^0b[01]+$/i,qa=/^\[object .+?Constructor\]$/,La=/^0o[0-7]+$/i,za=/^(?:0|[1-9]\d*)$/,Br=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vi=/($^)/,ja=/['\n\r\u2028\u2029\\]/g,Fi="\\ud800-\\udfff",Ma="\\u0300-\\u036f",Ua="\\ufe20-\\ufe2f",Bi="\\u20d0-\\u20ff",tn=Ma+Ua+Bi,rn="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",Ha="\\xac\\xb1\\xd7\\xf7",ka="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ka="\\u2000-\\u206f",Va=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",sn="A-Z\\xc0-\\xd6\\xd8-\\xde",nn="\\ufe0e\\ufe0f",Si=Ha+ka+Ka+Va,ms="['’]",Ri="["+Fi+"]",ws="["+Si+"]",Oi="["+tn+"]",an="\\d+",Fa="["+rn+"]",on="["+Or+"]",cn="[^"+Fi+Si+an+rn+Or+sn+"]",Gi="\\ud83c[\\udffb-\\udfff]",Ba="(?:"+Oi+"|"+Gi+")",un="[^"+Fi+"]",Wi="(?:\\ud83c[\\udde6-\\uddff]){2}",oi="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+sn+"]",hn="\\u200d",ln="(?:"+on+"|"+cn+")",jr="(?:"+hr+"|"+cn+")",fn="(?:"+ms+"(?:d|ll|m|re|s|t|ve))?",pn="(?:"+ms+"(?:D|LL|M|RE|S|T|VE))?",dn=Ba+"?",gn="["+nn+"]?",Ga="(?:"+hn+"(?:"+[un,Wi,oi].join("|")+")"+gn+dn+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yn=gn+dn+Ga,Ji="(?:"+[Fa,Wi,oi].join("|")+")"+yn,Wa="(?:"+[un+Oi+"?",Oi,Wi,oi,Ri].join("|")+")",_s=RegExp(ms,"g"),Ja=RegExp(Oi,"g"),Qi=RegExp(Gi+"(?="+Gi+")|"+Wa+yn,"g"),mn=RegExp([hr+"?"+on+"+"+fn+"(?="+[ws,hr,"$"].join("|")+")",jr+"+"+pn+"(?="+[ws,hr+ln,"$"].join("|")+")",hr+"?"+ln+"+"+fn,hr+"+"+pn,vn,Gr,an,Ji].join("|"),"g"),wn=RegExp("["+hn+Fi+tn+nn+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_n=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qa=-1,ze={};ze[it]=ze[Te]=ze[mt]=ze[Ot]=ze[Lt]=ze[zt]=ze[$t]=ze[Ft]=ze[Zt]=!0,ze[we]=ze[Rr]=ze[Se]=ze[C]=ze[Le]=ze[R]=ze[E]=ze[J]=ze[ge]=ze[Pe]=ze[_e]=ze[Ze]=ze[Ae]=ze[ke]=ze[Ne]=!1;var De={};De[we]=De[Rr]=De[Se]=De[Le]=De[C]=De[R]=De[it]=De[Te]=De[mt]=De[Ot]=De[Lt]=De[ge]=De[Pe]=De[_e]=De[Ze]=De[Ae]=De[ke]=De[Ke]=De[zt]=De[$t]=De[Ft]=De[Zt]=!0,De[E]=De[J]=De[Ne]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},F={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},je=parseFloat,he=parseInt,Fe=typeof Ks=="object"&&Ks&&Ks.Object===Object&&Ks,xt=typeof self=="object"&&self&&self.Object===Object&&self,Ee=Fe||xt||Function("return this")(),Me=t&&!t.nodeType&&t,pt=Me&&!0&&o&&!o.nodeType&&o,Xt=pt&&pt.exports===Me,Pt=Xt&&Fe.process,Be=function(){try{var x=pt&&pt.require&&pt.require("util").types;return x||Pt&&Pt.binding&&Pt.binding("util")}catch{}}(),Gt=Be&&Be.isArrayBuffer,Ar=Be&&Be.isDate,yr=Be&&Be.isMap,Mr=Be&&Be.isRegExp,bs=Be&&Be.isSet,Ci=Be&&Be.isTypedArray;function Nt(x,N,O){switch(O.length){case 0:return x.call(N);case 1:return x.call(N,O[0]);case 2:return x.call(N,O[0],O[1]);case 3:return x.call(N,O[0],O[1],O[2])}return x.apply(N,O)}function Rf(x,N,O,W){for(var ue=-1,Oe=x==null?0:x.length;++ue<Oe;){var At=x[ue];N(W,At,O(At),x)}return W}function mr(x,N){for(var O=-1,W=x==null?0:x.length;++O<W&&N(x[O],O,x)!==!1;);return x}function Of(x,N){for(var O=x==null?0:x.length;O--&&N(x[O],O,x)!==!1;);return x}function Mc(x,N){for(var O=-1,W=x==null?0:x.length;++O<W;)if(!N(x[O],O,x))return!1;return!0}function ci(x,N){for(var O=-1,W=x==null?0:x.length,ue=0,Oe=[];++O<W;){var At=x[O];N(At,O,x)&&(Oe[ue++]=At)}return Oe}function bn(x,N){var O=x==null?0:x.length;return!!O&&Yi(x,N,0)>-1}function Ya(x,N,O){for(var W=-1,ue=x==null?0:x.length;++W<ue;)if(O(N,x[W]))return!0;return!1}function Qe(x,N){for(var O=-1,W=x==null?0:x.length,ue=Array(W);++O<W;)ue[O]=N(x[O],O,x);return ue}function ui(x,N){for(var O=-1,W=N.length,ue=x.length;++O<W;)x[ue+O]=N[O];return x}function Za(x,N,O,W){var ue=-1,Oe=x==null?0:x.length;for(W&&Oe&&(O=x[++ue]);++ue<Oe;)O=N(O,x[ue],ue,x);return O}function Af(x,N,O,W){var ue=x==null?0:x.length;for(W&&ue&&(O=x[--ue]);ue--;)O=N(O,x[ue],ue,x);return O}function Xa(x,N){for(var O=-1,W=x==null?0:x.length;++O<W;)if(N(x[O],O,x))return!0;return!1}var Cf=eo("length");function Tf(x){return x.split("")}function $f(x){return x.match(It)||[]}function Uc(x,N,O){var W;return O(x,function(ue,Oe,At){if(N(ue,Oe,At))return W=Oe,!1}),W}function En(x,N,O,W){for(var ue=x.length,Oe=O+(W?1:-1);W?Oe--:++Oe<ue;)if(N(x[Oe],Oe,x))return Oe;return-1}function Yi(x,N,O){return N===N?Vf(x,N,O):En(x,Hc,O)}function Nf(x,N,O,W){for(var ue=O-1,Oe=x.length;++ue<Oe;)if(W(x[ue],N))return ue;return-1}function Hc(x){return x!==x}function kc(x,N){var O=x==null?0:x.length;return O?ro(x,N)/O:H}function eo(x){return function(N){return N==null?i:N[x]}}function to(x){return function(N){return x==null?i:x[N]}}function Kc(x,N,O,W,ue){return ue(x,function(Oe,At,Ue){O=W?(W=!1,Oe):N(O,Oe,At,Ue)}),O}function Df(x,N){var O=x.length;for(x.sort(N);O--;)x[O]=x[O].value;return x}function ro(x,N){for(var O,W=-1,ue=x.length;++W<ue;){var Oe=N(x[W]);Oe!==i&&(O=O===i?Oe:O+Oe)}return O}function io(x,N){for(var O=-1,W=Array(x);++O<x;)W[O]=N(O);return W}function qf(x,N){return Qe(N,function(O){return[O,x[O]]})}function Vc(x){return x&&x.slice(0,Wc(x)+1).replace(ct,"")}function lr(x){return function(N){return x(N)}}function so(x,N){return Qe(N,function(O){return x[O]})}function Es(x,N){return x.has(N)}function Fc(x,N){for(var O=-1,W=x.length;++O<W&&Yi(N,x[O],0)>-1;);return O}function Bc(x,N){for(var O=x.length;O--&&Yi(N,x[O],0)>-1;);return O}function Lf(x,N){for(var O=x.length,W=0;O--;)x[O]===N&&++W;return W}var zf=to(v),jf=to(I);function Mf(x){return"\\"+F[x]}function Uf(x,N){return x==null?i:x[N]}function Zi(x){return wn.test(x)}function Hf(x){return Ai.test(x)}function kf(x){for(var N,O=[];!(N=x.next()).done;)O.push(N.value);return O}function no(x){var N=-1,O=Array(x.size);return x.forEach(function(W,ue){O[++N]=[ue,W]}),O}function Gc(x,N){return function(O){return x(N(O))}}function hi(x,N){for(var O=-1,W=x.length,ue=0,Oe=[];++O<W;){var At=x[O];(At===N||At===_)&&(x[O]=_,Oe[ue++]=O)}return Oe}function In(x){var N=-1,O=Array(x.size);return x.forEach(function(W){O[++N]=W}),O}function Kf(x){var N=-1,O=Array(x.size);return x.forEach(function(W){O[++N]=[W,W]}),O}function Vf(x,N,O){for(var W=O-1,ue=x.length;++W<ue;)if(x[W]===N)return W;return-1}function Ff(x,N,O){for(var W=O+1;W--;)if(x[W]===N)return W;return W}function Xi(x){return Zi(x)?Gf(x):Cf(x)}function Cr(x){return Zi(x)?Wf(x):Tf(x)}function Wc(x){for(var N=x.length;N--&&ft.test(x.charAt(N)););return N}var Bf=to(z);function Gf(x){for(var N=Qi.lastIndex=0;Qi.test(x);)++N;return N}function Wf(x){return x.match(Qi)||[]}function Jf(x){return x.match(mn)||[]}var Qf=function x(N){N=N==null?Ee:es.defaults(Ee.Object(),N,es.pick(Ee,_n));var O=N.Array,W=N.Date,ue=N.Error,Oe=N.Function,At=N.Math,Ue=N.Object,ao=N.RegExp,Yf=N.String,wr=N.TypeError,xn=O.prototype,Zf=Oe.prototype,ts=Ue.prototype,Pn=N["__core-js_shared__"],Sn=Zf.toString,$e=ts.hasOwnProperty,Xf=0,Jc=function(){var e=/[^.]+$/.exec(Pn&&Pn.keys&&Pn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Rn=ts.toString,ep=Sn.call(Ue),tp=Ee._,rp=ao("^"+Sn.call($e).replace(ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),On=Xt?N.Buffer:i,li=N.Symbol,An=N.Uint8Array,Qc=On?On.allocUnsafe:i,Cn=Gc(Ue.getPrototypeOf,Ue),Yc=Ue.create,Zc=ts.propertyIsEnumerable,Tn=xn.splice,Xc=li?li.isConcatSpreadable:i,Is=li?li.iterator:i,Ti=li?li.toStringTag:i,$n=function(){try{var e=Li(Ue,"defineProperty");return e({},"",{}),e}catch{}}(),ip=N.clearTimeout!==Ee.clearTimeout&&N.clearTimeout,sp=W&&W.now!==Ee.Date.now&&W.now,np=N.setTimeout!==Ee.setTimeout&&N.setTimeout,Nn=At.ceil,Dn=At.floor,oo=Ue.getOwnPropertySymbols,ap=On?On.isBuffer:i,eu=N.isFinite,op=xn.join,cp=Gc(Ue.keys,Ue),Ct=At.max,Ut=At.min,up=W.now,hp=N.parseInt,tu=At.random,lp=xn.reverse,co=Li(N,"DataView"),xs=Li(N,"Map"),uo=Li(N,"Promise"),rs=Li(N,"Set"),Ps=Li(N,"WeakMap"),Ss=Li(Ue,"create"),qn=Ps&&new Ps,is={},fp=zi(co),pp=zi(xs),dp=zi(uo),gp=zi(rs),vp=zi(Ps),Ln=li?li.prototype:i,Rs=Ln?Ln.valueOf:i,ru=Ln?Ln.toString:i;function f(e){if(ht(e)&&!le(e)&&!(e instanceof be)){if(e instanceof _r)return e;if($e.call(e,"__wrapped__"))return ih(e)}return new _r(e)}var ss=function(){function e(){}return function(r){if(!tt(r))return{};if(Yc)return Yc(r);e.prototype=r;var s=new e;return e.prototype=i,s}}();function zn(){}function _r(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=i}f.templateSettings={escape:nt,evaluate:at,interpolate:et,variable:"",imports:{_:f}},f.prototype=zn.prototype,f.prototype.constructor=f,_r.prototype=ss(zn.prototype),_r.prototype.constructor=_r;function be(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function yp(){var e=new be(this.__wrapped__);return e.__actions__=er(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=er(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=er(this.__views__),e}function mp(){if(this.__filtered__){var e=new be(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function wp(){var e=this.__wrapped__.value(),r=this.__dir__,s=le(e),c=r<0,l=s?e.length:0,d=Td(0,l,this.__views__),w=d.start,b=d.end,P=b-w,D=c?b:w-1,L=this.__iteratees__,j=L.length,k=0,Y=Ut(P,this.__takeCount__);if(!s||!c&&l==P&&Y==P)return Su(e,this.__actions__);var ie=[];e:for(;P--&&k<Y;){D+=r;for(var ve=-1,se=e[D];++ve<j;){var me=L[ve],Ie=me.iteratee,dr=me.type,Qt=Ie(se);if(dr==U)se=Qt;else if(!Qt){if(dr==M)continue e;break e}}ie[k++]=se}return ie}be.prototype=ss(zn.prototype),be.prototype.constructor=be;function $i(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function _p(){this.__data__=Ss?Ss(null):{},this.size=0}function bp(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function Ep(e){var r=this.__data__;if(Ss){var s=r[e];return s===m?i:s}return $e.call(r,e)?r[e]:i}function Ip(e){var r=this.__data__;return Ss?r[e]!==i:$e.call(r,e)}function xp(e,r){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ss&&r===i?m:r,this}$i.prototype.clear=_p,$i.prototype.delete=bp,$i.prototype.get=Ep,$i.prototype.has=Ip,$i.prototype.set=xp;function Wr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Pp(){this.__data__=[],this.size=0}function Sp(e){var r=this.__data__,s=jn(r,e);if(s<0)return!1;var c=r.length-1;return s==c?r.pop():Tn.call(r,s,1),--this.size,!0}function Rp(e){var r=this.__data__,s=jn(r,e);return s<0?i:r[s][1]}function Op(e){return jn(this.__data__,e)>-1}function Ap(e,r){var s=this.__data__,c=jn(s,e);return c<0?(++this.size,s.push([e,r])):s[c][1]=r,this}Wr.prototype.clear=Pp,Wr.prototype.delete=Sp,Wr.prototype.get=Rp,Wr.prototype.has=Op,Wr.prototype.set=Ap;function Jr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Cp(){this.size=0,this.__data__={hash:new $i,map:new(xs||Wr),string:new $i}}function Tp(e){var r=Qn(this,e).delete(e);return this.size-=r?1:0,r}function $p(e){return Qn(this,e).get(e)}function Np(e){return Qn(this,e).has(e)}function Dp(e,r){var s=Qn(this,e),c=s.size;return s.set(e,r),this.size+=s.size==c?0:1,this}Jr.prototype.clear=Cp,Jr.prototype.delete=Tp,Jr.prototype.get=$p,Jr.prototype.has=Np,Jr.prototype.set=Dp;function Ni(e){var r=-1,s=e==null?0:e.length;for(this.__data__=new Jr;++r<s;)this.add(e[r])}function qp(e){return this.__data__.set(e,m),this}function Lp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=qp,Ni.prototype.has=Lp;function Tr(e){var r=this.__data__=new Wr(e);this.size=r.size}function zp(){this.__data__=new Wr,this.size=0}function jp(e){var r=this.__data__,s=r.delete(e);return this.size=r.size,s}function Mp(e){return this.__data__.get(e)}function Up(e){return this.__data__.has(e)}function Hp(e,r){var s=this.__data__;if(s instanceof Wr){var c=s.__data__;if(!xs||c.length<a-1)return c.push([e,r]),this.size=++s.size,this;s=this.__data__=new Jr(c)}return s.set(e,r),this.size=s.size,this}Tr.prototype.clear=zp,Tr.prototype.delete=jp,Tr.prototype.get=Mp,Tr.prototype.has=Up,Tr.prototype.set=Hp;function iu(e,r){var s=le(e),c=!s&&ji(e),l=!s&&!c&&vi(e),d=!s&&!c&&!l&&cs(e),w=s||c||l||d,b=w?io(e.length,Yf):[],P=b.length;for(var D in e)(r||$e.call(e,D))&&!(w&&(D=="length"||l&&(D=="offset"||D=="parent")||d&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Xr(D,P)))&&b.push(D);return b}function su(e){var r=e.length;return r?e[bo(0,r-1)]:i}function kp(e,r){return Yn(er(e),Di(r,0,e.length))}function Kp(e){return Yn(er(e))}function ho(e,r,s){(s!==i&&!$r(e[r],s)||s===i&&!(r in e))&&Qr(e,r,s)}function Os(e,r,s){var c=e[r];(!($e.call(e,r)&&$r(c,s))||s===i&&!(r in e))&&Qr(e,r,s)}function jn(e,r){for(var s=e.length;s--;)if($r(e[s][0],r))return s;return-1}function Vp(e,r,s,c){return fi(e,function(l,d,w){r(c,l,s(l),w)}),c}function nu(e,r){return e&&Hr(r,Dt(r),e)}function Fp(e,r){return e&&Hr(r,rr(r),e)}function Qr(e,r,s){r=="__proto__"&&$n?$n(e,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[r]=s}function lo(e,r){for(var s=-1,c=r.length,l=O(c),d=e==null;++s<c;)l[s]=d?i:Bo(e,r[s]);return l}function Di(e,r,s){return e===e&&(s!==i&&(e=e<=s?e:s),r!==i&&(e=e>=r?e:r)),e}function br(e,r,s,c,l,d){var w,b=r&S,P=r&$,D=r&q;if(s&&(w=l?s(e,c,l,d):s(e)),w!==i)return w;if(!tt(e))return e;var L=le(e);if(L){if(w=Nd(e),!b)return er(e,w)}else{var j=Ht(e),k=j==J||j==ae;if(vi(e))return Au(e,b);if(j==_e||j==we||k&&!l){if(w=P||k?{}:Wu(e),!b)return P?Ed(e,Fp(w,e)):bd(e,nu(w,e))}else{if(!De[j])return l?e:{};w=Dd(e,j,b)}}d||(d=new Tr);var Y=d.get(e);if(Y)return Y;d.set(e,w),Ih(e)?e.forEach(function(se){w.add(br(se,r,s,se,e,d))}):bh(e)&&e.forEach(function(se,me){w.set(me,br(se,r,s,me,e,d))});var ie=D?P?$o:To:P?rr:Dt,ve=L?i:ie(e);return mr(ve||e,function(se,me){ve&&(me=se,se=e[me]),Os(w,me,br(se,r,s,me,e,d))}),w}function Bp(e){var r=Dt(e);return function(s){return au(s,e,r)}}function au(e,r,s){var c=s.length;if(e==null)return!c;for(e=Ue(e);c--;){var l=s[c],d=r[l],w=e[l];if(w===i&&!(l in e)||!d(w))return!1}return!0}function ou(e,r,s){if(typeof e!="function")throw new wr(p);return qs(function(){e.apply(i,s)},r)}function As(e,r,s,c){var l=-1,d=bn,w=!0,b=e.length,P=[],D=r.length;if(!b)return P;s&&(r=Qe(r,lr(s))),c?(d=Ya,w=!1):r.length>=a&&(d=Es,w=!1,r=new Ni(r));e:for(;++l<b;){var L=e[l],j=s==null?L:s(L);if(L=c||L!==0?L:0,w&&j===j){for(var k=D;k--;)if(r[k]===j)continue e;P.push(L)}else d(r,j,c)||P.push(L)}return P}var fi=Du(Ur),cu=Du(po,!0);function Gp(e,r){var s=!0;return fi(e,function(c,l,d){return s=!!r(c,l,d),s}),s}function Mn(e,r,s){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=r(d);if(w!=null&&(b===i?w===w&&!pr(w):s(w,b)))var b=w,P=d}return P}function Wp(e,r,s,c){var l=e.length;for(s=de(s),s<0&&(s=-s>l?0:l+s),c=c===i||c>l?l:de(c),c<0&&(c+=l),c=s>c?0:Ph(c);s<c;)e[s++]=r;return e}function uu(e,r){var s=[];return fi(e,function(c,l,d){r(c,l,d)&&s.push(c)}),s}function jt(e,r,s,c,l){var d=-1,w=e.length;for(s||(s=Ld),l||(l=[]);++d<w;){var b=e[d];r>0&&s(b)?r>1?jt(b,r-1,s,c,l):ui(l,b):c||(l[l.length]=b)}return l}var fo=qu(),hu=qu(!0);function Ur(e,r){return e&&fo(e,r,Dt)}function po(e,r){return e&&hu(e,r,Dt)}function Un(e,r){return ci(r,function(s){return ei(e[s])})}function qi(e,r){r=di(r,e);for(var s=0,c=r.length;e!=null&&s<c;)e=e[kr(r[s++])];return s&&s==c?e:i}function lu(e,r,s){var c=r(e);return le(e)?c:ui(c,s(e))}function Wt(e){return e==null?e===i?Xe:Re:Ti&&Ti in Ue(e)?Cd(e):Kd(e)}function go(e,r){return e>r}function Jp(e,r){return e!=null&&$e.call(e,r)}function Qp(e,r){return e!=null&&r in Ue(e)}function Yp(e,r,s){return e>=Ut(r,s)&&e<Ct(r,s)}function vo(e,r,s){for(var c=s?Ya:bn,l=e[0].length,d=e.length,w=d,b=O(d),P=1/0,D=[];w--;){var L=e[w];w&&r&&(L=Qe(L,lr(r))),P=Ut(L.length,P),b[w]=!s&&(r||l>=120&&L.length>=120)?new Ni(w&&L):i}L=e[0];var j=-1,k=b[0];e:for(;++j<l&&D.length<P;){var Y=L[j],ie=r?r(Y):Y;if(Y=s||Y!==0?Y:0,!(k?Es(k,ie):c(D,ie,s))){for(w=d;--w;){var ve=b[w];if(!(ve?Es(ve,ie):c(e[w],ie,s)))continue e}k&&k.push(ie),D.push(Y)}}return D}function Zp(e,r,s,c){return Ur(e,function(l,d,w){r(c,s(l),d,w)}),c}function Cs(e,r,s){r=di(r,e),e=Zu(e,r);var c=e==null?e:e[kr(Ir(r))];return c==null?i:Nt(c,e,s)}function fu(e){return ht(e)&&Wt(e)==we}function Xp(e){return ht(e)&&Wt(e)==Se}function ed(e){return ht(e)&&Wt(e)==R}function Ts(e,r,s,c,l){return e===r?!0:e==null||r==null||!ht(e)&&!ht(r)?e!==e&&r!==r:td(e,r,s,c,Ts,l)}function td(e,r,s,c,l,d){var w=le(e),b=le(r),P=w?Rr:Ht(e),D=b?Rr:Ht(r);P=P==we?_e:P,D=D==we?_e:D;var L=P==_e,j=D==_e,k=P==D;if(k&&vi(e)){if(!vi(r))return!1;w=!0,L=!1}if(k&&!L)return d||(d=new Tr),w||cs(e)?Fu(e,r,s,c,l,d):Od(e,r,P,s,c,l,d);if(!(s&A)){var Y=L&&$e.call(e,"__wrapped__"),ie=j&&$e.call(r,"__wrapped__");if(Y||ie){var ve=Y?e.value():e,se=ie?r.value():r;return d||(d=new Tr),l(ve,se,s,c,d)}}return k?(d||(d=new Tr),Ad(e,r,s,c,l,d)):!1}function rd(e){return ht(e)&&Ht(e)==ge}function yo(e,r,s,c){var l=s.length,d=l,w=!c;if(e==null)return!d;for(e=Ue(e);l--;){var b=s[l];if(w&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++l<d;){b=s[l];var P=b[0],D=e[P],L=b[1];if(w&&b[2]){if(D===i&&!(P in e))return!1}else{var j=new Tr;if(c)var k=c(D,L,P,e,r,j);if(!(k===i?Ts(L,D,A|Z,c,j):k))return!1}}return!0}function pu(e){if(!tt(e)||jd(e))return!1;var r=ei(e)?rp:qa;return r.test(zi(e))}function id(e){return ht(e)&&Wt(e)==Ze}function sd(e){return ht(e)&&Ht(e)==Ae}function nd(e){return ht(e)&&ia(e.length)&&!!ze[Wt(e)]}function du(e){return typeof e=="function"?e:e==null?ir:typeof e=="object"?le(e)?yu(e[0],e[1]):vu(e):Lh(e)}function mo(e){if(!Ds(e))return cp(e);var r=[];for(var s in Ue(e))$e.call(e,s)&&s!="constructor"&&r.push(s);return r}function ad(e){if(!tt(e))return kd(e);var r=Ds(e),s=[];for(var c in e)c=="constructor"&&(r||!$e.call(e,c))||s.push(c);return s}function wo(e,r){return e<r}function gu(e,r){var s=-1,c=tr(e)?O(e.length):[];return fi(e,function(l,d,w){c[++s]=r(l,d,w)}),c}function vu(e){var r=Do(e);return r.length==1&&r[0][2]?Qu(r[0][0],r[0][1]):function(s){return s===e||yo(s,e,r)}}function yu(e,r){return Lo(e)&&Ju(r)?Qu(kr(e),r):function(s){var c=Bo(s,e);return c===i&&c===r?Go(s,e):Ts(r,c,A|Z)}}function Hn(e,r,s,c,l){e!==r&&fo(r,function(d,w){if(l||(l=new Tr),tt(d))od(e,r,w,s,Hn,c,l);else{var b=c?c(jo(e,w),d,w+"",e,r,l):i;b===i&&(b=d),ho(e,w,b)}},rr)}function od(e,r,s,c,l,d,w){var b=jo(e,s),P=jo(r,s),D=w.get(P);if(D){ho(e,s,D);return}var L=d?d(b,P,s+"",e,r,w):i,j=L===i;if(j){var k=le(P),Y=!k&&vi(P),ie=!k&&!Y&&cs(P);L=P,k||Y||ie?le(b)?L=b:dt(b)?L=er(b):Y?(j=!1,L=Au(P,!0)):ie?(j=!1,L=Cu(P,!0)):L=[]:Ls(P)||ji(P)?(L=b,ji(b)?L=Sh(b):(!tt(b)||ei(b))&&(L=Wu(P))):j=!1}j&&(w.set(P,L),l(L,P,c,d,w),w.delete(P)),ho(e,s,L)}function mu(e,r){var s=e.length;if(s)return r+=r<0?s:0,Xr(r,s)?e[r]:i}function wu(e,r,s){r.length?r=Qe(r,function(d){return le(d)?function(w){return qi(w,d.length===1?d[0]:d)}:d}):r=[ir];var c=-1;r=Qe(r,lr(ee()));var l=gu(e,function(d,w,b){var P=Qe(r,function(D){return D(d)});return{criteria:P,index:++c,value:d}});return Df(l,function(d,w){return _d(d,w,s)})}function cd(e,r){return _u(e,r,function(s,c){return Go(e,c)})}function _u(e,r,s){for(var c=-1,l=r.length,d={};++c<l;){var w=r[c],b=qi(e,w);s(b,w)&&$s(d,di(w,e),b)}return d}function ud(e){return function(r){return qi(r,e)}}function _o(e,r,s,c){var l=c?Nf:Yi,d=-1,w=r.length,b=e;for(e===r&&(r=er(r)),s&&(b=Qe(e,lr(s)));++d<w;)for(var P=0,D=r[d],L=s?s(D):D;(P=l(b,L,P,c))>-1;)b!==e&&Tn.call(b,P,1),Tn.call(e,P,1);return e}function bu(e,r){for(var s=e?r.length:0,c=s-1;s--;){var l=r[s];if(s==c||l!==d){var d=l;Xr(l)?Tn.call(e,l,1):xo(e,l)}}return e}function bo(e,r){return e+Dn(tu()*(r-e+1))}function hd(e,r,s,c){for(var l=-1,d=Ct(Nn((r-e)/(s||1)),0),w=O(d);d--;)w[c?d:++l]=e,e+=s;return w}function Eo(e,r){var s="";if(!e||r<1||r>G)return s;do r%2&&(s+=e),r=Dn(r/2),r&&(e+=e);while(r);return s}function ye(e,r){return Mo(Yu(e,r,ir),e+"")}function ld(e){return su(us(e))}function fd(e,r){var s=us(e);return Yn(s,Di(r,0,s.length))}function $s(e,r,s,c){if(!tt(e))return e;r=di(r,e);for(var l=-1,d=r.length,w=d-1,b=e;b!=null&&++l<d;){var P=kr(r[l]),D=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(l!=w){var L=b[P];D=c?c(L,P,b):i,D===i&&(D=tt(L)?L:Xr(r[l+1])?[]:{})}Os(b,P,D),b=b[P]}return e}var Eu=qn?function(e,r){return qn.set(e,r),e}:ir,pd=$n?function(e,r){return $n(e,"toString",{configurable:!0,enumerable:!1,value:Jo(r),writable:!0})}:ir;function dd(e){return Yn(us(e))}function Er(e,r,s){var c=-1,l=e.length;r<0&&(r=-r>l?0:l+r),s=s>l?l:s,s<0&&(s+=l),l=r>s?0:s-r>>>0,r>>>=0;for(var d=O(l);++c<l;)d[c]=e[c+r];return d}function gd(e,r){var s;return fi(e,function(c,l,d){return s=r(c,l,d),!s}),!!s}function kn(e,r,s){var c=0,l=e==null?c:e.length;if(typeof r=="number"&&r===r&&l<=rt){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!pr(w)&&(s?w<=r:w<r)?c=d+1:l=d}return l}return Io(e,r,ir,s)}function Io(e,r,s,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;r=s(r);for(var w=r!==r,b=r===null,P=pr(r),D=r===i;l<d;){var L=Dn((l+d)/2),j=s(e[L]),k=j!==i,Y=j===null,ie=j===j,ve=pr(j);if(w)var se=c||ie;else D?se=ie&&(c||k):b?se=ie&&k&&(c||!Y):P?se=ie&&k&&!Y&&(c||!ve):Y||ve?se=!1:se=c?j<=r:j<r;se?l=L+1:d=L}return Ut(d,Rt)}function Iu(e,r){for(var s=-1,c=e.length,l=0,d=[];++s<c;){var w=e[s],b=r?r(w):w;if(!s||!$r(b,P)){var P=b;d[l++]=w===0?0:w}}return d}function xu(e){return typeof e=="number"?e:pr(e)?H:+e}function fr(e){if(typeof e=="string")return e;if(le(e))return Qe(e,fr)+"";if(pr(e))return ru?ru.call(e):"";var r=e+"";return r=="0"&&1/e==-qe?"-0":r}function pi(e,r,s){var c=-1,l=bn,d=e.length,w=!0,b=[],P=b;if(s)w=!1,l=Ya;else if(d>=a){var D=r?null:Sd(e);if(D)return In(D);w=!1,l=Es,P=new Ni}else P=r?[]:b;e:for(;++c<d;){var L=e[c],j=r?r(L):L;if(L=s||L!==0?L:0,w&&j===j){for(var k=P.length;k--;)if(P[k]===j)continue e;r&&P.push(j),b.push(L)}else l(P,j,s)||(P!==b&&P.push(j),b.push(L))}return b}function xo(e,r){return r=di(r,e),e=Zu(e,r),e==null||delete e[kr(Ir(r))]}function Pu(e,r,s,c){return $s(e,r,s(qi(e,r)),c)}function Kn(e,r,s,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&r(e[d],d,e););return s?Er(e,c?0:d,c?d+1:l):Er(e,c?d+1:0,c?l:d)}function Su(e,r){var s=e;return s instanceof be&&(s=s.value()),Za(r,function(c,l){return l.func.apply(l.thisArg,ui([c],l.args))},s)}function Po(e,r,s){var c=e.length;if(c<2)return c?pi(e[0]):[];for(var l=-1,d=O(c);++l<c;)for(var w=e[l],b=-1;++b<c;)b!=l&&(d[l]=As(d[l]||w,e[b],r,s));return pi(jt(d,1),r,s)}function Ru(e,r,s){for(var c=-1,l=e.length,d=r.length,w={};++c<l;){var b=c<d?r[c]:i;s(w,e[c],b)}return w}function So(e){return dt(e)?e:[]}function Ro(e){return typeof e=="function"?e:ir}function di(e,r){return le(e)?e:Lo(e,r)?[e]:rh(Ce(e))}var vd=ye;function gi(e,r,s){var c=e.length;return s=s===i?c:s,!r&&s>=c?e:Er(e,r,s)}var Ou=ip||function(e){return Ee.clearTimeout(e)};function Au(e,r){if(r)return e.slice();var s=e.length,c=Qc?Qc(s):new e.constructor(s);return e.copy(c),c}function Oo(e){var r=new e.constructor(e.byteLength);return new An(r).set(new An(e)),r}function yd(e,r){var s=r?Oo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function md(e){var r=new e.constructor(e.source,vr.exec(e));return r.lastIndex=e.lastIndex,r}function wd(e){return Rs?Ue(Rs.call(e)):{}}function Cu(e,r){var s=r?Oo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Tu(e,r){if(e!==r){var s=e!==i,c=e===null,l=e===e,d=pr(e),w=r!==i,b=r===null,P=r===r,D=pr(r);if(!b&&!D&&!d&&e>r||d&&w&&P&&!b&&!D||c&&w&&P||!s&&P||!l)return 1;if(!c&&!d&&!D&&e<r||D&&s&&l&&!c&&!d||b&&s&&l||!w&&l||!P)return-1}return 0}function _d(e,r,s){for(var c=-1,l=e.criteria,d=r.criteria,w=l.length,b=s.length;++c<w;){var P=Tu(l[c],d[c]);if(P){if(c>=b)return P;var D=s[c];return P*(D=="desc"?-1:1)}}return e.index-r.index}function $u(e,r,s,c){for(var l=-1,d=e.length,w=s.length,b=-1,P=r.length,D=Ct(d-w,0),L=O(P+D),j=!c;++b<P;)L[b]=r[b];for(;++l<w;)(j||l<d)&&(L[s[l]]=e[l]);for(;D--;)L[b++]=e[l++];return L}function Nu(e,r,s,c){for(var l=-1,d=e.length,w=-1,b=s.length,P=-1,D=r.length,L=Ct(d-b,0),j=O(L+D),k=!c;++l<L;)j[l]=e[l];for(var Y=l;++P<D;)j[Y+P]=r[P];for(;++w<b;)(k||l<d)&&(j[Y+s[w]]=e[l++]);return j}function er(e,r){var s=-1,c=e.length;for(r||(r=O(c));++s<c;)r[s]=e[s];return r}function Hr(e,r,s,c){var l=!s;s||(s={});for(var d=-1,w=r.length;++d<w;){var b=r[d],P=c?c(s[b],e[b],b,s,e):i;P===i&&(P=e[b]),l?Qr(s,b,P):Os(s,b,P)}return s}function bd(e,r){return Hr(e,qo(e),r)}function Ed(e,r){return Hr(e,Bu(e),r)}function Vn(e,r){return function(s,c){var l=le(s)?Rf:Vp,d=r?r():{};return l(s,e,ee(c,2),d)}}function ns(e){return ye(function(r,s){var c=-1,l=s.length,d=l>1?s[l-1]:i,w=l>2?s[2]:i;for(d=e.length>3&&typeof d=="function"?(l--,d):i,w&&Jt(s[0],s[1],w)&&(d=l<3?i:d,l=1),r=Ue(r);++c<l;){var b=s[c];b&&e(r,b,c,d)}return r})}function Du(e,r){return function(s,c){if(s==null)return s;if(!tr(s))return e(s,c);for(var l=s.length,d=r?l:-1,w=Ue(s);(r?d--:++d<l)&&c(w[d],d,w)!==!1;);return s}}function qu(e){return function(r,s,c){for(var l=-1,d=Ue(r),w=c(r),b=w.length;b--;){var P=w[e?b:++l];if(s(d[P],P,d)===!1)break}return r}}function Id(e,r,s){var c=r&te,l=Ns(e);function d(){var w=this&&this!==Ee&&this instanceof d?l:e;return w.apply(c?s:this,arguments)}return d}function Lu(e){return function(r){r=Ce(r);var s=Zi(r)?Cr(r):i,c=s?s[0]:r.charAt(0),l=s?gi(s,1).join(""):r.slice(1);return c[e]()+l}}function as(e){return function(r){return Za(Dh(Nh(r).replace(_s,"")),e,"")}}function Ns(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var s=ss(e.prototype),c=e.apply(s,r);return tt(c)?c:s}}function xd(e,r,s){var c=Ns(e);function l(){for(var d=arguments.length,w=O(d),b=d,P=os(l);b--;)w[b]=arguments[b];var D=d<3&&w[0]!==P&&w[d-1]!==P?[]:hi(w,P);if(d-=D.length,d<s)return Hu(e,r,Fn,l.placeholder,i,w,D,i,i,s-d);var L=this&&this!==Ee&&this instanceof l?c:e;return Nt(L,this,w)}return l}function zu(e){return function(r,s,c){var l=Ue(r);if(!tr(r)){var d=ee(s,3);r=Dt(r),s=function(b){return d(l[b],b,l)}}var w=e(r,s,c);return w>-1?l[d?r[w]:w]:i}}function ju(e){return Zr(function(r){var s=r.length,c=s,l=_r.prototype.thru;for(e&&r.reverse();c--;){var d=r[c];if(typeof d!="function")throw new wr(p);if(l&&!w&&Jn(d)=="wrapper")var w=new _r([],!0)}for(c=w?c:s;++c<s;){d=r[c];var b=Jn(d),P=b=="wrapper"?No(d):i;P&&zo(P[0])&&P[1]==(Q|ne|fe|xe)&&!P[4].length&&P[9]==1?w=w[Jn(P[0])].apply(w,P[3]):w=d.length==1&&zo(d)?w[b]():w.thru(d)}return function(){var D=arguments,L=D[0];if(w&&D.length==1&&le(L))return w.plant(L).value();for(var j=0,k=s?r[j].apply(this,D):L;++j<s;)k=r[j].call(this,k);return k}})}function Fn(e,r,s,c,l,d,w,b,P,D){var L=r&Q,j=r&te,k=r&ce,Y=r&(ne|re),ie=r&Tt,ve=k?i:Ns(e);function se(){for(var me=arguments.length,Ie=O(me),dr=me;dr--;)Ie[dr]=arguments[dr];if(Y)var Qt=os(se),gr=Lf(Ie,Qt);if(c&&(Ie=$u(Ie,c,l,Y)),d&&(Ie=Nu(Ie,d,w,Y)),me-=gr,Y&&me<D){var gt=hi(Ie,Qt);return Hu(e,r,Fn,se.placeholder,s,Ie,gt,b,P,D-me)}var Nr=j?s:this,ri=k?Nr[e]:e;return me=Ie.length,b?Ie=Vd(Ie,b):ie&&me>1&&Ie.reverse(),L&&P<me&&(Ie.length=P),this&&this!==Ee&&this instanceof se&&(ri=ve||Ns(ri)),ri.apply(Nr,Ie)}return se}function Mu(e,r){return function(s,c){return Zp(s,e,r(c),{})}}function Bn(e,r){return function(s,c){var l;if(s===i&&c===i)return r;if(s!==i&&(l=s),c!==i){if(l===i)return c;typeof s=="string"||typeof c=="string"?(s=fr(s),c=fr(c)):(s=xu(s),c=xu(c)),l=e(s,c)}return l}}function Ao(e){return Zr(function(r){return r=Qe(r,lr(ee())),ye(function(s){var c=this;return e(r,function(l){return Nt(l,c,s)})})})}function Gn(e,r){r=r===i?" ":fr(r);var s=r.length;if(s<2)return s?Eo(r,e):r;var c=Eo(r,Nn(e/Xi(r)));return Zi(r)?gi(Cr(c),0,e).join(""):c.slice(0,e)}function Pd(e,r,s,c){var l=r&te,d=Ns(e);function w(){for(var b=-1,P=arguments.length,D=-1,L=c.length,j=O(L+P),k=this&&this!==Ee&&this instanceof w?d:e;++D<L;)j[D]=c[D];for(;P--;)j[D++]=arguments[++b];return Nt(k,l?s:this,j)}return w}function Uu(e){return function(r,s,c){return c&&typeof c!="number"&&Jt(r,s,c)&&(s=c=i),r=ti(r),s===i?(s=r,r=0):s=ti(s),c=c===i?r<s?1:-1:ti(c),hd(r,s,c,e)}}function Wn(e){return function(r,s){return typeof r=="string"&&typeof s=="string"||(r=xr(r),s=xr(s)),e(r,s)}}function Hu(e,r,s,c,l,d,w,b,P,D){var L=r&ne,j=L?w:i,k=L?i:w,Y=L?d:i,ie=L?i:d;r|=L?fe:pe,r&=~(L?pe:fe),r&oe||(r&=~(te|ce));var ve=[e,r,l,Y,j,ie,k,b,P,D],se=s.apply(i,ve);return zo(e)&&Xu(se,ve),se.placeholder=c,eh(se,e,r)}function Co(e){var r=At[e];return function(s,c){if(s=xr(s),c=c==null?0:Ut(de(c),292),c&&eu(s)){var l=(Ce(s)+"e").split("e"),d=r(l[0]+"e"+(+l[1]+c));return l=(Ce(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return r(s)}}var Sd=rs&&1/In(new rs([,-0]))[1]==qe?function(e){return new rs(e)}:Zo;function ku(e){return function(r){var s=Ht(r);return s==ge?no(r):s==Ae?Kf(r):qf(r,e(r))}}function Yr(e,r,s,c,l,d,w,b){var P=r&ce;if(!P&&typeof e!="function")throw new wr(p);var D=c?c.length:0;if(D||(r&=~(fe|pe),c=l=i),w=w===i?w:Ct(de(w),0),b=b===i?b:de(b),D-=l?l.length:0,r&pe){var L=c,j=l;c=l=i}var k=P?i:No(e),Y=[e,r,s,c,l,L,j,d,w,b];if(k&&Hd(Y,k),e=Y[0],r=Y[1],s=Y[2],c=Y[3],l=Y[4],b=Y[9]=Y[9]===i?P?0:e.length:Ct(Y[9]-D,0),!b&&r&(ne|re)&&(r&=~(ne|re)),!r||r==te)var ie=Id(e,r,s);else r==ne||r==re?ie=xd(e,r,b):(r==fe||r==(te|fe))&&!l.length?ie=Pd(e,r,s,c):ie=Fn.apply(i,Y);var ve=k?Eu:Xu;return eh(ve(ie,Y),e,r)}function Ku(e,r,s,c){return e===i||$r(e,ts[s])&&!$e.call(c,s)?r:e}function Vu(e,r,s,c,l,d){return tt(e)&&tt(r)&&(d.set(r,e),Hn(e,r,i,Vu,d),d.delete(r)),e}function Rd(e){return Ls(e)?i:e}function Fu(e,r,s,c,l,d){var w=s&A,b=e.length,P=r.length;if(b!=P&&!(w&&P>b))return!1;var D=d.get(e),L=d.get(r);if(D&&L)return D==r&&L==e;var j=-1,k=!0,Y=s&Z?new Ni:i;for(d.set(e,r),d.set(r,e);++j<b;){var ie=e[j],ve=r[j];if(c)var se=w?c(ve,ie,j,r,e,d):c(ie,ve,j,e,r,d);if(se!==i){if(se)continue;k=!1;break}if(Y){if(!Xa(r,function(me,Ie){if(!Es(Y,Ie)&&(ie===me||l(ie,me,s,c,d)))return Y.push(Ie)})){k=!1;break}}else if(!(ie===ve||l(ie,ve,s,c,d))){k=!1;break}}return d.delete(e),d.delete(r),k}function Od(e,r,s,c,l,d,w){switch(s){case Le:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Se:return!(e.byteLength!=r.byteLength||!d(new An(e),new An(r)));case C:case R:case Pe:return $r(+e,+r);case E:return e.name==r.name&&e.message==r.message;case Ze:case ke:return e==r+"";case ge:var b=no;case Ae:var P=c&A;if(b||(b=In),e.size!=r.size&&!P)return!1;var D=w.get(e);if(D)return D==r;c|=Z,w.set(e,r);var L=Fu(b(e),b(r),c,l,d,w);return w.delete(e),L;case Ke:if(Rs)return Rs.call(e)==Rs.call(r)}return!1}function Ad(e,r,s,c,l,d){var w=s&A,b=To(e),P=b.length,D=To(r),L=D.length;if(P!=L&&!w)return!1;for(var j=P;j--;){var k=b[j];if(!(w?k in r:$e.call(r,k)))return!1}var Y=d.get(e),ie=d.get(r);if(Y&&ie)return Y==r&&ie==e;var ve=!0;d.set(e,r),d.set(r,e);for(var se=w;++j<P;){k=b[j];var me=e[k],Ie=r[k];if(c)var dr=w?c(Ie,me,k,r,e,d):c(me,Ie,k,e,r,d);if(!(dr===i?me===Ie||l(me,Ie,s,c,d):dr)){ve=!1;break}se||(se=k=="constructor")}if(ve&&!se){var Qt=e.constructor,gr=r.constructor;Qt!=gr&&"constructor"in e&&"constructor"in r&&!(typeof Qt=="function"&&Qt instanceof Qt&&typeof gr=="function"&&gr instanceof gr)&&(ve=!1)}return d.delete(e),d.delete(r),ve}function Zr(e){return Mo(Yu(e,i,ah),e+"")}function To(e){return lu(e,Dt,qo)}function $o(e){return lu(e,rr,Bu)}var No=qn?function(e){return qn.get(e)}:Zo;function Jn(e){for(var r=e.name+"",s=is[r],c=$e.call(is,r)?s.length:0;c--;){var l=s[c],d=l.func;if(d==null||d==e)return l.name}return r}function os(e){var r=$e.call(f,"placeholder")?f:e;return r.placeholder}function ee(){var e=f.iteratee||Qo;return e=e===Qo?du:e,arguments.length?e(arguments[0],arguments[1]):e}function Qn(e,r){var s=e.__data__;return zd(r)?s[typeof r=="string"?"string":"hash"]:s.map}function Do(e){for(var r=Dt(e),s=r.length;s--;){var c=r[s],l=e[c];r[s]=[c,l,Ju(l)]}return r}function Li(e,r){var s=Uf(e,r);return pu(s)?s:i}function Cd(e){var r=$e.call(e,Ti),s=e[Ti];try{e[Ti]=i;var c=!0}catch{}var l=Rn.call(e);return c&&(r?e[Ti]=s:delete e[Ti]),l}var qo=oo?function(e){return e==null?[]:(e=Ue(e),ci(oo(e),function(r){return Zc.call(e,r)}))}:Xo,Bu=oo?function(e){for(var r=[];e;)ui(r,qo(e)),e=Cn(e);return r}:Xo,Ht=Wt;(co&&Ht(new co(new ArrayBuffer(1)))!=Le||xs&&Ht(new xs)!=ge||uo&&Ht(uo.resolve())!=yt||rs&&Ht(new rs)!=Ae||Ps&&Ht(new Ps)!=Ne)&&(Ht=function(e){var r=Wt(e),s=r==_e?e.constructor:i,c=s?zi(s):"";if(c)switch(c){case fp:return Le;case pp:return ge;case dp:return yt;case gp:return Ae;case vp:return Ne}return r});function Td(e,r,s){for(var c=-1,l=s.length;++c<l;){var d=s[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":r-=w;break;case"take":r=Ut(r,e+w);break;case"takeRight":e=Ct(e,r-w);break}}return{start:e,end:r}}function $d(e){var r=e.match(He);return r?r[1].split(Et):[]}function Gu(e,r,s){r=di(r,e);for(var c=-1,l=r.length,d=!1;++c<l;){var w=kr(r[c]);if(!(d=e!=null&&s(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&ia(l)&&Xr(w,l)&&(le(e)||ji(e)))}function Nd(e){var r=e.length,s=new e.constructor(r);return r&&typeof e[0]=="string"&&$e.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Wu(e){return typeof e.constructor=="function"&&!Ds(e)?ss(Cn(e)):{}}function Dd(e,r,s){var c=e.constructor;switch(r){case Se:return Oo(e);case C:case R:return new c(+e);case Le:return yd(e,s);case it:case Te:case mt:case Ot:case Lt:case zt:case $t:case Ft:case Zt:return Cu(e,s);case ge:return new c;case Pe:case ke:return new c(e);case Ze:return md(e);case Ae:return new c;case Ke:return wd(e)}}function qd(e,r){var s=r.length;if(!s)return e;var c=s-1;return r[c]=(s>1?"& ":"")+r[c],r=r.join(s>2?", ":" "),e.replace(ut,`{
/* [wrapped with `+r+`] */
`)}function Ld(e){return le(e)||ji(e)||!!(Xc&&e&&e[Xc])}function Xr(e,r){var s=typeof e;return r=r??G,!!r&&(s=="number"||s!="symbol"&&za.test(e))&&e>-1&&e%1==0&&e<r}function Jt(e,r,s){if(!tt(s))return!1;var c=typeof r;return(c=="number"?tr(s)&&Xr(r,s.length):c=="string"&&r in s)?$r(s[r],e):!1}function Lo(e,r){if(le(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:wt.test(e)||!Je.test(e)||r!=null&&e in Ue(r)}function zd(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function zo(e){var r=Jn(e),s=f[r];if(typeof s!="function"||!(r in be.prototype))return!1;if(e===s)return!0;var c=No(s);return!!c&&e===c[0]}function jd(e){return!!Jc&&Jc in e}var Md=Pn?ei:ec;function Ds(e){var r=e&&e.constructor,s=typeof r=="function"&&r.prototype||ts;return e===s}function Ju(e){return e===e&&!tt(e)}function Qu(e,r){return function(s){return s==null?!1:s[e]===r&&(r!==i||e in Ue(s))}}function Ud(e){var r=ta(e,function(c){return s.size===g&&s.clear(),c}),s=r.cache;return r}function Hd(e,r){var s=e[1],c=r[1],l=s|c,d=l<(te|ce|Q),w=c==Q&&s==ne||c==Q&&s==xe&&e[7].length<=r[8]||c==(Q|xe)&&r[7].length<=r[8]&&s==ne;if(!(d||w))return e;c&te&&(e[2]=r[2],l|=s&te?0:oe);var b=r[3];if(b){var P=e[3];e[3]=P?$u(P,b,r[4]):b,e[4]=P?hi(e[3],_):r[4]}return b=r[5],b&&(P=e[5],e[5]=P?Nu(P,b,r[6]):b,e[6]=P?hi(e[5],_):r[6]),b=r[7],b&&(e[7]=b),c&Q&&(e[8]=e[8]==null?r[8]:Ut(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=l,e}function kd(e){var r=[];if(e!=null)for(var s in Ue(e))r.push(s);return r}function Kd(e){return Rn.call(e)}function Yu(e,r,s){return r=Ct(r===i?e.length-1:r,0),function(){for(var c=arguments,l=-1,d=Ct(c.length-r,0),w=O(d);++l<d;)w[l]=c[r+l];l=-1;for(var b=O(r+1);++l<r;)b[l]=c[l];return b[r]=s(w),Nt(e,this,b)}}function Zu(e,r){return r.length<2?e:qi(e,Er(r,0,-1))}function Vd(e,r){for(var s=e.length,c=Ut(r.length,s),l=er(e);c--;){var d=r[c];e[c]=Xr(d,s)?l[d]:i}return e}function jo(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var Xu=th(Eu),qs=np||function(e,r){return Ee.setTimeout(e,r)},Mo=th(pd);function eh(e,r,s){var c=r+"";return Mo(e,qd(c,Fd($d(c),s)))}function th(e){var r=0,s=0;return function(){var c=up(),l=ur-(c-s);if(s=c,l>0){if(++r>=Vt)return arguments[0]}else r=0;return e.apply(i,arguments)}}function Yn(e,r){var s=-1,c=e.length,l=c-1;for(r=r===i?c:r;++s<r;){var d=bo(s,l),w=e[d];e[d]=e[s],e[s]=w}return e.length=r,e}var rh=Ud(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(_t,function(s,c,l,d){r.push(l?d.replace(Ta,"$1"):c||s)}),r});function kr(e){if(typeof e=="string"||pr(e))return e;var r=e+"";return r=="0"&&1/e==-qe?"-0":r}function zi(e){if(e!=null){try{return Sn.call(e)}catch{}try{return e+""}catch{}}return""}function Fd(e,r){return mr(xi,function(s){var c="_."+s[0];r&s[1]&&!bn(e,c)&&e.push(c)}),e.sort()}function ih(e){if(e instanceof be)return e.clone();var r=new _r(e.__wrapped__,e.__chain__);return r.__actions__=er(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function Bd(e,r,s){(s?Jt(e,r,s):r===i)?r=1:r=Ct(de(r),0);var c=e==null?0:e.length;if(!c||r<1)return[];for(var l=0,d=0,w=O(Nn(c/r));l<c;)w[d++]=Er(e,l,l+=r);return w}function Gd(e){for(var r=-1,s=e==null?0:e.length,c=0,l=[];++r<s;){var d=e[r];d&&(l[c++]=d)}return l}function Wd(){var e=arguments.length;if(!e)return[];for(var r=O(e-1),s=arguments[0],c=e;c--;)r[c-1]=arguments[c];return ui(le(s)?er(s):[s],jt(r,1))}var Jd=ye(function(e,r){return dt(e)?As(e,jt(r,1,dt,!0)):[]}),Qd=ye(function(e,r){var s=Ir(r);return dt(s)&&(s=i),dt(e)?As(e,jt(r,1,dt,!0),ee(s,2)):[]}),Yd=ye(function(e,r){var s=Ir(r);return dt(s)&&(s=i),dt(e)?As(e,jt(r,1,dt,!0),i,s):[]});function Zd(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:de(r),Er(e,r<0?0:r,c)):[]}function Xd(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:de(r),r=c-r,Er(e,0,r<0?0:r)):[]}function eg(e,r){return e&&e.length?Kn(e,ee(r,3),!0,!0):[]}function tg(e,r){return e&&e.length?Kn(e,ee(r,3),!0):[]}function rg(e,r,s,c){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Jt(e,r,s)&&(s=0,c=l),Wp(e,r,s,c)):[]}function sh(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:de(s);return l<0&&(l=Ct(c+l,0)),En(e,ee(r,3),l)}function nh(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return s!==i&&(l=de(s),l=s<0?Ct(c+l,0):Ut(l,c-1)),En(e,ee(r,3),l,!0)}function ah(e){var r=e==null?0:e.length;return r?jt(e,1):[]}function ig(e){var r=e==null?0:e.length;return r?jt(e,qe):[]}function sg(e,r){var s=e==null?0:e.length;return s?(r=r===i?1:de(r),jt(e,r)):[]}function ng(e){for(var r=-1,s=e==null?0:e.length,c={};++r<s;){var l=e[r];c[l[0]]=l[1]}return c}function oh(e){return e&&e.length?e[0]:i}function ag(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:de(s);return l<0&&(l=Ct(c+l,0)),Yi(e,r,l)}function og(e){var r=e==null?0:e.length;return r?Er(e,0,-1):[]}var cg=ye(function(e){var r=Qe(e,So);return r.length&&r[0]===e[0]?vo(r):[]}),ug=ye(function(e){var r=Ir(e),s=Qe(e,So);return r===Ir(s)?r=i:s.pop(),s.length&&s[0]===e[0]?vo(s,ee(r,2)):[]}),hg=ye(function(e){var r=Ir(e),s=Qe(e,So);return r=typeof r=="function"?r:i,r&&s.pop(),s.length&&s[0]===e[0]?vo(s,i,r):[]});function lg(e,r){return e==null?"":op.call(e,r)}function Ir(e){var r=e==null?0:e.length;return r?e[r-1]:i}function fg(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=c;return s!==i&&(l=de(s),l=l<0?Ct(c+l,0):Ut(l,c-1)),r===r?Ff(e,r,l):En(e,Hc,l,!0)}function pg(e,r){return e&&e.length?mu(e,de(r)):i}var dg=ye(ch);function ch(e,r){return e&&e.length&&r&&r.length?_o(e,r):e}function gg(e,r,s){return e&&e.length&&r&&r.length?_o(e,r,ee(s,2)):e}function vg(e,r,s){return e&&e.length&&r&&r.length?_o(e,r,i,s):e}var yg=Zr(function(e,r){var s=e==null?0:e.length,c=lo(e,r);return bu(e,Qe(r,function(l){return Xr(l,s)?+l:l}).sort(Tu)),c});function mg(e,r){var s=[];if(!(e&&e.length))return s;var c=-1,l=[],d=e.length;for(r=ee(r,3);++c<d;){var w=e[c];r(w,c,e)&&(s.push(w),l.push(c))}return bu(e,l),s}function Uo(e){return e==null?e:lp.call(e)}function wg(e,r,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&Jt(e,r,s)?(r=0,s=c):(r=r==null?0:de(r),s=s===i?c:de(s)),Er(e,r,s)):[]}function _g(e,r){return kn(e,r)}function bg(e,r,s){return Io(e,r,ee(s,2))}function Eg(e,r){var s=e==null?0:e.length;if(s){var c=kn(e,r);if(c<s&&$r(e[c],r))return c}return-1}function Ig(e,r){return kn(e,r,!0)}function xg(e,r,s){return Io(e,r,ee(s,2),!0)}function Pg(e,r){var s=e==null?0:e.length;if(s){var c=kn(e,r,!0)-1;if($r(e[c],r))return c}return-1}function Sg(e){return e&&e.length?Iu(e):[]}function Rg(e,r){return e&&e.length?Iu(e,ee(r,2)):[]}function Og(e){var r=e==null?0:e.length;return r?Er(e,1,r):[]}function Ag(e,r,s){return e&&e.length?(r=s||r===i?1:de(r),Er(e,0,r<0?0:r)):[]}function Cg(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:de(r),r=c-r,Er(e,r<0?0:r,c)):[]}function Tg(e,r){return e&&e.length?Kn(e,ee(r,3),!1,!0):[]}function $g(e,r){return e&&e.length?Kn(e,ee(r,3)):[]}var Ng=ye(function(e){return pi(jt(e,1,dt,!0))}),Dg=ye(function(e){var r=Ir(e);return dt(r)&&(r=i),pi(jt(e,1,dt,!0),ee(r,2))}),qg=ye(function(e){var r=Ir(e);return r=typeof r=="function"?r:i,pi(jt(e,1,dt,!0),i,r)});function Lg(e){return e&&e.length?pi(e):[]}function zg(e,r){return e&&e.length?pi(e,ee(r,2)):[]}function jg(e,r){return r=typeof r=="function"?r:i,e&&e.length?pi(e,i,r):[]}function Ho(e){if(!(e&&e.length))return[];var r=0;return e=ci(e,function(s){if(dt(s))return r=Ct(s.length,r),!0}),io(r,function(s){return Qe(e,eo(s))})}function uh(e,r){if(!(e&&e.length))return[];var s=Ho(e);return r==null?s:Qe(s,function(c){return Nt(r,i,c)})}var Mg=ye(function(e,r){return dt(e)?As(e,r):[]}),Ug=ye(function(e){return Po(ci(e,dt))}),Hg=ye(function(e){var r=Ir(e);return dt(r)&&(r=i),Po(ci(e,dt),ee(r,2))}),kg=ye(function(e){var r=Ir(e);return r=typeof r=="function"?r:i,Po(ci(e,dt),i,r)}),Kg=ye(Ho);function Vg(e,r){return Ru(e||[],r||[],Os)}function Fg(e,r){return Ru(e||[],r||[],$s)}var Bg=ye(function(e){var r=e.length,s=r>1?e[r-1]:i;return s=typeof s=="function"?(e.pop(),s):i,uh(e,s)});function hh(e){var r=f(e);return r.__chain__=!0,r}function Gg(e,r){return r(e),e}function Zn(e,r){return r(e)}var Wg=Zr(function(e){var r=e.length,s=r?e[0]:0,c=this.__wrapped__,l=function(d){return lo(d,e)};return r>1||this.__actions__.length||!(c instanceof be)||!Xr(s)?this.thru(l):(c=c.slice(s,+s+(r?1:0)),c.__actions__.push({func:Zn,args:[l],thisArg:i}),new _r(c,this.__chain__).thru(function(d){return r&&!d.length&&d.push(i),d}))});function Jg(){return hh(this)}function Qg(){return new _r(this.value(),this.__chain__)}function Yg(){this.__values__===i&&(this.__values__=xh(this.value()));var e=this.__index__>=this.__values__.length,r=e?i:this.__values__[this.__index__++];return{done:e,value:r}}function Zg(){return this}function Xg(e){for(var r,s=this;s instanceof zn;){var c=ih(s);c.__index__=0,c.__values__=i,r?l.__wrapped__=c:r=c;var l=c;s=s.__wrapped__}return l.__wrapped__=e,r}function ev(){var e=this.__wrapped__;if(e instanceof be){var r=e;return this.__actions__.length&&(r=new be(this)),r=r.reverse(),r.__actions__.push({func:Zn,args:[Uo],thisArg:i}),new _r(r,this.__chain__)}return this.thru(Uo)}function tv(){return Su(this.__wrapped__,this.__actions__)}var rv=Vn(function(e,r,s){$e.call(e,s)?++e[s]:Qr(e,s,1)});function iv(e,r,s){var c=le(e)?Mc:Gp;return s&&Jt(e,r,s)&&(r=i),c(e,ee(r,3))}function sv(e,r){var s=le(e)?ci:uu;return s(e,ee(r,3))}var nv=zu(sh),av=zu(nh);function ov(e,r){return jt(Xn(e,r),1)}function cv(e,r){return jt(Xn(e,r),qe)}function uv(e,r,s){return s=s===i?1:de(s),jt(Xn(e,r),s)}function lh(e,r){var s=le(e)?mr:fi;return s(e,ee(r,3))}function fh(e,r){var s=le(e)?Of:cu;return s(e,ee(r,3))}var hv=Vn(function(e,r,s){$e.call(e,s)?e[s].push(r):Qr(e,s,[r])});function lv(e,r,s,c){e=tr(e)?e:us(e),s=s&&!c?de(s):0;var l=e.length;return s<0&&(s=Ct(l+s,0)),sa(e)?s<=l&&e.indexOf(r,s)>-1:!!l&&Yi(e,r,s)>-1}var fv=ye(function(e,r,s){var c=-1,l=typeof r=="function",d=tr(e)?O(e.length):[];return fi(e,function(w){d[++c]=l?Nt(r,w,s):Cs(w,r,s)}),d}),pv=Vn(function(e,r,s){Qr(e,s,r)});function Xn(e,r){var s=le(e)?Qe:gu;return s(e,ee(r,3))}function dv(e,r,s,c){return e==null?[]:(le(r)||(r=r==null?[]:[r]),s=c?i:s,le(s)||(s=s==null?[]:[s]),wu(e,r,s))}var gv=Vn(function(e,r,s){e[s?0:1].push(r)},function(){return[[],[]]});function vv(e,r,s){var c=le(e)?Za:Kc,l=arguments.length<3;return c(e,ee(r,4),s,l,fi)}function yv(e,r,s){var c=le(e)?Af:Kc,l=arguments.length<3;return c(e,ee(r,4),s,l,cu)}function mv(e,r){var s=le(e)?ci:uu;return s(e,ra(ee(r,3)))}function wv(e){var r=le(e)?su:ld;return r(e)}function _v(e,r,s){(s?Jt(e,r,s):r===i)?r=1:r=de(r);var c=le(e)?kp:fd;return c(e,r)}function bv(e){var r=le(e)?Kp:dd;return r(e)}function Ev(e){if(e==null)return 0;if(tr(e))return sa(e)?Xi(e):e.length;var r=Ht(e);return r==ge||r==Ae?e.size:mo(e).length}function Iv(e,r,s){var c=le(e)?Xa:gd;return s&&Jt(e,r,s)&&(r=i),c(e,ee(r,3))}var xv=ye(function(e,r){if(e==null)return[];var s=r.length;return s>1&&Jt(e,r[0],r[1])?r=[]:s>2&&Jt(r[0],r[1],r[2])&&(r=[r[0]]),wu(e,jt(r,1),[])}),ea=sp||function(){return Ee.Date.now()};function Pv(e,r){if(typeof r!="function")throw new wr(p);return e=de(e),function(){if(--e<1)return r.apply(this,arguments)}}function ph(e,r,s){return r=s?i:r,r=e&&r==null?e.length:r,Yr(e,Q,i,i,i,i,r)}function dh(e,r){var s;if(typeof r!="function")throw new wr(p);return e=de(e),function(){return--e>0&&(s=r.apply(this,arguments)),e<=1&&(r=i),s}}var ko=ye(function(e,r,s){var c=te;if(s.length){var l=hi(s,os(ko));c|=fe}return Yr(e,c,r,s,l)}),gh=ye(function(e,r,s){var c=te|ce;if(s.length){var l=hi(s,os(gh));c|=fe}return Yr(r,c,e,s,l)});function vh(e,r,s){r=s?i:r;var c=Yr(e,ne,i,i,i,i,i,r);return c.placeholder=vh.placeholder,c}function yh(e,r,s){r=s?i:r;var c=Yr(e,re,i,i,i,i,i,r);return c.placeholder=yh.placeholder,c}function mh(e,r,s){var c,l,d,w,b,P,D=0,L=!1,j=!1,k=!0;if(typeof e!="function")throw new wr(p);r=xr(r)||0,tt(s)&&(L=!!s.leading,j="maxWait"in s,d=j?Ct(xr(s.maxWait)||0,r):d,k="trailing"in s?!!s.trailing:k);function Y(gt){var Nr=c,ri=l;return c=l=i,D=gt,w=e.apply(ri,Nr),w}function ie(gt){return D=gt,b=qs(me,r),L?Y(gt):w}function ve(gt){var Nr=gt-P,ri=gt-D,zh=r-Nr;return j?Ut(zh,d-ri):zh}function se(gt){var Nr=gt-P,ri=gt-D;return P===i||Nr>=r||Nr<0||j&&ri>=d}function me(){var gt=ea();if(se(gt))return Ie(gt);b=qs(me,ve(gt))}function Ie(gt){return b=i,k&&c?Y(gt):(c=l=i,w)}function dr(){b!==i&&Ou(b),D=0,c=P=l=b=i}function Qt(){return b===i?w:Ie(ea())}function gr(){var gt=ea(),Nr=se(gt);if(c=arguments,l=this,P=gt,Nr){if(b===i)return ie(P);if(j)return Ou(b),b=qs(me,r),Y(P)}return b===i&&(b=qs(me,r)),w}return gr.cancel=dr,gr.flush=Qt,gr}var Sv=ye(function(e,r){return ou(e,1,r)}),Rv=ye(function(e,r,s){return ou(e,xr(r)||0,s)});function Ov(e){return Yr(e,Tt)}function ta(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new wr(p);var s=function(){var c=arguments,l=r?r.apply(this,c):c[0],d=s.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return s.cache=d.set(l,w)||d,w};return s.cache=new(ta.Cache||Jr),s}ta.Cache=Jr;function ra(e){if(typeof e!="function")throw new wr(p);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Av(e){return dh(2,e)}var Cv=vd(function(e,r){r=r.length==1&&le(r[0])?Qe(r[0],lr(ee())):Qe(jt(r,1),lr(ee()));var s=r.length;return ye(function(c){for(var l=-1,d=Ut(c.length,s);++l<d;)c[l]=r[l].call(this,c[l]);return Nt(e,this,c)})}),Ko=ye(function(e,r){var s=hi(r,os(Ko));return Yr(e,fe,i,r,s)}),wh=ye(function(e,r){var s=hi(r,os(wh));return Yr(e,pe,i,r,s)}),Tv=Zr(function(e,r){return Yr(e,xe,i,i,i,r)});function $v(e,r){if(typeof e!="function")throw new wr(p);return r=r===i?r:de(r),ye(e,r)}function Nv(e,r){if(typeof e!="function")throw new wr(p);return r=r==null?0:Ct(de(r),0),ye(function(s){var c=s[r],l=gi(s,0,r);return c&&ui(l,c),Nt(e,this,l)})}function Dv(e,r,s){var c=!0,l=!0;if(typeof e!="function")throw new wr(p);return tt(s)&&(c="leading"in s?!!s.leading:c,l="trailing"in s?!!s.trailing:l),mh(e,r,{leading:c,maxWait:r,trailing:l})}function qv(e){return ph(e,1)}function Lv(e,r){return Ko(Ro(r),e)}function zv(){if(!arguments.length)return[];var e=arguments[0];return le(e)?e:[e]}function jv(e){return br(e,q)}function Mv(e,r){return r=typeof r=="function"?r:i,br(e,q,r)}function Uv(e){return br(e,S|q)}function Hv(e,r){return r=typeof r=="function"?r:i,br(e,S|q,r)}function kv(e,r){return r==null||au(e,r,Dt(r))}function $r(e,r){return e===r||e!==e&&r!==r}var Kv=Wn(go),Vv=Wn(function(e,r){return e>=r}),ji=fu(function(){return arguments}())?fu:function(e){return ht(e)&&$e.call(e,"callee")&&!Zc.call(e,"callee")},le=O.isArray,Fv=Gt?lr(Gt):Xp;function tr(e){return e!=null&&ia(e.length)&&!ei(e)}function dt(e){return ht(e)&&tr(e)}function Bv(e){return e===!0||e===!1||ht(e)&&Wt(e)==C}var vi=ap||ec,Gv=Ar?lr(Ar):ed;function Wv(e){return ht(e)&&e.nodeType===1&&!Ls(e)}function Jv(e){if(e==null)return!0;if(tr(e)&&(le(e)||typeof e=="string"||typeof e.splice=="function"||vi(e)||cs(e)||ji(e)))return!e.length;var r=Ht(e);if(r==ge||r==Ae)return!e.size;if(Ds(e))return!mo(e).length;for(var s in e)if($e.call(e,s))return!1;return!0}function Qv(e,r){return Ts(e,r)}function Yv(e,r,s){s=typeof s=="function"?s:i;var c=s?s(e,r):i;return c===i?Ts(e,r,i,s):!!c}function Vo(e){if(!ht(e))return!1;var r=Wt(e);return r==E||r==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ls(e)}function Zv(e){return typeof e=="number"&&eu(e)}function ei(e){if(!tt(e))return!1;var r=Wt(e);return r==J||r==ae||r==T||r==lt}function _h(e){return typeof e=="number"&&e==de(e)}function ia(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=G}function tt(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function ht(e){return e!=null&&typeof e=="object"}var bh=yr?lr(yr):rd;function Xv(e,r){return e===r||yo(e,r,Do(r))}function ey(e,r,s){return s=typeof s=="function"?s:i,yo(e,r,Do(r),s)}function ty(e){return Eh(e)&&e!=+e}function ry(e){if(Md(e))throw new ue(h);return pu(e)}function iy(e){return e===null}function sy(e){return e==null}function Eh(e){return typeof e=="number"||ht(e)&&Wt(e)==Pe}function Ls(e){if(!ht(e)||Wt(e)!=_e)return!1;var r=Cn(e);if(r===null)return!0;var s=$e.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&Sn.call(s)==ep}var Fo=Mr?lr(Mr):id;function ny(e){return _h(e)&&e>=-G&&e<=G}var Ih=bs?lr(bs):sd;function sa(e){return typeof e=="string"||!le(e)&&ht(e)&&Wt(e)==ke}function pr(e){return typeof e=="symbol"||ht(e)&&Wt(e)==Ke}var cs=Ci?lr(Ci):nd;function ay(e){return e===i}function oy(e){return ht(e)&&Ht(e)==Ne}function cy(e){return ht(e)&&Wt(e)==Ve}var uy=Wn(wo),hy=Wn(function(e,r){return e<=r});function xh(e){if(!e)return[];if(tr(e))return sa(e)?Cr(e):er(e);if(Is&&e[Is])return kf(e[Is]());var r=Ht(e),s=r==ge?no:r==Ae?In:us;return s(e)}function ti(e){if(!e)return e===0?e:0;if(e=xr(e),e===qe||e===-qe){var r=e<0?-1:1;return r*K}return e===e?e:0}function de(e){var r=ti(e),s=r%1;return r===r?s?r-s:r:0}function Ph(e){return e?Di(de(e),0,V):0}function xr(e){if(typeof e=="number")return e;if(pr(e))return H;if(tt(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=tt(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Vc(e);var s=Da.test(e);return s||La.test(e)?he(e.slice(2),s?2:8):Na.test(e)?H:+e}function Sh(e){return Hr(e,rr(e))}function ly(e){return e?Di(de(e),-G,G):e===0?e:0}function Ce(e){return e==null?"":fr(e)}var fy=ns(function(e,r){if(Ds(r)||tr(r)){Hr(r,Dt(r),e);return}for(var s in r)$e.call(r,s)&&Os(e,s,r[s])}),Rh=ns(function(e,r){Hr(r,rr(r),e)}),na=ns(function(e,r,s,c){Hr(r,rr(r),e,c)}),py=ns(function(e,r,s,c){Hr(r,Dt(r),e,c)}),dy=Zr(lo);function gy(e,r){var s=ss(e);return r==null?s:nu(s,r)}var vy=ye(function(e,r){e=Ue(e);var s=-1,c=r.length,l=c>2?r[2]:i;for(l&&Jt(r[0],r[1],l)&&(c=1);++s<c;)for(var d=r[s],w=rr(d),b=-1,P=w.length;++b<P;){var D=w[b],L=e[D];(L===i||$r(L,ts[D])&&!$e.call(e,D))&&(e[D]=d[D])}return e}),yy=ye(function(e){return e.push(i,Vu),Nt(Oh,i,e)});function my(e,r){return Uc(e,ee(r,3),Ur)}function wy(e,r){return Uc(e,ee(r,3),po)}function _y(e,r){return e==null?e:fo(e,ee(r,3),rr)}function by(e,r){return e==null?e:hu(e,ee(r,3),rr)}function Ey(e,r){return e&&Ur(e,ee(r,3))}function Iy(e,r){return e&&po(e,ee(r,3))}function xy(e){return e==null?[]:Un(e,Dt(e))}function Py(e){return e==null?[]:Un(e,rr(e))}function Bo(e,r,s){var c=e==null?i:qi(e,r);return c===i?s:c}function Sy(e,r){return e!=null&&Gu(e,r,Jp)}function Go(e,r){return e!=null&&Gu(e,r,Qp)}var Ry=Mu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=Rn.call(r)),e[r]=s},Jo(ir)),Oy=Mu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=Rn.call(r)),$e.call(e,r)?e[r].push(s):e[r]=[s]},ee),Ay=ye(Cs);function Dt(e){return tr(e)?iu(e):mo(e)}function rr(e){return tr(e)?iu(e,!0):ad(e)}function Cy(e,r){var s={};return r=ee(r,3),Ur(e,function(c,l,d){Qr(s,r(c,l,d),c)}),s}function Ty(e,r){var s={};return r=ee(r,3),Ur(e,function(c,l,d){Qr(s,l,r(c,l,d))}),s}var $y=ns(function(e,r,s){Hn(e,r,s)}),Oh=ns(function(e,r,s,c){Hn(e,r,s,c)}),Ny=Zr(function(e,r){var s={};if(e==null)return s;var c=!1;r=Qe(r,function(d){return d=di(d,e),c||(c=d.length>1),d}),Hr(e,$o(e),s),c&&(s=br(s,S|$|q,Rd));for(var l=r.length;l--;)xo(s,r[l]);return s});function Dy(e,r){return Ah(e,ra(ee(r)))}var qy=Zr(function(e,r){return e==null?{}:cd(e,r)});function Ah(e,r){if(e==null)return{};var s=Qe($o(e),function(c){return[c]});return r=ee(r),_u(e,s,function(c,l){return r(c,l[0])})}function Ly(e,r,s){r=di(r,e);var c=-1,l=r.length;for(l||(l=1,e=i);++c<l;){var d=e==null?i:e[kr(r[c])];d===i&&(c=l,d=s),e=ei(d)?d.call(e):d}return e}function zy(e,r,s){return e==null?e:$s(e,r,s)}function jy(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:$s(e,r,s,c)}var Ch=ku(Dt),Th=ku(rr);function My(e,r,s){var c=le(e),l=c||vi(e)||cs(e);if(r=ee(r,4),s==null){var d=e&&e.constructor;l?s=c?new d:[]:tt(e)?s=ei(d)?ss(Cn(e)):{}:s={}}return(l?mr:Ur)(e,function(w,b,P){return r(s,w,b,P)}),s}function Uy(e,r){return e==null?!0:xo(e,r)}function Hy(e,r,s){return e==null?e:Pu(e,r,Ro(s))}function ky(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:Pu(e,r,Ro(s),c)}function us(e){return e==null?[]:so(e,Dt(e))}function Ky(e){return e==null?[]:so(e,rr(e))}function Vy(e,r,s){return s===i&&(s=r,r=i),s!==i&&(s=xr(s),s=s===s?s:0),r!==i&&(r=xr(r),r=r===r?r:0),Di(xr(e),r,s)}function Fy(e,r,s){return r=ti(r),s===i?(s=r,r=0):s=ti(s),e=xr(e),Yp(e,r,s)}function By(e,r,s){if(s&&typeof s!="boolean"&&Jt(e,r,s)&&(r=s=i),s===i&&(typeof r=="boolean"?(s=r,r=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&r===i?(e=0,r=1):(e=ti(e),r===i?(r=e,e=0):r=ti(r)),e>r){var c=e;e=r,r=c}if(s||e%1||r%1){var l=tu();return Ut(e+l*(r-e+je("1e-"+((l+"").length-1))),r)}return bo(e,r)}var Gy=as(function(e,r,s){return r=r.toLowerCase(),e+(s?$h(r):r)});function $h(e){return Wo(Ce(e).toLowerCase())}function Nh(e){return e=Ce(e),e&&e.replace(Br,zf).replace(Ja,"")}function Wy(e,r,s){e=Ce(e),r=fr(r);var c=e.length;s=s===i?c:Di(de(s),0,c);var l=s;return s-=r.length,s>=0&&e.slice(s,l)==r}function Jy(e){return e=Ce(e),e&&We.test(e)?e.replace(Pi,jf):e}function Qy(e){return e=Ce(e),e&&bt.test(e)?e.replace(ot,"\\$&"):e}var Yy=as(function(e,r,s){return e+(s?"-":"")+r.toLowerCase()}),Zy=as(function(e,r,s){return e+(s?" ":"")+r.toLowerCase()}),Xy=Lu("toLowerCase");function em(e,r,s){e=Ce(e),r=de(r);var c=r?Xi(e):0;if(!r||c>=r)return e;var l=(r-c)/2;return Gn(Dn(l),s)+e+Gn(Nn(l),s)}function tm(e,r,s){e=Ce(e),r=de(r);var c=r?Xi(e):0;return r&&c<r?e+Gn(r-c,s):e}function rm(e,r,s){e=Ce(e),r=de(r);var c=r?Xi(e):0;return r&&c<r?Gn(r-c,s)+e:e}function im(e,r,s){return s||r==null?r=0:r&&(r=+r),hp(Ce(e).replace(ct,""),r||0)}function sm(e,r,s){return(s?Jt(e,r,s):r===i)?r=1:r=de(r),Eo(Ce(e),r)}function nm(){var e=arguments,r=Ce(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var am=as(function(e,r,s){return e+(s?"_":"")+r.toLowerCase()});function om(e,r,s){return s&&typeof s!="number"&&Jt(e,r,s)&&(r=s=i),s=s===i?V:s>>>0,s?(e=Ce(e),e&&(typeof r=="string"||r!=null&&!Fo(r))&&(r=fr(r),!r&&Zi(e))?gi(Cr(e),0,s):e.split(r,s)):[]}var cm=as(function(e,r,s){return e+(s?" ":"")+Wo(r)});function um(e,r,s){return e=Ce(e),s=s==null?0:Di(de(s),0,e.length),r=fr(r),e.slice(s,s+r.length)==r}function hm(e,r,s){var c=f.templateSettings;s&&Jt(e,r,s)&&(r=i),e=Ce(e),r=na({},r,c,Ku);var l=na({},r.imports,c.imports,Ku),d=Dt(l),w=so(l,d),b,P,D=0,L=r.interpolate||Vi,j="__p += '",k=ao((r.escape||Vi).source+"|"+L.source+"|"+(L===et?$a:Vi).source+"|"+(r.evaluate||Vi).source+"|$","g"),Y="//# sourceURL="+($e.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qa+"]")+`
`;e.replace(k,function(se,me,Ie,dr,Qt,gr){return Ie||(Ie=dr),j+=e.slice(D,gr).replace(ja,Mf),me&&(b=!0,j+=`' +
__e(`+me+`) +
'`),Qt&&(P=!0,j+=`';
`+Qt+`;
__p += '`),Ie&&(j+=`' +
((__t = (`+Ie+`)) == null ? '' : __t) +
'`),D=gr+se.length,se}),j+=`';
`;var ie=$e.call(r,"variable")&&r.variable;if(!ie)j=`with (obj) {
`+j+`
}
`;else if(Ca.test(ie))throw new ue(y);j=(P?j.replace(zr,""):j).replace(Bt,"$1").replace(Fr,"$1;"),j="function("+(ie||"obj")+`) {
`+(ie?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+j+`return __p
}`;var ve=qh(function(){return Oe(d,Y+"return "+j).apply(i,w)});if(ve.source=j,Vo(ve))throw ve;return ve}function lm(e){return Ce(e).toLowerCase()}function fm(e){return Ce(e).toUpperCase()}function pm(e,r,s){if(e=Ce(e),e&&(s||r===i))return Vc(e);if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Cr(r),d=Fc(c,l),w=Bc(c,l)+1;return gi(c,d,w).join("")}function dm(e,r,s){if(e=Ce(e),e&&(s||r===i))return e.slice(0,Wc(e)+1);if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Bc(c,Cr(r))+1;return gi(c,0,l).join("")}function gm(e,r,s){if(e=Ce(e),e&&(s||r===i))return e.replace(ct,"");if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Fc(c,Cr(r));return gi(c,l).join("")}function vm(e,r){var s=vt,c=Yt;if(tt(r)){var l="separator"in r?r.separator:l;s="length"in r?de(r.length):s,c="omission"in r?fr(r.omission):c}e=Ce(e);var d=e.length;if(Zi(e)){var w=Cr(e);d=w.length}if(s>=d)return e;var b=s-Xi(c);if(b<1)return c;var P=w?gi(w,0,b).join(""):e.slice(0,b);if(l===i)return P+c;if(w&&(b+=P.length-b),Fo(l)){if(e.slice(b).search(l)){var D,L=P;for(l.global||(l=ao(l.source,Ce(vr.exec(l))+"g")),l.lastIndex=0;D=l.exec(L);)var j=D.index;P=P.slice(0,j===i?b:j)}}else if(e.indexOf(fr(l),b)!=b){var k=P.lastIndexOf(l);k>-1&&(P=P.slice(0,k))}return P+c}function ym(e){return e=Ce(e),e&&st.test(e)?e.replace(ai,Bf):e}var mm=as(function(e,r,s){return e+(s?" ":"")+r.toUpperCase()}),Wo=Lu("toUpperCase");function Dh(e,r,s){return e=Ce(e),r=s?i:r,r===i?Hf(e)?Jf(e):$f(e):e.match(r)||[]}var qh=ye(function(e,r){try{return Nt(e,i,r)}catch(s){return Vo(s)?s:new ue(s)}}),wm=Zr(function(e,r){return mr(r,function(s){s=kr(s),Qr(e,s,ko(e[s],e))}),e});function _m(e){var r=e==null?0:e.length,s=ee();return e=r?Qe(e,function(c){if(typeof c[1]!="function")throw new wr(p);return[s(c[0]),c[1]]}):[],ye(function(c){for(var l=-1;++l<r;){var d=e[l];if(Nt(d[0],this,c))return Nt(d[1],this,c)}})}function bm(e){return Bp(br(e,S))}function Jo(e){return function(){return e}}function Em(e,r){return e==null||e!==e?r:e}var Im=ju(),xm=ju(!0);function ir(e){return e}function Qo(e){return du(typeof e=="function"?e:br(e,S))}function Pm(e){return vu(br(e,S))}function Sm(e,r){return yu(e,br(r,S))}var Rm=ye(function(e,r){return function(s){return Cs(s,e,r)}}),Om=ye(function(e,r){return function(s){return Cs(e,s,r)}});function Yo(e,r,s){var c=Dt(r),l=Un(r,c);s==null&&!(tt(r)&&(l.length||!c.length))&&(s=r,r=e,e=this,l=Un(r,Dt(r)));var d=!(tt(s)&&"chain"in s)||!!s.chain,w=ei(e);return mr(l,function(b){var P=r[b];e[b]=P,w&&(e.prototype[b]=function(){var D=this.__chain__;if(d||D){var L=e(this.__wrapped__),j=L.__actions__=er(this.__actions__);return j.push({func:P,args:arguments,thisArg:e}),L.__chain__=D,L}return P.apply(e,ui([this.value()],arguments))})}),e}function Am(){return Ee._===this&&(Ee._=tp),this}function Zo(){}function Cm(e){return e=de(e),ye(function(r){return mu(r,e)})}var Tm=Ao(Qe),$m=Ao(Mc),Nm=Ao(Xa);function Lh(e){return Lo(e)?eo(kr(e)):ud(e)}function Dm(e){return function(r){return e==null?i:qi(e,r)}}var qm=Uu(),Lm=Uu(!0);function Xo(){return[]}function ec(){return!1}function zm(){return{}}function jm(){return""}function Mm(){return!0}function Um(e,r){if(e=de(e),e<1||e>G)return[];var s=V,c=Ut(e,V);r=ee(r),e-=V;for(var l=io(c,r);++s<e;)r(s);return l}function Hm(e){return le(e)?Qe(e,kr):pr(e)?[e]:er(rh(Ce(e)))}function km(e){var r=++Xf;return Ce(e)+r}var Km=Bn(function(e,r){return e+r},0),Vm=Co("ceil"),Fm=Bn(function(e,r){return e/r},1),Bm=Co("floor");function Gm(e){return e&&e.length?Mn(e,ir,go):i}function Wm(e,r){return e&&e.length?Mn(e,ee(r,2),go):i}function Jm(e){return kc(e,ir)}function Qm(e,r){return kc(e,ee(r,2))}function Ym(e){return e&&e.length?Mn(e,ir,wo):i}function Zm(e,r){return e&&e.length?Mn(e,ee(r,2),wo):i}var Xm=Bn(function(e,r){return e*r},1),e0=Co("round"),t0=Bn(function(e,r){return e-r},0);function r0(e){return e&&e.length?ro(e,ir):0}function i0(e,r){return e&&e.length?ro(e,ee(r,2)):0}return f.after=Pv,f.ary=ph,f.assign=fy,f.assignIn=Rh,f.assignInWith=na,f.assignWith=py,f.at=dy,f.before=dh,f.bind=ko,f.bindAll=wm,f.bindKey=gh,f.castArray=zv,f.chain=hh,f.chunk=Bd,f.compact=Gd,f.concat=Wd,f.cond=_m,f.conforms=bm,f.constant=Jo,f.countBy=rv,f.create=gy,f.curry=vh,f.curryRight=yh,f.debounce=mh,f.defaults=vy,f.defaultsDeep=yy,f.defer=Sv,f.delay=Rv,f.difference=Jd,f.differenceBy=Qd,f.differenceWith=Yd,f.drop=Zd,f.dropRight=Xd,f.dropRightWhile=eg,f.dropWhile=tg,f.fill=rg,f.filter=sv,f.flatMap=ov,f.flatMapDeep=cv,f.flatMapDepth=uv,f.flatten=ah,f.flattenDeep=ig,f.flattenDepth=sg,f.flip=Ov,f.flow=Im,f.flowRight=xm,f.fromPairs=ng,f.functions=xy,f.functionsIn=Py,f.groupBy=hv,f.initial=og,f.intersection=cg,f.intersectionBy=ug,f.intersectionWith=hg,f.invert=Ry,f.invertBy=Oy,f.invokeMap=fv,f.iteratee=Qo,f.keyBy=pv,f.keys=Dt,f.keysIn=rr,f.map=Xn,f.mapKeys=Cy,f.mapValues=Ty,f.matches=Pm,f.matchesProperty=Sm,f.memoize=ta,f.merge=$y,f.mergeWith=Oh,f.method=Rm,f.methodOf=Om,f.mixin=Yo,f.negate=ra,f.nthArg=Cm,f.omit=Ny,f.omitBy=Dy,f.once=Av,f.orderBy=dv,f.over=Tm,f.overArgs=Cv,f.overEvery=$m,f.overSome=Nm,f.partial=Ko,f.partialRight=wh,f.partition=gv,f.pick=qy,f.pickBy=Ah,f.property=Lh,f.propertyOf=Dm,f.pull=dg,f.pullAll=ch,f.pullAllBy=gg,f.pullAllWith=vg,f.pullAt=yg,f.range=qm,f.rangeRight=Lm,f.rearg=Tv,f.reject=mv,f.remove=mg,f.rest=$v,f.reverse=Uo,f.sampleSize=_v,f.set=zy,f.setWith=jy,f.shuffle=bv,f.slice=wg,f.sortBy=xv,f.sortedUniq=Sg,f.sortedUniqBy=Rg,f.split=om,f.spread=Nv,f.tail=Og,f.take=Ag,f.takeRight=Cg,f.takeRightWhile=Tg,f.takeWhile=$g,f.tap=Gg,f.throttle=Dv,f.thru=Zn,f.toArray=xh,f.toPairs=Ch,f.toPairsIn=Th,f.toPath=Hm,f.toPlainObject=Sh,f.transform=My,f.unary=qv,f.union=Ng,f.unionBy=Dg,f.unionWith=qg,f.uniq=Lg,f.uniqBy=zg,f.uniqWith=jg,f.unset=Uy,f.unzip=Ho,f.unzipWith=uh,f.update=Hy,f.updateWith=ky,f.values=us,f.valuesIn=Ky,f.without=Mg,f.words=Dh,f.wrap=Lv,f.xor=Ug,f.xorBy=Hg,f.xorWith=kg,f.zip=Kg,f.zipObject=Vg,f.zipObjectDeep=Fg,f.zipWith=Bg,f.entries=Ch,f.entriesIn=Th,f.extend=Rh,f.extendWith=na,Yo(f,f),f.add=Km,f.attempt=qh,f.camelCase=Gy,f.capitalize=$h,f.ceil=Vm,f.clamp=Vy,f.clone=jv,f.cloneDeep=Uv,f.cloneDeepWith=Hv,f.cloneWith=Mv,f.conformsTo=kv,f.deburr=Nh,f.defaultTo=Em,f.divide=Fm,f.endsWith=Wy,f.eq=$r,f.escape=Jy,f.escapeRegExp=Qy,f.every=iv,f.find=nv,f.findIndex=sh,f.findKey=my,f.findLast=av,f.findLastIndex=nh,f.findLastKey=wy,f.floor=Bm,f.forEach=lh,f.forEachRight=fh,f.forIn=_y,f.forInRight=by,f.forOwn=Ey,f.forOwnRight=Iy,f.get=Bo,f.gt=Kv,f.gte=Vv,f.has=Sy,f.hasIn=Go,f.head=oh,f.identity=ir,f.includes=lv,f.indexOf=ag,f.inRange=Fy,f.invoke=Ay,f.isArguments=ji,f.isArray=le,f.isArrayBuffer=Fv,f.isArrayLike=tr,f.isArrayLikeObject=dt,f.isBoolean=Bv,f.isBuffer=vi,f.isDate=Gv,f.isElement=Wv,f.isEmpty=Jv,f.isEqual=Qv,f.isEqualWith=Yv,f.isError=Vo,f.isFinite=Zv,f.isFunction=ei,f.isInteger=_h,f.isLength=ia,f.isMap=bh,f.isMatch=Xv,f.isMatchWith=ey,f.isNaN=ty,f.isNative=ry,f.isNil=sy,f.isNull=iy,f.isNumber=Eh,f.isObject=tt,f.isObjectLike=ht,f.isPlainObject=Ls,f.isRegExp=Fo,f.isSafeInteger=ny,f.isSet=Ih,f.isString=sa,f.isSymbol=pr,f.isTypedArray=cs,f.isUndefined=ay,f.isWeakMap=oy,f.isWeakSet=cy,f.join=lg,f.kebabCase=Yy,f.last=Ir,f.lastIndexOf=fg,f.lowerCase=Zy,f.lowerFirst=Xy,f.lt=uy,f.lte=hy,f.max=Gm,f.maxBy=Wm,f.mean=Jm,f.meanBy=Qm,f.min=Ym,f.minBy=Zm,f.stubArray=Xo,f.stubFalse=ec,f.stubObject=zm,f.stubString=jm,f.stubTrue=Mm,f.multiply=Xm,f.nth=pg,f.noConflict=Am,f.noop=Zo,f.now=ea,f.pad=em,f.padEnd=tm,f.padStart=rm,f.parseInt=im,f.random=By,f.reduce=vv,f.reduceRight=yv,f.repeat=sm,f.replace=nm,f.result=Ly,f.round=e0,f.runInContext=x,f.sample=wv,f.size=Ev,f.snakeCase=am,f.some=Iv,f.sortedIndex=_g,f.sortedIndexBy=bg,f.sortedIndexOf=Eg,f.sortedLastIndex=Ig,f.sortedLastIndexBy=xg,f.sortedLastIndexOf=Pg,f.startCase=cm,f.startsWith=um,f.subtract=t0,f.sum=r0,f.sumBy=i0,f.template=hm,f.times=Um,f.toFinite=ti,f.toInteger=de,f.toLength=Ph,f.toLower=lm,f.toNumber=xr,f.toSafeInteger=ly,f.toString=Ce,f.toUpper=fm,f.trim=pm,f.trimEnd=dm,f.trimStart=gm,f.truncate=vm,f.unescape=ym,f.uniqueId=km,f.upperCase=mm,f.upperFirst=Wo,f.each=lh,f.eachRight=fh,f.first=oh,Yo(f,function(){var e={};return Ur(f,function(r,s){$e.call(f.prototype,s)||(e[s]=r)}),e}(),{chain:!1}),f.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),mr(["drop","take"],function(e,r){be.prototype[e]=function(s){s=s===i?1:Ct(de(s),0);var c=this.__filtered__&&!r?new be(this):this.clone();return c.__filtered__?c.__takeCount__=Ut(s,c.__takeCount__):c.__views__.push({size:Ut(s,V),type:e+(c.__dir__<0?"Right":"")}),c},be.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),mr(["filter","map","takeWhile"],function(e,r){var s=r+1,c=s==M||s==Ge;be.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ee(l,3),type:s}),d.__filtered__=d.__filtered__||c,d}}),mr(["head","last"],function(e,r){var s="take"+(r?"Right":"");be.prototype[e]=function(){return this[s](1).value()[0]}}),mr(["initial","tail"],function(e,r){var s="drop"+(r?"":"Right");be.prototype[e]=function(){return this.__filtered__?new be(this):this[s](1)}}),be.prototype.compact=function(){return this.filter(ir)},be.prototype.find=function(e){return this.filter(e).head()},be.prototype.findLast=function(e){return this.reverse().find(e)},be.prototype.invokeMap=ye(function(e,r){return typeof e=="function"?new be(this):this.map(function(s){return Cs(s,e,r)})}),be.prototype.reject=function(e){return this.filter(ra(ee(e)))},be.prototype.slice=function(e,r){e=de(e);var s=this;return s.__filtered__&&(e>0||r<0)?new be(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),r!==i&&(r=de(r),s=r<0?s.dropRight(-r):s.take(r-e)),s)},be.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},be.prototype.toArray=function(){return this.take(V)},Ur(be.prototype,function(e,r){var s=/^(?:filter|find|map|reject)|While$/.test(r),c=/^(?:head|last)$/.test(r),l=f[c?"take"+(r=="last"?"Right":""):r],d=c||/^find/.test(r);l&&(f.prototype[r]=function(){var w=this.__wrapped__,b=c?[1]:arguments,P=w instanceof be,D=b[0],L=P||le(w),j=function(me){var Ie=l.apply(f,ui([me],b));return c&&k?Ie[0]:Ie};L&&s&&typeof D=="function"&&D.length!=1&&(P=L=!1);var k=this.__chain__,Y=!!this.__actions__.length,ie=d&&!k,ve=P&&!Y;if(!d&&L){w=ve?w:new be(this);var se=e.apply(w,b);return se.__actions__.push({func:Zn,args:[j],thisArg:i}),new _r(se,k)}return ie&&ve?e.apply(this,b):(se=this.thru(j),ie?c?se.value()[0]:se.value():se)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var r=xn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return r.apply(le(d)?d:[],l)}return this[s](function(w){return r.apply(le(w)?w:[],l)})}}),Ur(be.prototype,function(e,r){var s=f[r];if(s){var c=s.name+"";$e.call(is,c)||(is[c]=[]),is[c].push({name:r,func:s})}}),is[Fn(i,ce).name]=[{name:"wrapper",func:i}],be.prototype.clone=yp,be.prototype.reverse=mp,be.prototype.value=wp,f.prototype.at=Wg,f.prototype.chain=Jg,f.prototype.commit=Qg,f.prototype.next=Yg,f.prototype.plant=Xg,f.prototype.reverse=ev,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=tv,f.prototype.first=f.prototype.head,Is&&(f.prototype[Is]=Zg),f},es=Qf();pt?((pt.exports=es)._=es,Me._=es):Ee._=es}).call(Ks)})(xc,xc.exports);var DE=Object.defineProperty,qE=Object.defineProperties,LE=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,zE=Object.prototype.hasOwnProperty,jE=Object.prototype.propertyIsEnumerable,$l=(o,t,i)=>t in o?DE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,fa=(o,t)=>{for(var i in t||(t={}))zE.call(t,i)&&$l(o,i,t[i]);if(Tl)for(var i of Tl(t))jE.call(t,i)&&$l(o,i,t[i]);return o},ME=(o,t)=>qE(o,LE(t));function bi(o,t,i){var n;const a=K0(o);return((n=t.rpcMap)==null?void 0:n[a.reference])||`${NE}?chainId=${a.namespace}:${a.reference}&projectId=${i}`}function Ki(o){return o.includes(":")?o.split(":")[1]:o}function Pf(o){return o.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function UE(o,t){const i=Object.keys(t.namespaces).filter(a=>a.includes(o));if(!i.length)return[];const n=[];return i.forEach(a=>{const h=t.namespaces[a].accounts;n.push(...h)}),n}function HE(o={},t={}){const i=Nl(o),n=Nl(t);return xc.exports.merge(i,n)}function Nl(o){var t,i,n,a;const h={};if(!ga(o))return h;for(const[p,y]of Object.entries(o)){const m=Gl(p)?[p]:y.chains,g=y.methods||[],_=y.events||[],S=y.rpcMap||{},$=Vs(p);h[$]=ME(fa(fa({},h[$]),y),{chains:rc(m,(t=h[$])==null?void 0:t.chains),methods:rc(g,(i=h[$])==null?void 0:i.methods),events:rc(_,(n=h[$])==null?void 0:n.events),rpcMap:fa(fa({},S),(a=h[$])==null?void 0:a.rpcMap)})}return h}function kE(o){return o.includes(":")?o.split(":")[2]:o}function KE(o){const t={};for(const[i,n]of Object.entries(o)){const a=n.methods||[],h=n.events||[],p=n.accounts||[],y=Gl(i)?[i]:n.chains?n.chains:Pf(n.accounts);t[i]={chains:y,methods:a,events:h,accounts:p}}return t}function pc(o){return typeof o=="number"?o:o.includes("0x")?parseInt(o,16):o.includes(":")?Number(o.split(":")[1]):Number(o)}const Sf={},Ye=o=>Sf[o],dc=(o,t)=>{Sf[o]=t};class VE{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=Ki(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class FE{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(parseInt(t),i),this.chainId=parseInt(t),this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,i){const n=i||bi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=parseInt(Ki(i));t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}async handleSwitchChain(t){var i,n;let a=t.request.params?(i=t.request.params[0])==null?void 0:i.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class BE{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=Ki(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class GE{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=Ki(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class WE{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i),a=Ki(i);t[a]=this.createHttpProvider(a,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}getCardanoRPCUrl(t){const i=this.namespace.rpcMap;if(i)return i[t]}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class JE{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=Ki(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class QE{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=Ki(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ii(new Ei(n,Ye("disableProviderPing")))}}class YE{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const n=i||bi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||bi(t,this.namespace);return typeof n>"u"?void 0:new Ii(new Ei(n,Ye("disableProviderPing")))}}var ZE=Object.defineProperty,XE=Object.defineProperties,eI=Object.getOwnPropertyDescriptors,Dl=Object.getOwnPropertySymbols,tI=Object.prototype.hasOwnProperty,rI=Object.prototype.propertyIsEnumerable,ql=(o,t,i)=>t in o?ZE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,pa=(o,t)=>{for(var i in t||(t={}))tI.call(t,i)&&ql(o,i,t[i]);if(Dl)for(var i of Dl(t))rI.call(t,i)&&ql(o,i,t[i]);return o},gc=(o,t)=>XE(o,eI(t));class zc{constructor(t){this.events=new Ac,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Sa(Ra({level:(t==null?void 0:t.logger)||Al})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const i=new zc(t);return await i.initialize(),i}async request(t,i){const[n,a]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:pa({},t),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(t,i,n){const a=new Date().getTime();this.request(t,n).then(h=>i(null,xa(a,h))).catch(h=>i(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:kt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}removeListener(t,i){this.events.removeListener(t,i)}off(t,i){this.events.off(t,i)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=KE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==If)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,i){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(vs(i)){for(const n of i)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await AE.init({logger:this.providerOpts.logger||Al,relayUrl:this.providerOpts.relayUrl||CE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(i=>Vs(i)))];dc("client",this.client),dc("events",this.events),dc("disableProviderPing",this.disableProviderPing),t.forEach(i=>{if(!this.session)return;const n=UE(i,this.session),a=Pf(n),h=HE(this.namespaces,this.optionalNamespaces),p=gc(pa({},h[i]),{accounts:n,chains:a});switch(i){case"eip155":this.rpcProviders[i]=new FE({namespace:p});break;case"solana":this.rpcProviders[i]=new BE({namespace:p});break;case"cosmos":this.rpcProviders[i]=new GE({namespace:p});break;case"polkadot":this.rpcProviders[i]=new VE({namespace:p});break;case"cip34":this.rpcProviders[i]=new WE({namespace:p});break;case"elrond":this.rpcProviders[i]=new JE({namespace:p});break;case"multiversx":this.rpcProviders[i]=new QE({namespace:p});break;case"near":this.rpcProviders[i]=new YE({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:i}=t,{event:n}=i;if(n.name==="accountsChanged"){const a=n.data;a&&vs(a)&&this.events.emit("accountsChanged",a.map(kE))}else if(n.name==="chainChanged"){const a=i.chainId,h=i.event.data,p=Vs(a),y=pc(a)!==pc(h)?`${p}:${pc(h)}`:a;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:i})=>{var n;const{namespaces:a}=i,h=(n=this.client)==null?void 0:n.session.get(t);this.session=gc(pa({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:i})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",gc(pa({},kt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ni.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var i;this.getProvider(t).updateNamespace((i=this.session)==null?void 0:i.namespaces[t])})}setNamespaces(t){const{namespaces:i,optionalNamespaces:n,sessionProperties:a}=t;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(t){const[i,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(p=>Vs(p)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const a=Vs(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,i=!1){var n;if(!this.namespaces)return;const[a,h]=this.validateChain(t);i||this.getProvider(a).setDefaultChain(h),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,i){this.client.core.storage.setItem(`${Cl}/${t}`,i)}async getFromStore(t){return await this.client.core.storage.getItem(`${Cl}/${t}`)}}const iI=zc,sI="wc",nI="ethereum_provider",aI=`${sI}@2:${nI}:`,oI="https://rpc.walletconnect.com/v1/",Pc=["eth_sendTransaction","personal_sign"],cI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Sc=["chainChanged","accountsChanged"],uI=["chainChanged","accountsChanged","message","disconnect","connect"];var hI=Object.defineProperty,lI=Object.defineProperties,fI=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,pI=Object.prototype.hasOwnProperty,dI=Object.prototype.propertyIsEnumerable,zl=(o,t,i)=>t in o?hI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Bs=(o,t)=>{for(var i in t||(t={}))pI.call(t,i)&&zl(o,i,t[i]);if(Ll)for(var i of Ll(t))dI.call(t,i)&&zl(o,i,t[i]);return o},jl=(o,t)=>lI(o,fI(t));function _a(o){return Number(o[0].split(":")[1])}function vc(o){return`0x${o.toString(16)}`}function gI(o){const{chains:t,optionalChains:i,methods:n,optionalMethods:a,events:h,optionalEvents:p,rpcMap:y}=o;if(!vs(t))throw new Error("Invalid chains");const m={chains:t,methods:n||Pc,events:h||Sc,rpcMap:Bs({},t.length?{[_a(t)]:y[_a(t)]}:{})},g=h==null?void 0:h.filter(q=>!Sc.includes(q)),_=n==null?void 0:n.filter(q=>!Pc.includes(q));if(!i&&!p&&!a&&!(g!=null&&g.length)&&!(_!=null&&_.length))return{required:t.length?m:void 0};const S=(g==null?void 0:g.length)&&(_==null?void 0:_.length)||!i,$={chains:[...new Set(S?m.chains.concat(i||[]):i)],methods:[...new Set(m.methods.concat(a!=null&&a.length?a:cI))],events:[...new Set(m.events.concat(p!=null&&p.length?p:uI))],rpcMap:y};return{required:t.length?m:void 0,optional:i.length?$:void 0}}class jc{constructor(){this.events=new Sr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=aI,this.on=(t,i)=>(this.events.on(t,i),this),this.once=(t,i)=>(this.events.once(t,i),this),this.removeListener=(t,i)=>(this.events.removeListener(t,i),this),this.off=(t,i)=>(this.events.off(t,i),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const i=new jc;return await i.initialize(t),i}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,i){this.signer.sendAsync(t,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:i,optional:n}=gI(this.rpc);try{const a=await new Promise(async(p,y)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(jl(Bs({namespaces:Bs({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(g=>{p(g)}).catch(g=>{y(new Error(g.message))})});if(!a)return;const h=V0(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:vc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:i}=t,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const i=parseInt(t);this.chainId=i,this.events.emit("chainChanged",vc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",jl(Bs({},kt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const i=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",vc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const i=this.parseChainId(t);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(t){const[i,n,a]=t.split(":");return{chainId:`${i}:${n}`,address:a}}setAccounts(t){this.accounts=t.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var i,n;const a=(i=t==null?void 0:t.chains)!=null?i:[],h=(n=t==null?void 0:t.optionalChains)!=null?n:[],p=a.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=a.length?(t==null?void 0:t.methods)||Pc:[],m=a.length?(t==null?void 0:t.events)||Sc:[],g=(t==null?void 0:t.optionalMethods)||[],_=(t==null?void 0:t.optionalEvents)||[],S=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),$=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(q=>this.formatChainId(q)),optionalChains:h.map(q=>this.formatChainId(q)),methods:y,events:m,optionalMethods:g,optionalEvents:_,rpcMap:S,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:$,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,i){const n={};return t.forEach(a=>{n[a]=this.getRpcUrl(a,i)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?_a(this.rpc.chains):_a(this.rpc.optionalChains),this.signer=await iI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await F0(()=>import("./index-Bghrwrms.js").then(a=>a.i),__vite__mapDeps([0,1,2]));i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Bs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:i,optionalChains:n,rpcMap:a}=t;i&&vs(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),n&&vs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${oI}?chainId=eip155:${t}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(i=>this.parseAccount(i))}}const $I=jc;export{$I as EthereumProvider,uI as OPTIONAL_EVENTS,cI as OPTIONAL_METHODS,Sc as REQUIRED_EVENTS,Pc as REQUIRED_METHODS,jc as default};
